---
title: Linux - Shell Script
summary: "Shell Script gi√∫p b·∫°n t·ª± ƒë·ªông h√≥a c√°c thao t√°c tr√™n Linux thay v√¨ nh·∫≠p t·ª´ng l·ªánh th·ªß c√¥ng."
date: "2025-06-09"
image: "/vuepress-blog/images/user-images/user-3.jpg"
category: "DEVOPS"
---

# Shell Script

Shell Script gi√∫p b·∫°n t·ª± ƒë·ªông h√≥a c√°c thao t√°c tr√™n Linux thay v√¨ nh·∫≠p t·ª´ng l·ªánh th·ªß c√¥ng.

[1. Shell Script l√† g√¨?](#1)

[2. Tr√¨nh so·∫°n th·∫£o nano](#2)

[3. Bi·∫øn trong Shell Script](#3)

[4. Th·ª±c hi·ªán c√°c ph√©p t√≠nh trong Shell Bash](#4)

[5. C·∫•u tr√∫c ƒëi·ªÅu ki·ªán](#5)

[6. C·∫•u tr√∫c v√≤ng l·∫∑p](#6)

[7. M·∫£ng trong Shell Script](#7)

[8. H√†m trong Shell Script](#8)

[9. Debug trong Shell Script](#9)

<a name="1"></a>

## üìå 1. Shell Script l√† g√¨?

L√† m·ªôt t·∫≠p h·ª£p c√°c l·ªánh Linux ƒë∆∞·ª£c vi·∫øt trong m·ªôt file script (ƒëu√¥i .sh) v√† c√≥ th·ªÉ th·ª±c thi nh∆∞ m·ªôt ch∆∞∆°ng tr√¨nh.

### üîπ V√≠ d·ª• ƒë∆°n gi·∫£n:

```bash
#!/bin/bash # ƒê√°nh d·∫•u vi·ªác s·ª≠ d·ª•ng bash ƒë·ªÉ th·ª±c thi
echo "Hello, Linux!"
```

### üîπ C√°ch ch·∫°y script:

```bash
chmod +x script.sh  # C·∫•p quy·ªÅn th·ª±c thi
./script.sh         # Ch·∫°y script
```

### üîπ L∆∞u √Ω:

- M·ªói d√≤ng l·ªánh ƒë∆∞·ª£c vi·∫øt tr√™n m·ªôt d√≤ng ri√™ng.

- B·∫Øt ƒë·∫ßu script b·∫±ng d√≤ng shebang _#!/bin/bash_ ƒë·ªÉ ch·ªâ ƒë·ªãnh shell m√† script s·∫Ω s·ª≠ d·ª•ng (tr∆∞·ªùng h·ª£p n√†y l√† bash).

- K·∫øt th√∫c m·ªói d√≤ng l·ªánh b·∫±ng d·∫•u ch·∫•m ph·∫©y ho·∫∑c kh√¥ng c·∫ßn d·∫•u ch·∫•m ph·∫©y n·∫øu m·ªói l·ªánh ƒë∆∞∆°c vi·∫øt tr√™n m·ªôt d√≤ng.

<a name="2"></a>

## üìå 2. Tr√¨nh so·∫°n th·∫£o nano

Khi vi·∫øt Shell Script, c·∫ßn m·ªôt tr√¨nh so·∫°n th·∫£o ƒë·ªÉ ch·ªânh s·ª≠a n·ªôi dung file .sh.

Tr√¨nh so·∫°n th·∫£o nano l√† m·ªôt trong nh·ªØng l·ª±a ch·ªçn ph·ªï bi·∫øn:

- D·ªÖ s·ª≠ d·ª•ng h∆°n so v·ªõi Vim.
- H·ªó tr·ª£ c√∫ ph√°p ƒë∆°n gi·∫£n & g·ª£i √Ω l·ªánh.
- T·∫°o v√† ch·ªânh s·ª≠a nhanh ch√≥ng.
- Ph√π h·ª£p v·ªõi ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu l√†m quen v·ªõi Shell Script.

ƒê·ªÉ m·ªü file trong tr√¨nh so·∫°n th·∫£o nano:

```bash
nano myscript.sh
```

D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë thao t√°c c∆° b·∫£n khi s·ª≠ d·ª•ng tr√¨nh so·∫°n th·∫£o nano:

### üîπ ƒêi·ªÅu h∆∞·ªõng trong nano

|        Action        |                L·ªánh                 |
| :------------------: | :---------------------------------: |
|  Di chuy·ªÉn con tr·ªè   |          D√πng ph√≠m m≈©i t√™n          |
| Nh·∫£y ƒë·∫øn d√≤ng c·ª• th·ªÉ | Ctrl + \_, nh·∫≠p s·ªë d√≤ng, nh·∫•n Enter |
|   T√¨m ki·∫øm t·ª´ kh√≥a   | Ctrl + W, nh·∫≠p t·ª´ kh√≥a, nh·∫•n Enter  |
|  T√¨m ki·∫øm ti·∫øp theo  |   Ctrl + W r·ªìi nh·∫•n Enter l·∫ßn n·ªØa   |

### üîπ Ch·ªânh s·ª≠a v√† l∆∞u file

|      Action       |                         L·ªánh                          |
| :---------------: | :---------------------------------------------------: |
| X√≥a d√≤ng hi·ªán t·∫°i |                       Ctrl + K                        |
|   Sao ch√©p d√≤ng   |  Alt + 6 (ƒë√°nh d·∫•u), Ctrl + K (c·∫Øt), Ctrl + U (d√°n)   |
|     L∆∞u file      |                 Ctrl + O, nh·∫•n Enter                  |
|    Tho√°t nano     | Ctrl + X, n·∫øu c√≥ thay ƒë·ªïi, ch·ªçn Y ƒë·ªÉ l∆∞u ho·∫∑c N ƒë·ªÉ b·ªè |

### üîπ M·ªôt s·ªë ph√≠m t·∫Øt h·ªØu √≠ch

|        Action        |      L·ªánh       |
| :------------------: | :-------------: |
| B·∫≠t/t·∫Øt ƒë√°nh s·ªë d√≤ng | Alt + Shift + # |
|       Ho√†n t√°c       |     Alt + U     |
|    L√†m l·∫°i (Redo)    |     Alt + E     |

<a name="3"></a>

## üìå 3. Bi·∫øn trong Shell Script

Shell h·ªó tr·ª£ bi·∫øn h·ªá th·ªëng v√† bi·∫øn do ng∆∞·ªùi d√πng ƒë·ªãnh nghƒ©a.

### üîπ Bi·∫øn h·ªá th·ªëng (c√≥ s·∫µn)

```bash
echo "User hi·ªán t·∫°i: $USER"
echo "Th∆∞ m·ª•c HOME: $HOME"
echo "Shell ƒëang d√πng: $SHELL"
```

### üîπ Bi·∫øn t·ª± ƒë·ªãnh nghƒ©a

```bash
name="Linux"
echo "Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi $name!"
```

### üîπ M·ªôt s·ªë quy ƒë·ªãnh v·ªÅ t√™n bi·∫øn

- B·∫Øt ƒë·∫ßu b·∫±ng k√Ω t·ª± ho·∫∑c d·∫•u g·∫°ch ch√¢n (\_)

- Kh√¥ng ƒë∆∞·ª£c c√≥ kho·∫£ng tr·∫Øng

- Bi·∫øn c√≥ ph√¢n bi·ªát ch·ªØ hoa ch·ªØ th∆∞·ªùng

- C√≥ th·ªÉ khai b√°o m·ªôt bi·∫øn c√≥ gi√° tr·ªã NULL nh∆∞ sau:

  ```bash
  var1=
  # ho·∫∑c
  var2=""
  ```

- Kh√¥ng d√πng ?, \* ƒë·ªÉ ƒë·∫∑t t√™n bi·∫øn

<a name="4"></a>

## üìå 4. Th·ª±c hi·ªán c√°c ph√©p t√≠nh trong Shell Bash

Bash kh√¥ng h·ªó tr·ª£ tr·ª±c ti·∫øp to√°n h·ªçc nh∆∞ c√°c ng√¥n ng·ªØ l·∫≠p tr√¨nh kh√°c, nh∆∞ng c√≥ nhi·ªÅu c√°ch ƒë·ªÉ th·ª±c hi·ªán c√°c ph√©p t√≠nh.

### üîπ S·ª≠ d·ª•ng expr (Ph√©p to√°n c∆° b·∫£n)

```bash
a=10
b=5
sum=$(expr $a + $b)    # C·ªông
diff=$(expr $a - $b)   # Tr·ª´
prod=$(expr $a \* $b)  # Nh√¢n (* ph·∫£i c√≥ \ do l√† k√Ω t·ª± ƒë·∫∑c bi·ªát trong shell)
quot=$(expr $a / $b)   # Chia (ch·ªâ l·∫•y ph·∫ßn nguy√™n)
mod=$(expr $a % $b)    # L·∫•y d∆∞
```

### üîπ S·ª≠ d·ª•ng let (T∆∞∆°ng t·ª± expr nh∆∞ng g·ªçn h∆°n)

```bash
a=10
b=3
let "a += b"
echo "a sau khi c·ªông: $a"  # 13
# c√°ch vi·∫øt kh√°c
let a=10+3
```

### üîπ S·ª≠ d·ª•ng $(( )) (C√°ch t·ªët nh·∫•t)

```bash
a=10
b=3
sum=$((a + b))
diff=$((a - b))
prod=$((a * b))
quot=$((a / b))  # L·∫•y ph·∫ßn nguy√™n
mod=$((a % b))
```

### üîπ S·ª≠ d·ª•ng bc (T√≠nh to√°n s·ªë th·ª±c)

Do expr, $(( )) ch·ªâ h·ªó tr·ª£ s·ªë nguy√™n, s·ª≠ d·ª•ng bc ƒë·ªÉ t√≠nh to√°n s·ªë th·ª±c nh∆∞ sau:

```bash
echo "scale=2; 5 / 3" | bc  # 1.66
```

<a name="5"></a>

## üìå 5. C·∫•u tr√∫c ƒëi·ªÅu ki·ªán

```bash
#!/bin/bash
echo "Nh·∫≠p s·ªë:"
read num
if [ $num -gt 10 ]; then
    echo "S·ªë l·ªõn h∆°n 10"
else
    echo "S·ªë nh·ªè h∆°n ho·∫∑c b·∫±ng 10"
fi
```

üî• M·ªôt s·ªë to√°n t·ª≠ ki·ªÉm tra:

|  To√°n t·ª≠  |              √ù nghƒ©a              |
| :-------: | :-------------------------------: |
|    -eq    |               B·∫±ng                |
|    -ne    |               Kh√°c                |
|    -gt    |              L·ªõn h∆°n              |
|    -lt    |              Nh·ªè h∆°n              |
|    -ge    |         L·ªõn h∆°n ho·∫∑c b·∫±ng         |
|    -le    |         Nh·ªè h∆°n ho·∫∑c b·∫±ng         |
| = ho·∫∑c == | So s√°nh b·∫±ng nh∆∞ng d√πng cho chu·ªói |
|    !=     | So s√°nh kh√°c nh∆∞ng d√πng cho chu·ªói |

<a name="6"></a>

## üìå 6. C·∫•u tr√∫c v√≤ng l·∫∑p

### üîπ V√≤ng l·∫∑p for

```bash
for i in {1..5}; do
    echo "S·ªë: $i"
done
```

### üîπ V√≤ng l·∫∑p while

```bash
count=1
while [ $count -le 5 ]; do
    echo "L·∫ßn $count"
    ((count++))
done
```

<a name="7"></a>

## üìå 7. M·∫£ng trong Shell Script

Bash h·ªó tr·ª£ m·∫£ng ch·ªâ s·ªë (indexed array) v√† m·∫£ng k·∫øt h·ª£p (associative array).

### üîπ M·∫£ng ch·ªâ s·ªë (Indexed Array)

- Khai b√°o m·∫£ng:

  ```bash
  # Kh·ªüi t·∫°o m·∫£ng
  arr=(10 20 30 40 "Hello")

  # C√°ch kh√°c
  arr[0]=10
  arr[1]=20
  arr[2]=30
  arr[3]=40
  arr[4]="Hello"
  ```

- Truy c·∫≠p ph·∫ßn t·ª≠ trong m·∫£ng:

  ```bash
  # L·∫•y gi√° tr·ªã c·ªßa m·ªôt ph·∫ßn t·ª≠ (ch·ªâ s·ªë b·∫Øt ƒë·∫ßu t·ª´ 0)
  echo "${arr[0]}"  # 10

  # L·∫•y to√†n b·ªô gi√° tr·ªã c·ªßa m·∫£ng
  echo "${arr[@]}"  # 10 20 30 40 Hello
  echo "${arr[*]}"  # 10 20 30 40 Hello

  # L·∫•y s·ªë l∆∞·ª£ng ph·∫ßn t·ª≠ trong m·∫£ng
  echo "${#arr[@]}"  # 5

  # L·∫•y danh s√°ch ch·ªâ m·ª•c (index) c·ªßa m·∫£ng
  echo "${!arr[@]}"  # 0 1 2 3 4
  ```

- Duy·ªát m·∫£ng:

  ```bash
  # Duy·ªát m·∫£ng b·∫±ng for
  for item in "${arr[@]}"; do
      echo "$item"
  done

  # Duy·ªát m·∫£ng b·∫±ng ch·ªâ m·ª•c (for v√† seq)
  for i in "${!arr[@]}"; do
      echo "Ph·∫ßn t·ª≠ $i: ${arr[$i]}"
  done
  ```

- Th√™m, s·ª≠a, x√≥a ph·∫ßn t·ª≠ trong m·∫£ng:

  ```bash
  # Th√™m ph·∫ßn t·ª≠ v√†o m·∫£ng
  arr+=(50 60)  # Th√™m nhi·ªÅu ph·∫ßn t·ª≠
  echo "${arr[@]}"  # 10 20 30 40 Hello 50 60

  # C·∫≠p nh·∫≠t gi√° tr·ªã
  arr[1]=100
  echo "${arr[@]}"  # 10 100 30 40 Hello

  # X√≥a ph·∫ßn t·ª≠ kh·ªèi m·∫£ng
  unset arr[2]
  echo "${arr[@]}"  # 10 100 40 Hello

  # X√≥a to√†n b·ªô m·∫£ng
  unset arr
  echo "${arr[@]}"  # Kh√¥ng c√≤n ph·∫ßn t·ª≠ n√†o
  ```

### üîπ M·∫£ng k·∫øt h·ª£p (Associative Array)

Ch·ªâ h·ªó tr·ª£ trong Bash 4.0+

```bash
declare -A user
user[name]="John"
user[age]=25
user[email]="john@example.com"

echo "T√™n: ${user[name]}"
echo "Tu·ªïi: ${user[age]}"
echo "Email: ${user[email]}"
```

ƒê·ªÉ duy·ªát m·∫£ng k·∫øt h·ª£p:

```bash
for key in "${!user[@]}"; do
    echo "$key: ${user[$key]}"
done
```

<a name="8"></a>

## üìå 8. H√†m trong Shell Script

Shell Script c≈©ng h·ªó tr·ª£ h√†m ƒë·ªÉ t√°i s·ª≠ d·ª•ng code.

### üîπ Khai b√°o & g·ªçi h√†m

```bash
# Khai b√°o h√†m
hello() {
    echo "Xin ch√†o, $1!"
}

# G·ªçi h√†m
hello "Linux"
```

### üîπ H√†m tr·∫£ v·ªÅ gi√° tr·ªã

- **C√°ch 1:** Tr·∫£ v·ªÅ gi√° tr·ªã b·∫±ng return

  - return ch·ªâ tr·∫£ v·ªÅ m√£ tr·∫°ng th√°i (exit code), th∆∞·ªùng d√πng ƒë·ªÉ ki·ªÉm tra th√†nh c√¥ng/th·∫•t b·∫°i.
  - S·ªë tr·∫£ v·ªÅ n·∫±m trong kho·∫£ng 0-255.

  ```bash
  check_even() {
      local num=$1
      if (( num % 2 == 0 )); then
          return 0  # Th√†nh c√¥ng
      else
          return 1  # Th·∫•t b·∫°i
      fi
  }

  check_even 10
  # D√πng $? l·∫•y gi√° tr·ªã return c·ªßa h√†m
  if [ $? -eq 0 ]; then
      echo "10 l√† s·ªë ch·∫µn"
  else
      echo "10 l√† s·ªë l·∫ª"
  fi
  ```

- **C√°ch 2:** Tr·∫£ v·ªÅ gi√° tr·ªã b·∫±ng echo

  - D√πng echo ƒë·ªÉ tr·∫£ v·ªÅ chu·ªói, s·ªë nguy√™n, m·∫£ng, ho·∫∑c b·∫•t k·ª≥ d·ªØ li·ªáu n√†o.
  - K·∫øt h·ª£p v·ªõi $(...) ƒë·ªÉ l·∫•y gi√° tr·ªã tr·∫£ v·ªÅ.

  ```bash
  sum() {
    local a=$1
    local b=$2
    echo $((a + b))  # In k·∫øt qu·∫£ ra m√†n h√¨nh
  }

  result=$(sum 10 20)
  echo "T·ªïng l√†: $result"
  ```

<a name="9"></a>

## üìå 9. Debug trong Shell Script

### üîπ Ch·∫°y script ·ªü ch·∫ø ƒë·ªô debug (-x)

S·ª≠ d·ª•ng bash -x script.sh ho·∫∑c th√™m d√≤ng set -x v√†o script ƒë·ªÉ hi·ªÉn th·ªã t·ª´ng l·ªánh ƒë∆∞·ª£c th·ª±c thi.

- V√≠ d·ª• 1: Ch·∫°y script v·ªõi -x

  ```bash
  bash -x script.sh
  ```

  üìù K·∫øt qu·∫£: Hi·ªÉn th·ªã t·ª´ng l·ªánh tr∆∞·ªõc khi th·ª±c thi, gi√∫p d·ªÖ d√†ng ki·ªÉm tra l·ªói.

- V√≠ d·ª• 2: Th√™m set -x v√†o script

  ```bash
  #!/bin/bash
  set -x  # B·∫≠t debug mode

  echo "B·∫Øt ƒë·∫ßu script"
  x=5
  y=10
  sum=$((x + y))
  echo "T·ªïng: $sum"

  set +x  # T·∫Øt debug mode
  echo "Script ho√†n th√†nh!"
  ```

  üìù K·∫øt qu·∫£:

  ```bash
  + echo 'B·∫Øt ƒë·∫ßu script'
  B·∫Øt ƒë·∫ßu script
  + x=5
  + y=10
  + sum=15
  + echo 'T·ªïng: 15'
  T·ªïng: 15
  + set +x
  Script ho√†n th√†nh!
  ```

### üîπ Debug t·ª´ng d√≤ng b·∫±ng echo

Th√™m echo ƒë·ªÉ ki·ªÉm tra gi√° tr·ªã bi·∫øn t·∫°i t·ª´ng b∆∞·ªõc

```bash
#!/bin/bash
echo "Script b·∫Øt ƒë·∫ßu"
var="Linux"
echo "Gi√° tr·ªã c·ªßa var: $var"
```

### üîπ Ki·ªÉm tra l·ªói c√∫ ph√°p (-n)

D√πng bash -n script.sh ƒë·ªÉ ki·ªÉm tra l·ªói c√∫ ph√°p m√† kh√¥ng ch·∫°y script.

```bash
bash -n script.sh
```

üìù K·∫øt qu·∫£: N·∫øu c√≥ l·ªói c√∫ ph√°p, bash s·∫Ω b√°o l·ªói ngay.

### üîπ Hi·ªÉn th·ªã l·ªói chi ti·∫øt (-v)

D√πng bash -v script.sh ƒë·ªÉ hi·ªÉn th·ªã t·ª´ng d√≤ng l·ªánh tr∆∞·ªõc khi th·ª±c thi.

```bash
bash -v script.sh
```

### üîπ B·∫Øt l·ªói runtime (set -e, set -u)

```bash
#!/bin/bash
set -e  # D·ª´ng khi g·∫∑p l·ªói
set -u  # B√°o l·ªói khi d√πng bi·∫øn ch∆∞a khai b√°o

echo "Ch·∫°y l·ªánh..."
ls /khong_ton_tai   # L·ªánh n√†y s·∫Ω g√¢y l·ªói v√† d·ª´ng script
echo "D√≤ng n√†y s·∫Ω kh√¥ng ch·∫°y"
```

üìù K·∫øt qu·∫£:

```bash
Ch·∫°y l·ªánh...
ls: cannot access '/khong_ton_tai': No such file or directory
```

L·ªánh echo "D√≤ng n√†y s·∫Ω kh√¥ng ch·∫°y" kh√¥ng ƒë∆∞·ª£c th·ª±c thi do set -e.
