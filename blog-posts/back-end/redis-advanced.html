<!doctype html>
<html lang="vi-VN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/vuepress-blog/favicon.ico"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Josefin+Sans:300,400,500,600,700&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"><title>Redis Advanced | Kiến Thức Từ Trải Nghiệm</title><meta name="description" content="Một blog được tạo bằng VuePress">
    <link rel="preload" href="/vuepress-blog/assets/style-VnzZgpKD.css" as="style"><link rel="stylesheet" href="/vuepress-blog/assets/style-VnzZgpKD.css">
    <link rel="modulepreload" href="/vuepress-blog/assets/app-BO_61kEJ.js"><link rel="modulepreload" href="/vuepress-blog/assets/redis-advanced.html-BNarOp4W.js">
    <link rel="prefetch" href="/vuepress-blog/assets/index.html-BGqgYuC3.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-BpbNGxGm.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-D8TcWst7.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-iXiJigIz.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-DN1u8bWr.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/fastapi-base-project.html-CY9N8CSr.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-accuracy-perfomance.html-BRkbO_7G.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-cache-tesseract.html-wOId9UdF.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-gioi-thieu-tesseract.html-Bd_bstPk.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-tong-quan.html-Be6RlzSc.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-training-tesseract.html-DCeF2YCf.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-advanced.html-grmEuzCy.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-beginner.html-D7n3t96D.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-expert.html-Dq2oC1fR.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-intermediate.html-CzUXLbdf.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/redis-basic.html-CsOd_8VA.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-cloud-computing.html-C3rkr0Gw.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-database.html-DkIg0jNK.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-ec2.html-C0afodG5.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-gioi-thieu-aws.html-Dum65DHk.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-iam.html-ac2E4Krb.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-storage.html-DsmBSsbE.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-beginner.html-BN8NUw5U.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-intermediate.html-BSh-vp9N.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-shell-script.html-CU5VAm2k.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-training-saa-series.html-LqLy_f7e.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-tesseract-series.html-DVIjmNhN.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/plsql-training-series.html-Bhw1NnrN.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-DlQvVSbg.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-B6eE_Ixr.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-D4E4Jypd.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/404.html-DqUncczf.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/setupDevtools-7MC2TMWH-BqpMF4PC.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container no-sidebar external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/vuepress-blog/"><img class="vp-site-logo" src="/vuepress-blog/images/logo.png" alt="Kiến Thức Từ Trải Nghiệm"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Kiến Thức Từ Trải Nghiệm</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/" aria-label="Trang Chủ"><!---->Trang Chủ<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/project/" aria-label="Dự Án"><!---->Dự Án<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/blog/" aria-label="Blog"><!---->Blog<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/about/" aria-label="Về Tôi"><!---->Về Tôi<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Ngôn Ngữ</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Ngôn Ngữ</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/vuepress-blog/blog-posts/back-end/redis-advanced.html" aria-label="Tiếng Việt"><!---->Tiếng Việt<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vuepress-blog/en/" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/" aria-label="Trang Chủ"><!---->Trang Chủ<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/project/" aria-label="Dự Án"><!---->Dự Án<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/blog/" aria-label="Blog"><!---->Blog<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/about/" aria-label="Về Tôi"><!---->Về Tôi<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Ngôn Ngữ</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Ngôn Ngữ</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/vuepress-blog/blog-posts/back-end/redis-advanced.html" aria-label="Tiếng Việt"><!---->Tiếng Việt<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vuepress-blog/en/" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content" vp-content><!--[--><!--]--><div><h1 id="redis-advanced" tabindex="-1"><a class="header-anchor" href="#redis-advanced"><span>Redis Advanced</span></a></h1><p><a href="#1">1. Redis Transaction &amp; Scripting</a></p><p><a href="#2">2. Redis Pub/Sub &amp; Stream</a></p><p><a href="#3">3. Tối ưu hóa Redis (Performance Tuning)</a></p><p><a href="#4">4. Kết hợp Redis với các ngôn ngữ lập trình</a></p><p><a href="#5">5. Redis Use Case (Ứng dụng thực tế)</a></p><p><a name="1"></a></p><h2 id="📌-1-redis-transaction-scripting" tabindex="-1"><a class="header-anchor" href="#📌-1-redis-transaction-scripting"><span>📌 1. Redis Transaction &amp; Scripting</span></a></h2><h3 id="🔹-redis-transaction-la-gi" tabindex="-1"><a class="header-anchor" href="#🔹-redis-transaction-la-gi"><span>🔹 Redis Transaction là gì?</span></a></h3><p>Redis hỗ trợ Transaction để thực hiện nhiều lệnh cùng lúc một cách an toàn.</p><p>🔨 Các bước thực hiện Transaction:</p><ul><li>MULTI – Bắt đầu transaction</li><li>Thêm các lệnh vào hàng đợi</li><li>EXEC – Thực thi tất cả lệnh một lần</li></ul><p>Ví dụ:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">MULTI</span>
<span class="line">SET user:1 <span class="token string">&quot;Alice&quot;</span></span>
<span class="line">INCR balance:1</span>
<span class="line">EXEC</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="🔹-cach-rollback-trong-redis" tabindex="-1"><a class="header-anchor" href="#🔹-cach-rollback-trong-redis"><span>🔹 Cách Rollback trong Redis</span></a></h3><p>❌ Redis không hỗ trợ ROLLBACK như SQL. Nếu một lệnh lỗi, các lệnh trước đó vẫn thực thi.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">MULTI</span>
<span class="line">SET user:1 <span class="token string">&quot;Alice&quot;</span></span>
<span class="line">INCR user:1  <span class="token comment"># ❌ Lỗi! (Vì &quot;Alice&quot; không phải số)</span></span>
<span class="line">EXEC</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>👉 Transaction vẫn chạy, nhưng lệnh INCR user:1 bị lỗi.</p><p>💡 Để tránh lỗi, có thể dùng WATCH để kiểm tra điều kiện trước khi thực hiện Transaction.</p><h3 id="🔹-kiem-soat-transaction-voi-watch" tabindex="-1"><a class="header-anchor" href="#🔹-kiem-soat-transaction-voi-watch"><span>🔹 Kiểm soát Transaction với WATCH</span></a></h3><p>WATCH giúp giám sát một key, nếu key này thay đổi trước khi EXEC, Redis sẽ hủy Transaction.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">WATCH balance:1</span>
<span class="line">MULTI</span>
<span class="line">DECRBY balance:1 <span class="token number">50</span>  <span class="token comment"># Giảm 50 đơn vị</span></span>
<span class="line">EXEC</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>👉 Nếu balance:1 bị thay đổi bởi client khác trước EXEC, Transaction sẽ bị hủy.</p><h3 id="🔹-redis-scripting" tabindex="-1"><a class="header-anchor" href="#🔹-redis-scripting"><span>🔹 Redis Scripting</span></a></h3><ul><li><p>Redis hỗ trợ <strong>Lua Scripting</strong> giúp chạy logic phức tạp ngay trên server, giúp tăng tốc thay vì gửi nhiều lệnh riêng lẻ.</p></li><li><p>Ví dụ Lua tính tổng 2 số:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">EVAL <span class="token string">&quot;return ARGV[1] + ARGV[2]&quot;</span> <span class="token number">0</span> <span class="token number">10</span> <span class="token number">20</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Lợi ích của Redis Scripting:</p><ul><li>Nhanh hơn: Lua script chạy trên server, giảm độ trễ.</li><li>Atomic: Toàn bộ script chạy như một Transaction, không bị xen ngang.</li><li>Có thể dùng biến tạm: Xử lý logic phức tạp mà không cần lưu xuống Redis.</li></ul></li></ul><p><a name="2"></a></p><h2 id="📌-2-redis-pub-sub-stream" tabindex="-1"><a class="header-anchor" href="#📌-2-redis-pub-sub-stream"><span>📌 2. Redis Pub/Sub &amp; Stream</span></a></h2><p>Redis cung cấp hai cơ chế giao tiếp theo mô hình message queue:</p><ul><li>Pub/Sub (Publish/Subscribe) – Hệ thống gửi/nhận tin nhắn theo kênh (channel).</li><li>Stream – Cơ chế lưu trữ &amp; xử lý dữ liệu dạng log</li></ul><h3 id="🔹-redis-pub-sub" tabindex="-1"><a class="header-anchor" href="#🔹-redis-pub-sub"><span>🔹 Redis Pub/Sub</span></a></h3><p>🚀 Cách hoạt động:</p><ul><li>Publisher gửi tin nhắn vào một channel.</li><li>Subscribers đang lắng nghe channel đó sẽ nhận được tin nhắn ngay lập tức.</li><li>Không lưu trữ tin nhắn: Nếu subscriber offline, sẽ không nhận được tin cũ.</li></ul><h3 id="🔹-redis-pub-sub-1" tabindex="-1"><a class="header-anchor" href="#🔹-redis-pub-sub-1"><span>🔹 Redis Pub/Sub</span></a></h3><p>🚀 Cách hoạt động:</p><ul><li>Producer ghi dữ liệu vào Stream.</li><li>Consumer đọc dữ liệu từ Stream</li><li>Tin nhắn được lưu lại theo thời gian.</li></ul><h3 id="🔹-so-sanh-redis-pub-sub-stream" tabindex="-1"><a class="header-anchor" href="#🔹-so-sanh-redis-pub-sub-stream"><span>🔹 So sánh Redis Pub/Sub &amp; Stream</span></a></h3><table><thead><tr><th style="text-align:center;">Tính năng</th><th style="text-align:center;">Pub/Sub</th><th style="text-align:center;">Stream</th></tr></thead><tbody><tr><td style="text-align:center;">Lưu trữ tin nhắn</td><td style="text-align:center;">❌ Không lưu trữ</td><td style="text-align:center;">✅ Có lưu</td></tr><tr><td style="text-align:center;">Xử lý lại tin nhắn</td><td style="text-align:center;">❌ Không được</td><td style="text-align:center;">✅ Có thể</td></tr><tr><td style="text-align:center;">Mô hình sử dụng</td><td style="text-align:center;">Push ngay lập tức</td><td style="text-align:center;">Hàng đợi tin nhắn</td></tr><tr><td style="text-align:center;">Hỗ trợ Consumer Groups</td><td style="text-align:center;">❌ Không</td><td style="text-align:center;">✅ Có</td></tr></tbody></table><p>🚀 Dùng Pub/Sub khi cần truyền dữ liệu theo thời gian thực.</p><p>🚀 Dùng Stream khi cần lưu trữ và xử lý tin nhắn lại sau này.</p><p><a name="3"></a></p><h2 id="📌-3-toi-uu-hoa-redis-performance-tuning" tabindex="-1"><a class="header-anchor" href="#📌-3-toi-uu-hoa-redis-performance-tuning"><span>📌 3. Tối ưu hóa Redis (Performance Tuning)</span></a></h2><p>Redis là một trong những hệ thống lưu trữ nhanh nhất, nhưng vẫn cần tối ưu để đạt hiệu suất cao nhất.</p><p>Dưới đây là các chiến lược tối ưu Redis hiệu quả.</p><h3 id="🔹-cau-hinh-redis-toi-uu" tabindex="-1"><a class="header-anchor" href="#🔹-cau-hinh-redis-toi-uu"><span>🔹 Cấu hình Redis tối ưu</span></a></h3><h4 id="_1️⃣-đieu-chinh-maxmemory-đe-tranh-het-ram-out-of-memory" tabindex="-1"><a class="header-anchor" href="#_1️⃣-đieu-chinh-maxmemory-đe-tranh-het-ram-out-of-memory"><span>1️⃣ Điều chỉnh maxmemory để tránh hết RAM (Out of Memory)</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># Đặt giới hạn bộ nhớ trong file redis.conf</span></span>
<span class="line">maxmemory 1gb  <span class="token comment"># Giới hạn Redis chỉ dùng tối đa 1GB RAM</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>👉 Nếu bộ nhớ đầy, Redis sẽ xóa key theo maxmemory-policy. Một số policy phổ biến:</p><ul><li>noeviction (mặc định) → Không xóa, trả lỗi khi hết bộ nhớ.</li><li>allkeys-lru → Xóa key ít được sử dụng nhất (Least Recently Used - LRU).</li><li>volatile-lru → Chỉ xóa key có TTL (time-to-live).</li></ul><p>👉 Đổi policy trong redis.conf:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">maxmemory-policy allkeys-lru</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2️⃣-toi-uu-appendonly-va-save-đe-giam-i-o-disk" tabindex="-1"><a class="header-anchor" href="#_2️⃣-toi-uu-appendonly-va-save-đe-giam-i-o-disk"><span>2️⃣ Tối ưu appendonly và save để giảm I/O disk</span></a></h4><p>Nếu Redis bị chậm do ghi đĩa (fsync quá nhiều), điều chỉnh như sau:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># Tắt ghi đĩa liên tục (appendonly) nếu không cần thiết</span></span>
<span class="line">appendonly no  <span class="token comment"># Mặc định là &quot;yes&quot;, đổi thành &quot;no&quot; nếu không cần persistence</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Điều chỉnh snapshot để giảm tần suất ghi disk</span></span>
<span class="line">save <span class="token number">900</span> <span class="token number">1</span>  <span class="token comment"># Lưu snapshot sau mỗi 900 giây nếu có ít nhất 1 thay đổi</span></span>
<span class="line">save <span class="token number">300</span> <span class="token number">10</span> <span class="token comment"># Lưu snapshot sau mỗi 300 giây nếu có ít nhất 10 thay đổi</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>🔥 Nếu Redis chỉ làm cache, có thể tắt luôn snapshot.</p><h3 id="🔹-toi-uu-query-trong-redis" tabindex="-1"><a class="header-anchor" href="#🔹-toi-uu-query-trong-redis"><span>🔹 Tối ưu Query trong Redis</span></a></h3><h4 id="_1️⃣-giam-so-lan-truy-van-bang-pipelining" tabindex="-1"><a class="header-anchor" href="#_1️⃣-giam-so-lan-truy-van-bang-pipelining"><span>1️⃣ Giảm số lần truy vấn bằng Pipelining</span></a></h4><p>Khi gửi nhiều lệnh Redis, thay vì gọi từng lệnh một (tốn nhiều round-trip), có thể dùng pipelining để gửi nhiều lệnh cùng lúc:</p><p>❌ Cách không tối ưu (gửi từng lệnh riêng lẻ, tốn nhiều round-trip):</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">SET user:1:name <span class="token string">&quot;Alice&quot;</span></span>
<span class="line">SET user:1:age <span class="token string">&quot;30&quot;</span></span>
<span class="line">SET user:1:email <span class="token string">&quot;alice@example.com&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>✔️ Cách tối ưu với Pipelining:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">redis-cli <span class="token parameter variable">--pipe</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF</span>
<span class="line">SET user:1:name &quot;Alice&quot;</span>
<span class="line">SET user:1:age &quot;30&quot;</span>
<span class="line">SET user:1:email &quot;alice@example.com&quot;</span>
<span class="line">EOF</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>👉 Pipeline giúp giảm đáng kể thời gian phản hồi của Redis!</p><h4 id="_2️⃣-su-dung-mget-thay-vi-nhieu-get" tabindex="-1"><a class="header-anchor" href="#_2️⃣-su-dung-mget-thay-vi-nhieu-get"><span>2️⃣ Sử dụng MGET thay vì nhiều GET</span></a></h4><p>Nếu cần lấy nhiều key cùng lúc, thay vì gọi nhiều GET, hãy dùng MGET:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">MGET user:1:name user:1:age user:1:email</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="🔹-toi-uu-du-lieu-trong-redis" tabindex="-1"><a class="header-anchor" href="#🔹-toi-uu-du-lieu-trong-redis"><span>🔹 Tối ưu Dữ liệu trong Redis</span></a></h3><h4 id="_1️⃣-dung-hash-thay-vi-qua-nhieu-string-nho" tabindex="-1"><a class="header-anchor" href="#_1️⃣-dung-hash-thay-vi-qua-nhieu-string-nho"><span>1️⃣ Dùng Hash thay vì quá nhiều String nhỏ</span></a></h4><p>Nếu lưu trữ nhiều thông tin về một đối tượng, hãy dùng Hash thay vì nhiều key riêng lẻ.</p><p>❌ Không tối ưu (tốn bộ nhớ và chậm):</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">SET user:1:name <span class="token string">&quot;Alice&quot;</span></span>
<span class="line">SET user:1:age <span class="token string">&quot;30&quot;</span></span>
<span class="line">SET user:1:email <span class="token string">&quot;alice@example.com&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>✔️ Cách tối ưu (gộp vào 1 Hash để tiết kiệm RAM và tăng tốc truy vấn):</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">HSET user:1 name <span class="token string">&quot;Alice&quot;</span> age <span class="token string">&quot;30&quot;</span> email <span class="token string">&quot;alice@example.com&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2️⃣-dung-expire-đe-tu-đong-xoa-du-lieu-khong-can-thiet" tabindex="-1"><a class="header-anchor" href="#_2️⃣-dung-expire-đe-tu-đong-xoa-du-lieu-khong-can-thiet"><span>2️⃣ Dùng EXPIRE để tự động xóa dữ liệu không cần thiết</span></a></h4><p>Nếu dữ liệu chỉ cần tồn tại trong một khoảng thời gian, đặt Time-To-Live (TTL) để tiết kiệm RAM.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">SET session:user123 <span class="token string">&quot;token_data&quot;</span> EX <span class="token number">3600</span>  <span class="token comment"># Xóa sau 1 giờ, tránh dữ liệu &quot;rác&quot; chiếm bộ nhớ Redis quá lâu.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="🔹-toi-uu-replica-cluster" tabindex="-1"><a class="header-anchor" href="#🔹-toi-uu-replica-cluster"><span>🔹 Tối ưu Replica &amp; Cluster</span></a></h3><h4 id="_1️⃣-dung-redis-replication-đe-giam-tai-cho-master" tabindex="-1"><a class="header-anchor" href="#_1️⃣-dung-redis-replication-đe-giam-tai-cho-master"><span>1️⃣ Dùng Redis Replication để giảm tải cho master</span></a></h4><p>Nếu một Redis instance xử lý quá nhiều request, hãy dùng replica để chia tải:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">replicaof <span class="token number">192.168</span>.1.100 <span class="token number">6379</span>  <span class="token comment"># Cấu hình replica của master</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>👉 Master xử lý ghi, Replica xử lý đọc → Giảm tải đáng kể.</p><h4 id="_2️⃣-dung-redis-cluster-đe-mo-rong-ngang" tabindex="-1"><a class="header-anchor" href="#_2️⃣-dung-redis-cluster-đe-mo-rong-ngang"><span>2️⃣ Dùng Redis Cluster để mở rộng ngang</span></a></h4><p>Nếu một máy chủ Redis không đủ xử lý, có thể dùng Redis Cluster để chia dữ liệu thành nhiều node.</p><h3 id="🔹-giam-sat-debug-redis" tabindex="-1"><a class="header-anchor" href="#🔹-giam-sat-debug-redis"><span>🔹 Giám sát &amp; Debug Redis</span></a></h3><p>Nếu Redis bị chậm, kiểm tra lệnh nào tốn thời gian nhất:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">SLOWLOG GET <span class="token number">5</span>  <span class="token comment"># Xem 5 lệnh chậm nhất</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><a name="4"></a></p><h2 id="📌-4-ket-hop-redis-voi-cac-ngon-ngu-lap-trinh" tabindex="-1"><a class="header-anchor" href="#📌-4-ket-hop-redis-voi-cac-ngon-ngu-lap-trinh"><span>📌 4. Kết hợp Redis với các ngôn ngữ lập trình</span></a></h2><p>Redis có thể tích hợp với hầu hết các ngôn ngữ lập trình thông qua Redis client.</p><h3 id="🔹-redis-voi-python-redis-py" tabindex="-1"><a class="header-anchor" href="#🔹-redis-voi-python-redis-py"><span>🔹 Redis với Python (redis-py)</span></a></h3><ul><li><p>Cài đặt Redis client cho Python:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">pip <span class="token function">install</span> redis</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Kết nối và thao tác với Redis:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> redis</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Kết nối Redis</span></span>
<span class="line">r <span class="token operator">=</span> redis<span class="token punctuation">.</span>Redis<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">&#39;localhost&#39;</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span> decode_responses<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Lưu dữ liệu vào Redis</span></span>
<span class="line">r<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Alice&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Lấy dữ liệu từ Redis</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Output: Alice</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="🔹-redis-voi-java-jedis-lettuce" tabindex="-1"><a class="header-anchor" href="#🔹-redis-voi-java-jedis-lettuce"><span>🔹 Redis với Java (Jedis, Lettuce)</span></a></h3><ul><li><p>Thêm dependency vào Maven:</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Kết nối và thao tác với Redis:</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span></span><span class="token class-name">Jedis</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisExample</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Charlie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/vuepress-blog/assets/app-BO_61kEJ.js" defer></script>
  </body>
</html>
