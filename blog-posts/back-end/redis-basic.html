<!doctype html>
<html lang="vi-VN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/vuepress-blog/favicon.ico"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Josefin+Sans:300,400,500,600,700&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"><title>Redis Basic | Kiáº¿n Thá»©c Tá»« Tráº£i Nghiá»‡m</title><meta name="description" content="Má»™t blog Ä‘Æ°á»£c táº¡o báº±ng VuePress">
    <link rel="preload" href="/vuepress-blog/assets/style-B07U0idc.css" as="style"><link rel="stylesheet" href="/vuepress-blog/assets/style-B07U0idc.css">
    <link rel="modulepreload" href="/vuepress-blog/assets/app-CXi1WLMJ.js"><link rel="modulepreload" href="/vuepress-blog/assets/redis-basic.html-yQIqCTmk.js">
    <link rel="prefetch" href="/vuepress-blog/assets/index.html-DfXBDDCT.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-CPMSCsQj.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-tewJf6Cb.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-X_HAjZvW.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-B_9G022V.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/fastapi-base-project.html-DRsFKG_i.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/mov-to-mp4-converter.html-Rm69eIu8.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-tesseract-series.html-U7oHkCzb.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/plsql-training-series.html-C5GdhXfy.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/redis-advanced.html-CbHlaA6s.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-training-saa-series.html-CJKZVvMH.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/jenkins.html-22_p2CDz.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-series.html-CTROfKsc.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-automation.html-DHB4UVem.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-cloud-computing.html-DPX6WAA6.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-database.html-DdZLgZrM.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-ec2.html-BlwuITKl.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-gioi-thieu-aws.html-DMK50hX8.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-iam.html-Dwc2gq4N.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-monitoring.html-8EtGSPfp.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-networking.html-C-be28CF.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-practice.html-CTkrKq6Q.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-serverless.html-n1OmimG2.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-storage.html-GZc7yrh_.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-beginner.html-i3M9d5zN.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-intermediate.html-SDFLr4rZ.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-shell-script.html-Dha-VQ0J.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-accuracy-perfomance.html-DJhTfVjp.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-cache-tesseract.html-vR0khc4V.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-gioi-thieu-tesseract.html-2ZmwDMIS.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-practical.html-C3ai7rO-.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-template-matching.html-tUTWSYBA.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-tong-quan.html-ydRBQi9i.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-training-tesseract.html-DX8PM938.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-advanced.html-BHjtGT5H.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-beginner.html-BgUhM-F9.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-expert.html-D6DG71FF.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-intermediate.html-DxCLYcR9.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/git-practices.html-CXDgMSrd.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-COxqkFQD.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-Ccwby0EF.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-BXMM0-N9.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/404.html-CS2QgJZU.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/setupDevtools-7MC2TMWH-wrXCSqS7.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container no-sidebar external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/vuepress-blog/"><img class="vp-site-logo" src="/vuepress-blog/images/logo.png" alt="Kiáº¿n Thá»©c Tá»« Tráº£i Nghiá»‡m"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Kiáº¿n Thá»©c Tá»« Tráº£i Nghiá»‡m</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/" aria-label="Trang Chá»§"><!---->Trang Chá»§<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/project/" aria-label="Dá»± Ãn"><!---->Dá»± Ãn<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/blog/" aria-label="Blog"><!---->Blog<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/about/" aria-label="Vá» TÃ´i"><!---->Vá» TÃ´i<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">NgÃ´n Ngá»¯</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">NgÃ´n Ngá»¯</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/vuepress-blog/blog-posts/back-end/redis-basic.html" aria-label="Tiáº¿ng Viá»‡t"><!---->Tiáº¿ng Viá»‡t<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vuepress-blog/en/" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/" aria-label="Trang Chá»§"><!---->Trang Chá»§<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/project/" aria-label="Dá»± Ãn"><!---->Dá»± Ãn<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/blog/" aria-label="Blog"><!---->Blog<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/about/" aria-label="Vá» TÃ´i"><!---->Vá» TÃ´i<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">NgÃ´n Ngá»¯</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">NgÃ´n Ngá»¯</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/vuepress-blog/blog-posts/back-end/redis-basic.html" aria-label="Tiáº¿ng Viá»‡t"><!---->Tiáº¿ng Viá»‡t<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vuepress-blog/en/" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content" vp-content><!--[--><!--]--><div><h1 id="redis-basic" tabindex="-1"><a class="header-anchor" href="#redis-basic"><span>Redis Basic</span></a></h1><p><a href="#1">1. Giá»›i thiá»‡u vá» Redis</a></p><p><a href="#2">2. CÃ¡c kiá»ƒu dá»¯ liá»‡u trong Redis</a></p><p><a href="#3">3. CÃ¡c cÃ¢u lá»‡nh cÆ¡ báº£n lÃ m viá»‡c vá»›i Redis</a></p><p><a href="#4">4. Persistence trong Redis (LÆ°u trá»¯ dá»¯ liá»‡u lÃ¢u dÃ i)</a></p><p><a href="#5">5. Redis Replication (NhÃ¢n báº£n dá»¯ liá»‡u)</a></p><p><a href="#6">6. Redis Cluster (PhÃ¢n tÃ¡n dá»¯ liá»‡u)</a></p><p><a name="1"></a></p><h2 id="ğŸ“Œ-1-gioi-thieu-ve-redis" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-1-gioi-thieu-ve-redis"><span>ğŸ“Œ 1. Giá»›i thiá»‡u vá» Redis</span></a></h2><h3 id="ğŸ”¹-redis-la-gi" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-redis-la-gi"><span>ğŸ”¹ Redis lÃ  gÃ¬?</span></a></h3><ul><li><p>Redis (REmote DIctionary Server) lÃ  má»™t kho lÆ°u trá»¯ cáº¥u trÃºc dá»¯ liá»‡u trong bá»™ nhá»›:</p><ul><li>LÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u phi quan há»‡.</li><li>LÆ°u trá»¯ dá»¯ liá»‡u trá»±c tiáº¿p trong RAM thay vÃ¬ trÃªn Ä‘Ä©a cá»©ng hay SSD.</li></ul></li><li><p>Redis cho phÃ©p táº¡o ra má»™t Server cÃ³ chá»©c nÄƒng dÃ¹ng bá»™ nhá»› Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u.</p></li></ul><h3 id="ğŸ”¹-redis-luu-tru-du-lieu-nhu-the-nao" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-redis-luu-tru-du-lieu-nhu-the-nao"><span>ğŸ”¹ Redis lÆ°u trá»¯ dá»¯ liá»‡u nhÆ° tháº¿ nÃ o?</span></a></h3><ul><li><p>Dá»¯ liá»‡u lÆ°u trá»¯ á»Ÿ dáº¡ng cáº·p key/value, vá»›i giÃ¡ trá»‹ lÆ°u trá»¯ lÃ  cÃ¡c chuá»—i, danh sÃ¡ch, táº­p há»£p</p></li><li><p>Máº·c Ä‘á»‹nh Server Redis láº¯ng nghe á»Ÿ cá»•ng 6379, cÃ³ nhiá»u thÆ° viá»‡n há»— trá»£ káº¿t ná»‘i cho cÃ¡c ngÃ´n ngá»¯ nhÆ° PHP, C#, Java â€¦</p></li></ul><h3 id="ğŸ”¹-tai-sao-nen-dung-redis" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-tai-sao-nen-dung-redis"><span>ğŸ”¹ Táº¡i sao nÃªn dÃ¹ng Redis?</span></a></h3><p>âœ”ï¸ Tá»‘c Ä‘á»™ cao: VÃ¬ dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trong RAM, Redis cÃ³ tá»‘c Ä‘á»™ truy xuáº¥t cá»±c ká»³ nhanh, thÆ°á»ng Ä‘áº¡t Ä‘áº¿n hÃ ng trÄƒm nghÃ¬n Ä‘áº¿n hÃ ng triá»‡u thao tÃ¡c má»—i giÃ¢y.</p><p>âœ”ï¸ Äa dáº¡ng cáº¥u trÃºc dá»¯ liá»‡u: Redis há»— trá»£ nhiá»u loáº¡i cáº¥u trÃºc dá»¯ liá»‡u nhÆ° strings, lists, sets, sorted sets, hashes</p><p>âœ”ï¸ Persistence: Redis cung cáº¥p cÃ¡c cÆ¡ cháº¿ Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u xuá»‘ng Ä‘Ä©a (snapshotting vÃ  append-only file), Ä‘áº£m báº£o dá»¯ liá»‡u khÃ´ng bá»‹ máº¥t khi server bá»‹ táº¯t.</p><p>âœ”ï¸ TÃ­nh sáºµn sÃ ng cao vÃ  dá»… má»Ÿ rá»™ng.</p><h3 id="ğŸ”¹-ung-dung-cua-redis" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-ung-dung-cua-redis"><span>ğŸ”¹ á»¨ng dá»¥ng cá»§a Redis</span></a></h3><p>Vá»›i Æ°u Ä‘iá»ƒm lÃ  tá»‘c Ä‘á»™, an toÃ n (cÃ³ cÆ¡ cháº¿ xÃ¡c thá»±c) nÃªn Redis Ä‘Æ°á»£c á»©ng dá»¥ng trong Caching.</p><h3 id="ğŸ”¹-cai-Ä‘at-redis" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cai-Ä‘at-redis"><span>ğŸ”¹ CÃ i Ä‘áº·t Redis</span></a></h3><p>Äá»ƒ cÃ i Ä‘áº·t Redis, chÃºng ta truy cáº­p <a href="https://redis.io/download/" target="_blank" rel="noopener noreferrer">redis.io</a> vÃ  lÃ m theo hÆ°á»›ng dáº«n.</p><p>ğŸ”¥ <strong>LÆ°u Ã½:</strong></p><ul><li><p>DÃ¹ cÃ³ support cho cáº£ Linux vÃ  Windows, nhÆ°ng phiÃªn báº£n support cho Windows cÃ³ tá»« khÃ¡ lÃ¢u vÃ  khÃ´ng cÃ²n Ä‘Æ°á»£c update.</p></li><li><p>Äá»ƒ dá»… cho viá»‡c thá»±c hÃ nh, cÃ³ thá»ƒ download cÃ¡c phiÃªn báº£n cÅ© Ä‘á»ƒ cháº¡y thá»­ vÃ  test trÃªn windows táº¡i <a href="https://github.com/MicrosoftArchive/redis/releases" target="_blank" rel="noopener noreferrer">Github - Redis</a>.</p><ul><li>CÃ¡ch cÃ i cÃ³ thá»ƒ tham kháº£o <a href="https://stackjava.com/redis/huong-dan-cai-dat-redis-server-tren-windows.html" target="_blank" rel="noopener noreferrer">táº¡i Ä‘Ã¢y</a>.</li></ul></li></ul><p><a name="2"></a></p><h2 id="ğŸ“Œ-2-cac-kieu-du-lieu-trong-redis" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-2-cac-kieu-du-lieu-trong-redis"><span>ğŸ“Œ 2. CÃ¡c kiá»ƒu dá»¯ liá»‡u trong Redis</span></a></h2><table><thead><tr><th style="text-align:center;">Kiá»ƒu dá»¯ liá»‡u</th><th style="text-align:center;">MÃ´ táº£</th></tr></thead><tbody><tr><td style="text-align:center;">String (Chuá»—i)</td><td style="text-align:center;">LÃ  kiá»ƒu dá»¯ liá»‡u Ä‘Æ¡n giáº£n nháº¥t, cÃ³ thá»ƒ chá»©a vÄƒn báº£n, sá»‘ nguyÃªn, hoáº·c sá»‘ thá»±c</td></tr><tr><td style="text-align:center;">List (Danh sÃ¡ch)</td><td style="text-align:center;">Danh sÃ¡ch cÃ³ thá»© tá»±, há»— trá»£ thÃªm/xÃ³a pháº§n tá»­ tá»« hai Ä‘áº§u</td></tr><tr><td style="text-align:center;">Set (Táº­p há»£p)</td><td style="text-align:center;">Má»™t táº­p há»£p khÃ´ng cÃ³ thá»© tá»±, khÃ´ng chá»©a pháº§n tá»­ trÃ¹ng láº·p</td></tr><tr><td style="text-align:center;">Sorted Set</td><td style="text-align:center;">Giá»‘ng Set nhÆ°ng má»—i pháº§n tá»­ cÃ³ má»™t Ä‘iá»ƒm sá»‘ (score) Ä‘á»ƒ sáº¯p xáº¿p</td></tr><tr><td style="text-align:center;">Hash (BÄƒm)</td><td style="text-align:center;">LÆ°u trá»¯ dá»¯ liá»‡u dáº¡ng key-value trong má»™t key cha.</td></tr><tr><td style="text-align:center;">Bitmap (Dá»¯ liá»‡u nhá»‹ phÃ¢n)</td><td style="text-align:center;">LÆ°u trá»¯ bit (0/1), phÃ¹ há»£p Ä‘á»ƒ theo dÃµi tráº¡ng thÃ¡i theo thá»i gian (vÃ­ dá»¥: check-in má»—i ngÃ y).</td></tr><tr><td style="text-align:center;">HyperLogLog (Äáº¿m pháº§n tá»­ khÃ´ng trÃ¹ng)</td><td style="text-align:center;">Æ¯á»›c lÆ°á»£ng sá»‘ lÆ°á»£ng pháº§n tá»­ duy nháº¥t mÃ  khÃ´ng cáº§n lÆ°u toÃ n bá»™ dá»¯ liá»‡u</td></tr></tbody></table><p><a name="3"></a></p><h2 id="ğŸ“Œ-3-cac-cau-lenh-co-ban-lam-viec-voi-redis" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-3-cac-cau-lenh-co-ban-lam-viec-voi-redis"><span>ğŸ“Œ 3. CÃ¡c cÃ¢u lá»‡nh cÆ¡ báº£n lÃ m viá»‡c vá»›i Redis</span></a></h2><h3 id="ğŸ”¹-ket-noi-voi-redis" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-ket-noi-voi-redis"><span>ğŸ”¹ Káº¿t ná»‘i vá»›i Redis</span></a></h3><p>TrÆ°á»›c khi cháº¡y cÃ¡c lá»‡nh Redis, chÃºng ta cáº§n káº¿t ná»‘i Ä‘áº¿n Redis Server.</p><p>DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch káº¿t ná»‘i Redis theo tá»«ng mÃ´i trÆ°á»ng:</p><ul><li><p>Khá»Ÿi Ä‘á»™ng Redis Server:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># Cháº¡y Redis trÃªn mÃ¡y cá»¥c bá»™ (Local)</span></span>
<span class="line">redis-server</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Cháº¡y Redis vá»›i Docker</span></span>
<span class="line"><span class="token function">docker</span> run <span class="token parameter variable">--name</span> my-redis <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 redis</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Káº¿t ná»‘i Redis Ä‘Ã£ cháº¡y vá»›i Docker</span></span>
<span class="line">redis-cli <span class="token parameter variable">-h</span> localhost <span class="token parameter variable">-p</span> <span class="token number">6379</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Káº¿t ná»‘i Ä‘áº¿n Redis:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># Káº¿t ná»‘i Redis Ä‘ang cháº¡y trÃªn mÃ¡y cá»¥c bá»™</span></span>
<span class="line">redis-cli</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Káº¿t ná»‘i Redis Server tá»« xa</span></span>
<span class="line">redis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.100 <span class="token parameter variable">-p</span> <span class="token number">6379</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Náº¿u Redis cÃ³ máº­t kháº©u</span></span>
<span class="line">redis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.100 <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token parameter variable">-a</span> yourpassword</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="ğŸ”¹-cac-cau-lenh-chung" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cac-cau-lenh-chung"><span>ğŸ”¹ CÃ¡c cÃ¢u lá»‡nh chung</span></a></h3><table><thead><tr><th style="text-align:center;">Lá»‡nh</th><th style="text-align:center;">MÃ´ táº£</th></tr></thead><tbody><tr><td style="text-align:center;">PING</td><td style="text-align:center;">Kiá»ƒm tra xem Redis cÃ³ Ä‘ang cháº¡y khÃ´ng</td></tr><tr><td style="text-align:center;">SELECT index</td><td style="text-align:center;">Chá»n database (Redis cÃ³ 16 DB máº·c Ä‘á»‹nh, tá»« 0 Ä‘áº¿n 15)</td></tr><tr><td style="text-align:center;">FLUSHDB</td><td style="text-align:center;">XÃ³a toÃ n bá»™ dá»¯ liá»‡u trong database hiá»‡n táº¡i</td></tr><tr><td style="text-align:center;">FLUSHALL</td><td style="text-align:center;">XÃ³a toÃ n bá»™ dá»¯ liá»‡u trong táº¥t cáº£ databases</td></tr><tr><td style="text-align:center;">EXISTS key</td><td style="text-align:center;">Kiá»ƒm tra key cÃ³ tá»“n táº¡i khÃ´ng (1: cÃ³, 0: khÃ´ng)</td></tr><tr><td style="text-align:center;">DEL key</td><td style="text-align:center;">XÃ³a key</td></tr><tr><td style="text-align:center;">EXPIRE key seconds</td><td style="text-align:center;">Äáº·t thá»i gian sá»‘ng cho key (tÃ­nh báº±ng giÃ¢y)</td></tr><tr><td style="text-align:center;">TTL key</td><td style="text-align:center;">Kiá»ƒm tra thá»i gian sá»‘ng cÃ²n láº¡i cá»§a key</td></tr><tr><td style="text-align:center;">PERSIST key</td><td style="text-align:center;">XÃ³a thá»i gian sá»‘ng cá»§a key, giá»¯ vÄ©nh viá»…n</td></tr><tr><td style="text-align:center;">KEYS *</td><td style="text-align:center;">Láº¥y táº¥t cáº£ cÃ¡c key hiá»‡n cÃ³</td></tr></tbody></table><p>ğŸ“ VÃ­ dá»¥:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">SET user <span class="token string">&quot;Alice&quot;</span></span>
<span class="line">EXISTS user    <span class="token comment"># Káº¿t quáº£: 1</span></span>
<span class="line">DEL user</span>
<span class="line">EXISTS user    <span class="token comment"># Káº¿t quáº£: 0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ”¹-cac-cau-lenh-lam-viec-voi-string" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cac-cau-lenh-lam-viec-voi-string"><span>ğŸ”¹ CÃ¡c cÃ¢u lá»‡nh lÃ m viá»‡c vá»›i String</span></a></h3><table><thead><tr><th style="text-align:center;">Lá»‡nh</th><th style="text-align:center;">MÃ´ táº£</th></tr></thead><tbody><tr><td style="text-align:center;">SET key value</td><td style="text-align:center;">GÃ¡n giÃ¡ trá»‹ cho key</td></tr><tr><td style="text-align:center;">GET key</td><td style="text-align:center;">Láº¥y giÃ¡ trá»‹ cá»§a key</td></tr><tr><td style="text-align:center;">INCR key</td><td style="text-align:center;">TÄƒng giÃ¡ trá»‹ sá»‘ cá»§a key lÃªn 1</td></tr><tr><td style="text-align:center;">DECR key</td><td style="text-align:center;">Giáº£m giÃ¡ trá»‹ sá»‘ cá»§a key xuá»‘ng 1</td></tr><tr><td style="text-align:center;">INCRBY key value</td><td style="text-align:center;">TÄƒng giÃ¡ trá»‹ cá»§a key lÃªn value</td></tr><tr><td style="text-align:center;">DECRBY key value</td><td style="text-align:center;">Giáº£m giÃ¡ trá»‹ cá»§a key xuá»‘ng value</td></tr><tr><td style="text-align:center;">MSET key1 value1 key2 value2</td><td style="text-align:center;">GÃ¡n nhiá»u key-value cÃ¹ng lÃºc 1</td></tr><tr><td style="text-align:center;">MGET key1 key2</td><td style="text-align:center;">Láº¥y giÃ¡ trá»‹ cá»§a nhiá»u key cÃ¹ng lÃºc</td></tr><tr><td style="text-align:center;">APPEND key value</td><td style="text-align:center;">Ná»‘i thÃªm dá»¯ liá»‡u vÃ o key</td></tr></tbody></table><p>ğŸ“ VÃ­ dá»¥:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">SET counter <span class="token number">10</span></span>
<span class="line">INCR counter   <span class="token comment"># Káº¿t quáº£: 11</span></span>
<span class="line">INCRBY counter <span class="token number">5</span>  <span class="token comment"># Káº¿t quáº£: 16</span></span>
<span class="line">DECR counter   <span class="token comment"># Káº¿t quáº£: 15</span></span>
<span class="line">GET counter    <span class="token comment"># Káº¿t quáº£: &quot;15&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ”¹-cac-cau-lenh-lam-viec-voi-hash-bang-bam" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cac-cau-lenh-lam-viec-voi-hash-bang-bam"><span>ğŸ”¹ CÃ¡c cÃ¢u lá»‡nh lÃ m viá»‡c vá»›i Hash (Báº£ng bÄƒm)</span></a></h3><table><thead><tr><th style="text-align:center;">Lá»‡nh</th><th style="text-align:center;">MÃ´ táº£</th></tr></thead><tbody><tr><td style="text-align:center;">HSET key field value</td><td style="text-align:center;">GÃ¡n giÃ¡ trá»‹ vÃ o má»™t field trong hash</td></tr><tr><td style="text-align:center;">HGET key field</td><td style="text-align:center;">Láº¥y giÃ¡ trá»‹ cá»§a field</td></tr><tr><td style="text-align:center;">HGETALL key</td><td style="text-align:center;">Láº¥y toÃ n bá»™ field vÃ  value trong hash</td></tr><tr><td style="text-align:center;">HDEL key field</td><td style="text-align:center;">XÃ³a field trong hash</td></tr><tr><td style="text-align:center;">HLEN key</td><td style="text-align:center;">Äáº¿m sá»‘ lÆ°á»£ng field trong hash</td></tr><tr><td style="text-align:center;">HEXISTS key field</td><td style="text-align:center;">Kiá»ƒm tra field cÃ³ tá»“n táº¡i khÃ´ng</td></tr><tr><td style="text-align:center;">HMSET key field1 value1 field2 value2</td><td style="text-align:center;">GÃ¡n nhiá»u field trong hash</td></tr><tr><td style="text-align:center;">HMGET key field1 field2</td><td style="text-align:center;">Láº¥y nhiá»u field cÃ¹ng lÃºc</td></tr></tbody></table><p>ğŸ“ VÃ­ dá»¥:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">HSET user:1 name <span class="token string">&quot;Alice&quot;</span></span>
<span class="line">HSET user:1 age <span class="token number">25</span></span>
<span class="line">HGET user:1 name   <span class="token comment"># Káº¿t quáº£: &quot;Alice&quot;</span></span>
<span class="line">HGETALL user:1     <span class="token comment"># Káº¿t quáº£: {&quot;name&quot;: &quot;Alice&quot;, &quot;age&quot;: &quot;25&quot;}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ”¹-cac-cau-lenh-lam-viec-voi-list" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cac-cau-lenh-lam-viec-voi-list"><span>ğŸ”¹ CÃ¡c cÃ¢u lá»‡nh lÃ m viá»‡c vá»›i List</span></a></h3><table><thead><tr><th style="text-align:center;">Lá»‡nh</th><th style="text-align:center;">MÃ´ táº£</th></tr></thead><tbody><tr><td style="text-align:center;">LPUSH key value</td><td style="text-align:center;">ThÃªm pháº§n tá»­ vÃ o Ä‘áº§u danh sÃ¡ch</td></tr><tr><td style="text-align:center;">RPUSH key value</td><td style="text-align:center;">ThÃªm pháº§n tá»­ vÃ o cuá»‘i danh sÃ¡ch</td></tr><tr><td style="text-align:center;">LPOP key</td><td style="text-align:center;">Láº¥y vÃ  xÃ³a pháº§n tá»­ Ä‘áº§u danh sÃ¡ch</td></tr><tr><td style="text-align:center;">RPOP key</td><td style="text-align:center;">Láº¥y vÃ  xÃ³a pháº§n tá»­ cuá»‘i danh sÃ¡ch</td></tr><tr><td style="text-align:center;">LLEN key</td><td style="text-align:center;">Äáº¿m sá»‘ pháº§n tá»­ trong danh sÃ¡ch</td></tr><tr><td style="text-align:center;">LRANGE key start stop</td><td style="text-align:center;">Láº¥y danh sÃ¡ch trong khoáº£ng (chá»‰ má»¥c tá»« 0)</td></tr><tr><td style="text-align:center;">LREM key count value</td><td style="text-align:center;">XÃ³a count pháº§n tá»­ cÃ³ giÃ¡ trá»‹ value</td></tr></tbody></table><p>ğŸ“ VÃ­ dá»¥:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">LPUSH queue <span class="token string">&quot;Task1&quot;</span></span>
<span class="line">LPUSH queue <span class="token string">&quot;Task2&quot;</span></span>
<span class="line">RPUSH queue <span class="token string">&quot;Task3&quot;</span></span>
<span class="line">LRANGE queue <span class="token number">0</span> <span class="token parameter variable">-1</span>  <span class="token comment"># Káº¿t quáº£: [&quot;Task2&quot;, &quot;Task1&quot;, &quot;Task3&quot;]</span></span>
<span class="line">LPOP queue  <span class="token comment"># Káº¿t quáº£: &quot;Task2&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ”¹-cac-cau-lenh-lam-viec-voi-list-1" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cac-cau-lenh-lam-viec-voi-list-1"><span>ğŸ”¹ CÃ¡c cÃ¢u lá»‡nh lÃ m viá»‡c vá»›i List</span></a></h3><table><thead><tr><th style="text-align:center;">Lá»‡nh</th><th style="text-align:center;">MÃ´ táº£</th></tr></thead><tbody><tr><td style="text-align:center;">SADD key value</td><td style="text-align:center;">ThÃªm pháº§n tá»­ vÃ o set</td></tr><tr><td style="text-align:center;">SREM key value</td><td style="text-align:center;">XÃ³a pháº§n tá»­ khá»i set</td></tr><tr><td style="text-align:center;">SMEMBERS key</td><td style="text-align:center;">Láº¥y táº¥t cáº£ pháº§n tá»­ trong set</td></tr><tr><td style="text-align:center;">SISMEMBER key value</td><td style="text-align:center;">Kiá»ƒm tra pháº§n tá»­ cÃ³ tá»“n táº¡i khÃ´ng</td></tr><tr><td style="text-align:center;">SCARD key</td><td style="text-align:center;">Äáº¿m sá»‘ lÆ°á»£ng pháº§n tá»­ trong set</td></tr><tr><td style="text-align:center;">SUNION key1 key2</td><td style="text-align:center;">Há»£p hai set</td></tr><tr><td style="text-align:center;">SINTER key1 key2</td><td style="text-align:center;">Láº¥y pháº§n tá»­ chung cá»§a hai set</td></tr></tbody></table><p>ğŸ“ VÃ­ dá»¥:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">SADD fruits <span class="token string">&quot;Apple&quot;</span> <span class="token string">&quot;Banana&quot;</span></span>
<span class="line">SADD fruits <span class="token string">&quot;Orange&quot;</span></span>
<span class="line">SMEMBERS fruits  <span class="token comment"># Káº¿t quáº£: {&quot;Apple&quot;, &quot;Banana&quot;, &quot;Orange&quot;}</span></span>
<span class="line">SISMEMBER fruits <span class="token string">&quot;Banana&quot;</span>  <span class="token comment"># Káº¿t quáº£: 1 (true)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a name="4"></a></p><h2 id="ğŸ“Œ-4-persistence-trong-redis" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-4-persistence-trong-redis"><span>ğŸ“Œ 4. Persistence trong Redis</span></a></h2><ul><li><p>Máº·c dÃ¹ Redis lÃ  má»™t in-memory database (cÆ¡ sá»Ÿ dá»¯ liá»‡u lÆ°u trá»¯ trong bá»™ nhá»› RAM), nhÆ°ng nÃ³ váº«n cung cáº¥p cÃ¡c cÆ¡ cháº¿ persistence Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u khÃ´ng bá»‹ máº¥t khi server gáº·p sá»± cá»‘ hoáº·c khá»Ÿi Ä‘á»™ng láº¡i.</p></li><li><p>Redis há»— trá»£ hai phÆ°Æ¡ng phÃ¡p lÆ°u trá»¯ chÃ­nh:</p><ul><li>RDB (Redis Database Backup) - LÆ°u trá»¯ theo thá»i Ä‘iá»ƒm (Snapshot)</li><li>AOF (Append-Only File) - Ghi log tá»«ng thao tÃ¡c</li></ul><p>ğŸ”¥ Redis cÅ©ng cÃ³ thá»ƒ káº¿t há»£p cáº£ hai Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u an toÃ n hÆ¡n.</p></li></ul><h3 id="ğŸ”¹-rdb-redis-database-snapshot" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-rdb-redis-database-snapshot"><span>ğŸ”¹ RDB (Redis Database Snapshot)</span></a></h3><p>RDB lÆ°u trá»¯ toÃ n bá»™ dá»¯ liá»‡u cá»§a Redis vÃ o má»™t file .rdb theo tá»«ng khoáº£ng thá»i gian.</p><p>Khi Redis khá»Ÿi Ä‘á»™ng láº¡i, nÃ³ sáº½ load dá»¯ liá»‡u tá»« file .rdb.</p><p>âœ”ï¸ Æ¯u Ä‘iá»ƒm:</p><ul><li>Tá»‘c Ä‘á»™ lÆ°u trá»¯ nhanh vÃ¬ nÃ³ ghi theo kiá»ƒu snapshot.</li><li>File .rdb gá»n nháº¹, dá»… sao lÆ°u.</li></ul><p>âŒ NhÆ°á»£c Ä‘iá»ƒm:</p><ul><li>CÃ³ thá»ƒ máº¥t dá»¯ liá»‡u giá»¯a cÃ¡c láº§n snapshot.</li><li>Ghi file .rdb tá»‘n tÃ i nguyÃªn náº¿u dá»¯ liá»‡u lá»›n.</li></ul><p>ğŸš€ CÃ¡ch báº­t RDB:</p><p>RDB Ä‘Æ°á»£c kÃ­ch hoáº¡t máº·c Ä‘á»‹nh trong redis.conf:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">save <span class="token number">900</span> <span class="token number">1</span>   <span class="token comment"># LÆ°u sau 900 giÃ¢y náº¿u cÃ³ Ã­t nháº¥t 1 thay Ä‘á»•i</span></span>
<span class="line">save <span class="token number">300</span> <span class="token number">10</span>  <span class="token comment"># LÆ°u sau 300 giÃ¢y náº¿u cÃ³ Ã­t nháº¥t 10 thay Ä‘á»•i</span></span>
<span class="line">save <span class="token number">60</span> <span class="token number">10000</span> <span class="token comment"># LÆ°u sau 60 giÃ¢y náº¿u cÃ³ Ã­t nháº¥t 10000 thay Ä‘á»•i</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Hoáº·c lÆ°u ngay báº±ng lá»‡nh:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">BGSAVE</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>File .rdb máº·c Ä‘á»‹nh Ä‘Æ°á»£c lÆ°u táº¡i:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">/var/lib/redis/dump.rdb</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="ğŸ”¹-aof-append-only-file" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-aof-append-only-file"><span>ğŸ”¹ AOF (Append Only File)</span></a></h3><p>AOF ghi láº¡i toÃ n bá»™ lá»‡nh thay Ä‘á»•i dá»¯ liá»‡u cá»§a Redis vÃ o file log (appendonly.aof).</p><p>Khi Redis restart, nÃ³ sáº½ cháº¡y láº¡i cÃ¡c lá»‡nh nÃ y Ä‘á»ƒ khÃ´i phá»¥c dá»¯ liá»‡u.</p><p>âœ”ï¸ Æ¯u Ä‘iá»ƒm:</p><ul><li>Äáº£m báº£o khÃ´ng máº¥t dá»¯ liá»‡u.</li><li>Ghi log theo tá»«ng lá»‡nh nÃªn cÃ³ thá»ƒ khÃ´i phá»¥c chi tiáº¿t.</li></ul><p>âŒ NhÆ°á»£c Ä‘iá»ƒm:</p><ul><li>File AOF lá»›n hÆ¡n RDB vÃ¬ ghi tá»«ng lá»‡nh.</li><li>Cáº§n tá»‘i Æ°u hÃ³a (AOF rewrite) Ä‘á»ƒ trÃ¡nh file quÃ¡ lá»›n.</li></ul><p>ğŸš€ CÃ¡ch báº­t AOF:</p><p>Báº­t AOF trong redis.conf:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">appendonly <span class="token function">yes</span></span>
<span class="line">appendfilename <span class="token string">&quot;appendonly.aof&quot;</span></span>
<span class="line">appendfsync everysec <span class="token comment"># Ghi vÃ o disk má»—i giÃ¢y (cÃ¢n báº±ng hiá»‡u suáº¥t vÃ  an toÃ n)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Hoáº·c báº­t AOF ngay báº±ng lá»‡nh:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">CONFIG SET appendonly <span class="token function">yes</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="ğŸ”¹-hybrid-mode-ket-hop-rdb-aof" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-hybrid-mode-ket-hop-rdb-aof"><span>ğŸ”¹ Hybrid Mode (Káº¿t há»£p RDB + AOF)</span></a></h3><p>Redis cho phÃ©p dÃ¹ng cáº£ RDB &amp; AOF cÃ¹ng lÃºc Ä‘á»ƒ táº­n dá»¥ng Æ°u Ä‘iá»ƒm cá»§a cáº£ hai.</p><p>ğŸš€ CÃ¡ch báº­t Hybrid:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">aof-use-rdb-preamble <span class="token function">yes</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>LÃºc nÃ y, Redis sáº½ ghi Ä‘Ã¨ AOF báº±ng snapshot .rdb Ä‘á»ƒ tá»‘i Æ°u dung lÆ°á»£ng.</p><p><a name="5"></a></p><h2 id="ğŸ“Œ-5-redis-replication-nhan-ban-du-lieu" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-5-redis-replication-nhan-ban-du-lieu"><span>ğŸ“Œ 5. Redis Replication (NhÃ¢n báº£n dá»¯ liá»‡u)</span></a></h2><p>Replication giÃºp Redis táº¡o nhiá»u báº£n sao (slave) cá»§a master, giÃºp Ä‘áº¡t Ä‘Æ°á»£c tÃ­nh sáºµn sÃ ng cao:</p><ul><li>Load balancing (chia táº£i).</li><li>Backup dá»¯ liá»‡u phÃ²ng trÆ°á»ng há»£p master bá»‹ lá»—i.</li><li>Há»— trá»£ failover tá»± Ä‘á»™ng.</li></ul><h3 id="ğŸ”¹-cau-hinh-master-slave" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cau-hinh-master-slave"><span>ğŸ”¹ Cáº¥u hÃ¬nh Master-Slave</span></a></h3><p>Máº·c Ä‘á»‹nh, Redis chá»‰ cÃ³ má»™t Master, nhÆ°ng cÃ³ thá»ƒ thÃªm nhiá»u Slave.</p><ul><li><p>Cáº¥u hÃ¬nh Slave:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">SLAVEOF <span class="token operator">&lt;</span>master-ip<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>master-port<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># VÃ­ dá»¥ master cháº¡y á»Ÿ 192.168.1.100:6379</span></span>
<span class="line">SLAVEOF <span class="token number">192.168</span>.1.100 <span class="token number">6379</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>hoáº·c thÃªm vÃ o redis.conf:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">replicaof <span class="token number">192.168</span>.1.100 <span class="token number">6379</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Kiá»ƒm tra Replication:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># TrÃªn Master, kiá»ƒm tra cÃ¡c Slave báº±ng lá»‡nh:</span></span>
<span class="line">INFO replication</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Káº¿t quáº£ sáº½ hiá»ƒn thá»‹ cÃ¡c Slave káº¿t ná»‘i Ä‘áº¿n Master.</p></li></ul><h3 id="ğŸ”¹-cau-hinh-redis-sentinel-failover-tu-Ä‘ong" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cau-hinh-redis-sentinel-failover-tu-Ä‘ong"><span>ğŸ”¹ Cáº¥u hÃ¬nh Redis Sentinel (Failover tá»± Ä‘á»™ng)</span></a></h3><p>Sentinel giÃºp tá»± Ä‘á»™ng chuyá»ƒn Ä‘á»•i Master-Slave khi Master bá»‹ lá»—i.</p><ul><li><p>Cáº¥u hÃ¬nh Sentinel:</p><p>Táº¡o file sentinel.conf:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">sentinel monitor mymaster <span class="token number">192.168</span>.1.100 <span class="token number">6379</span> <span class="token number">2</span></span>
<span class="line">sentinel down-after-milliseconds mymaster <span class="token number">5000</span></span>
<span class="line">sentinel failover-timeout mymaster <span class="token number">60000</span></span>
<span class="line">sentinel parallel-syncs mymaster <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Cháº¡y Sentinel:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">redis-sentinel sentinel.conf</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Khi Master bá»‹ lá»—i, Sentinel sáº½ tá»± Ä‘á»™ng chuyá»ƒn má»™t Slave thÃ nh Master.</p></li></ul><p><a name="6"></a></p><h2 id="ğŸ“Œ-6-redis-cluster-phan-tan-du-lieu" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-6-redis-cluster-phan-tan-du-lieu"><span>ğŸ“Œ 6. Redis Cluster (PhÃ¢n tÃ¡n dá»¯ liá»‡u)</span></a></h2><p>Redis khÃ´ng chá»‰ há»— trá»£ Persistence (LÆ°u trá»¯ dá»¯ liá»‡u lÃ¢u dÃ i) vÃ  Replication (NhÃ¢n báº£n dá»¯ liá»‡u) mÃ  cÃ²n cÃ³ Cluster (PhÃ¢n tÃ¡n dá»¯ liá»‡u) Ä‘á»ƒ Ä‘áº£m báº£o hiá»‡u suáº¥t cao vÃ  má»Ÿ rá»™ng quy mÃ´.</p><p>Redis Cluster giÃºp chia dá»¯ liá»‡u thÃ nh nhiá»u node, giÃºp:</p><ul><li>Chia táº£i Ä‘á»ƒ tÄƒng hiá»‡u suáº¥t.</li><li>TrÃ¡nh single point of failure (SPoF).</li><li>Há»— trá»£ má»Ÿ rá»™ng dá»… dÃ ng.</li></ul><h3 id="ğŸ”¹-cach-redis-cluster-hoat-Ä‘ong" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cach-redis-cluster-hoat-Ä‘ong"><span>ğŸ”¹ CÃ¡ch Redis Cluster hoáº¡t Ä‘á»™ng</span></a></h3><p>Redis sá»­ dá»¥ng &quot;slots&quot; thay vÃ¬ key-value Ä‘Æ¡n thuáº§n</p><ul><li><p><strong>Sharding (Chia dá»¯ liá»‡u)</strong>:</p><ul><li>Redis chia dá»¯ liá»‡u thÃ nh 16384 hash slot (tÆ°Æ¡ng Ä‘Æ°Æ¡ng 16,384 pháº§n dá»¯ liá»‡u).</li><li>Má»—i key khi lÆ°u vÃ o Redis sáº½ Ä‘Æ°á»£c bÄƒm (hash) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÃ³ thuá»™c slot nÃ o.</li><li>Má»—i node trong cluster sáº½ chá»‹u trÃ¡ch nhiá»‡m lÆ°u má»™t táº­p há»£p cÃ¡c slots.</li><li>VÃ­ dá»¥ vá»›i 3 node: <ul><li>Node A lÆ°u dá»¯ liá»‡u tá»« slot 0 â€“ 5500.</li><li>Node B lÆ°u dá»¯ liá»‡u tá»« slot 5501 â€“ 11000.</li><li>Node C lÆ°u dá»¯ liá»‡u tá»« slot 11001 â€“ 16383.</li></ul></li></ul></li><li><p><strong>Multiple Masters</strong>: Redis Cluster cÃ³ nhiá»u master, má»—i master quáº£n lÃ½ má»™t pháº§n slot.</p></li><li><p><strong>Automatic Failover</strong>: Náº¿u má»™t master bá»‹ lá»—i, slave cá»§a nÃ³ sáº½ tá»± Ä‘á»™ng Ä‘Æ°á»£c nÃ¢ng lÃªn lÃ m master.</p></li></ul><p>VÃ­ dá»¥ Redis Cluster 6 node:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">[ Master 1 ] &lt;--&gt; [ Master 2 ] &lt;--&gt; [ Master 3 ]</span>
<span class="line">    |                 |                 |</span>
<span class="line">[ Slave 1 ]       [ Slave 2 ]       [ Slave 3 ]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ğŸ‘‰ Master chá»©a dá»¯ liá»‡u chÃ­nh, Slave há»— trá»£ dá»± phÃ²ng.</p><p>ğŸ’¡ Náº¿u Master 2 bá»‹ lá»—i, Slave 2 tá»± Ä‘á»™ng thÄƒng cáº¥p thÃ nh Master má»›i</p><h3 id="ğŸ”¹-cau-hinh-redis-cluster" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-cau-hinh-redis-cluster"><span>ğŸ”¹ Cáº¥u hÃ¬nh Redis Cluster</span></a></h3><p>Äá»ƒ táº¡o Redis Cluster, cáº§n Ã­t nháº¥t 3 master + 3 slave (tá»•ng 6 node).</p><ul><li><p><strong>BÆ°á»›c 1</strong>: Cháº¡y nhiá»u Redis instance</p><p>Giáº£ sá»­ báº¡n cÃ³ 6 Redis node trÃªn 3 server:</p><table><thead><tr><th style="text-align:center;">Node</th><th style="text-align:center;">IP</th><th style="text-align:center;">Port</th></tr></thead><tbody><tr><td style="text-align:center;">redis-1</td><td style="text-align:center;">192.168.1.101</td><td style="text-align:center;">7001</td></tr><tr><td style="text-align:center;">redis-2</td><td style="text-align:center;">192.168.1.102</td><td style="text-align:center;">7002</td></tr><tr><td style="text-align:center;">redis-3</td><td style="text-align:center;">192.168.1.103</td><td style="text-align:center;">7003</td></tr><tr><td style="text-align:center;">redis-4</td><td style="text-align:center;">192.168.1.101</td><td style="text-align:center;">7004</td></tr><tr><td style="text-align:center;">redis-5</td><td style="text-align:center;">192.168.1.102</td><td style="text-align:center;">7005</td></tr><tr><td style="text-align:center;">redis-6</td><td style="text-align:center;">192.168.1.103</td><td style="text-align:center;">7006</td></tr></tbody></table><p>Cháº¡y Redis vá»›i cáº¥u hÃ¬nh sau (vÃ­ dá»¥ redis-1.conf):</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">port <span class="token number">7001</span></span>
<span class="line">cluster-enabled <span class="token function">yes</span>    <span class="token comment"># Báº­t cháº¿ Ä‘á»™ cluster</span></span>
<span class="line">cluster-config-file nodes-7001.conf    <span class="token comment"># LÆ°u thÃ´ng tin cluster</span></span>
<span class="line">cluster-node-timeout <span class="token number">5000</span>    <span class="token comment"># Timeout cho cluster (5 giÃ¢y)</span></span>
<span class="line">appendonly <span class="token function">yes</span>    <span class="token comment"># Báº­t persistence (AOF)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>TÆ°Æ¡ng tá»±, táº¡o file config cho cÃ¡c node cÃ²n láº¡i (redis-2.conf, redis-3.conf...).</p><p>Khá»Ÿi Ä‘á»™ng cÃ¡c Redis instance:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">redis-server redis-1.conf</span>
<span class="line">redis-server redis-2.conf</span>
<span class="line"><span class="token punctuation">..</span>.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>BÆ°á»›c 2</strong>: Táº¡o Cluster</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">redis-cli <span class="token parameter variable">--cluster</span> create <span class="token number">192.168</span>.1.101:7001 <span class="token number">192.168</span>.1.102:7002 <span class="token number">192.168</span>.1.103:7003 <span class="token number">192.168</span>.1.101:7004 <span class="token number">192.168</span>.1.102:7005 <span class="token number">192.168</span>.1.103:7006 --cluster-replicas <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>--cluster-replicas 1: Má»—i master sáº½ cÃ³ 1 slave.</p><p>Redis sáº½ tá»± Ä‘á»™ng phÃ¢n chia slot vÃ  cáº¥u hÃ¬nh master/slave.</p></li></ul><h3 id="ğŸ”¹-kiem-tra-cluster" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-kiem-tra-cluster"><span>ğŸ”¹ Kiá»ƒm tra Cluster</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># Xem tráº¡ng thÃ¡i cluster</span></span>
<span class="line">redis-cli <span class="token parameter variable">-c</span> <span class="token parameter variable">-p</span> <span class="token number">7001</span> cluster info</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Xem danh sÃ¡ch node</span></span>
<span class="line">redis-cli <span class="token parameter variable">-c</span> <span class="token parameter variable">-p</span> <span class="token number">7001</span> cluster nodes</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Thá»­ set/get key</span></span>
<span class="line">redis-cli <span class="token parameter variable">-c</span> <span class="token parameter variable">-p</span> <span class="token number">7001</span> <span class="token builtin class-name">set</span> mykey <span class="token string">&quot;Hello Redis Cluster&quot;</span></span>
<span class="line">redis-cli <span class="token parameter variable">-c</span> <span class="token parameter variable">-p</span> <span class="token number">7002</span> get mykey</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ”¹-auto-failover" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-auto-failover"><span>ğŸ”¹ Auto Failover</span></a></h3><p>Khi má»™t master bá»‹ lá»—i, Redis Cluster sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p má»™t slave thÃ nh master.</p><p>MÃ´ phá»ng lá»—i báº±ng cÃ¡ch dá»«ng redis-1:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># Dá»«ng redis-1</span></span>
<span class="line">redis-cli <span class="token parameter variable">-c</span> <span class="token parameter variable">-p</span> <span class="token number">7001</span> <span class="token function">shutdown</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Sau Ä‘Ã³, kiá»ƒm tra cluster</span></span>
<span class="line">redis-cli <span class="token parameter variable">-c</span> <span class="token parameter variable">-p</span> <span class="token number">7002</span> cluster nodes</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Báº¡n sáº½ tháº¥y má»™t slave Ä‘Ã£ trá»Ÿ thÃ nh master.</p><h3 id="ğŸ”¹-so-sanh-replication-vs-cluster" tabindex="-1"><a class="header-anchor" href="#ğŸ”¹-so-sanh-replication-vs-cluster"><span>ğŸ”¹ So sÃ¡nh Replication vs Cluster</span></a></h3><table><thead><tr><th style="text-align:center;">TÃ­nh nÄƒng</th><th style="text-align:center;">Replication</th><th style="text-align:center;">Cluster</th></tr></thead><tbody><tr><td style="text-align:center;">Sá»‘ node</td><td style="text-align:center;">1 master + nhiá»u slave</td><td style="text-align:center;">Nhiá»u master + nhiá»u slave</td></tr><tr><td style="text-align:center;">TÄƒng tá»‘c Ä‘á»™ Ä‘á»c</td><td style="text-align:center;">âœ”ï¸ CÃ³</td><td style="text-align:center;">âœ”ï¸ CÃ³</td></tr><tr><td style="text-align:center;">TÄƒng tá»‘c Ä‘á»™ ghi</td><td style="text-align:center;">âŒ KhÃ´ng</td><td style="text-align:center;">âœ”ï¸ CÃ³</td></tr><tr><td style="text-align:center;">Tá»± Ä‘á»™ng failover</td><td style="text-align:center;">âœ”ï¸ CÃ³</td><td style="text-align:center;">âœ”ï¸ CÃ³</td></tr><tr><td style="text-align:center;">Chia nhá» dá»¯ liá»‡u</td><td style="text-align:center;">âŒ KhÃ´ng</td><td style="text-align:center;">âœ”ï¸ CÃ³ (Sharding)</td></tr><tr><td style="text-align:center;">Má»Ÿ rá»™ng ngang (Scale-out)</td><td style="text-align:center;">âŒ KhÃ´ng</td><td style="text-align:center;">âœ”ï¸ CÃ³</td></tr></tbody></table></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/vuepress-blog/assets/app-CXi1WLMJ.js" defer></script>
  </body>
</html>
