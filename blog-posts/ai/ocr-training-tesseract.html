<!doctype html>
<html lang="vi-VN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/vuepress-blog/favicon.ico"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Josefin+Sans:300,400,500,600,700&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"><title>Huấn luyện Tesseract (training AI OCR) | Kiến Thức Từ Trải Nghiệm</title><meta name="description" content="Một blog được tạo bằng VuePress">
    <link rel="preload" href="/vuepress-blog/assets/style-VnzZgpKD.css" as="style"><link rel="stylesheet" href="/vuepress-blog/assets/style-VnzZgpKD.css">
    <link rel="modulepreload" href="/vuepress-blog/assets/app-Bnxn8RC5.js"><link rel="modulepreload" href="/vuepress-blog/assets/ocr-training-tesseract.html-BRxXD0jA.js">
    <link rel="prefetch" href="/vuepress-blog/assets/index.html-CjBLykZj.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-B1HSbkc8.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-CrldPB5Y.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-6m6xH6kn.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-DYO5givE.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/fastapi-base-project.html-kOP20uaN.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-accuracy-perfomance.html-Bzonh6lL.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-cache-tesseract.html-BHM77pci.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-gioi-thieu-tesseract.html-CE_l-sIV.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-tong-quan.html-8pbegGJ5.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-advanced.html-DcDNXYEZ.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-beginner.html-PEbxemP5.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-expert.html-BUVowsA5.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-intermediate.html-MVp0SCg9.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/redis-advanced.html-DMU3bw2y.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/redis-basic.html-BneMpQoW.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-cloud-computing.html-BUDrTXPO.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-database.html-JKkAu8rC.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-ec2.html-BGZK7uyC.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-gioi-thieu-aws.html-21cyLjvB.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-iam.html-Fpo4BUP5.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-storage.html-p0g6-rbe.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-beginner.html-Bwjb74Ji.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-intermediate.html-ro2657rw.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-shell-script.html-BqMjK8va.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-training-saa-series.html-DsUUnMjB.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-tesseract-series.html-D9u0JZJc.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/plsql-training-series.html-ByEhb2pK.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-DJLWoYfI.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-Cu7zFGi6.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-CidSwDW8.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/404.html-CiGycLNO.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/setupDevtools-7MC2TMWH-B2zD4x96.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container no-sidebar external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/vuepress-blog/"><img class="vp-site-logo" src="/vuepress-blog/images/logo.png" alt="Kiến Thức Từ Trải Nghiệm"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Kiến Thức Từ Trải Nghiệm</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/" aria-label="Trang Chủ"><!---->Trang Chủ<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/project/" aria-label="Dự Án"><!---->Dự Án<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/blog/" aria-label="Blog"><!---->Blog<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/about/" aria-label="Về Tôi"><!---->Về Tôi<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Ngôn Ngữ</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Ngôn Ngữ</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/vuepress-blog/blog-posts/ai/ocr-training-tesseract.html" aria-label="Tiếng Việt"><!---->Tiếng Việt<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vuepress-blog/en/" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/" aria-label="Trang Chủ"><!---->Trang Chủ<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/project/" aria-label="Dự Án"><!---->Dự Án<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/blog/" aria-label="Blog"><!---->Blog<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/about/" aria-label="Về Tôi"><!---->Về Tôi<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Ngôn Ngữ</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Ngôn Ngữ</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/vuepress-blog/blog-posts/ai/ocr-training-tesseract.html" aria-label="Tiếng Việt"><!---->Tiếng Việt<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vuepress-blog/en/" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content" vp-content><!--[--><!--]--><div><h1 id="huan-luyen-tesseract-training-ai-ocr" tabindex="-1"><a class="header-anchor" href="#huan-luyen-tesseract-training-ai-ocr"><span>Huấn luyện Tesseract (training AI OCR)</span></a></h1><ul><li><p>Mặc dù Tesseract OCR đã được huấn luyện sẵn với nhiều ngôn ngữ và chữ số, nhưng trong thực tế (ví dụ: màn hình máy đo, thiết bị công nghiệp, bảng hiển thị số, font chữ đặc thù, dữ liệu mờ/nhỏ) thì kết quả nhận dạng thường chưa chính xác.</p></li><li><p>Lúc này, training Tesseract trên dữ liệu thực tế sẽ giúp:</p><ul><li><p>✔️ Tăng độ chính xác khi nhận dạng ký tự đặc thù.</p></li><li><p>✔️ Giảm lỗi nhầm lẫn giữa các ký tự dễ bị OCR đọc sai (ví dụ: 0 ↔ O, 1 ↔ I, 5 ↔ S, 2 ↔ 7, 3 ↔ 8, A ↔ 4, v.v.).</p></li><li><p>✔️ Tùy biến linh hoạt: chỉ cần train trên bộ ký tự nhỏ (digit-only, ký tự đặc biệt), không bắt buộc phải huấn luyện toàn bộ bộ chữ.</p></li></ul></li></ul><p><a href="#1">1. Giới thiệu</a></p><p><a href="#2">2. Các phương pháp training</a></p><p><a href="#3">3. Fine-tuning Tesseract</a></p><p><a href="#4">4. Bản chất của việc training trong Tesseract</a></p><p><a name="1"></a></p><h2 id="📌-1-gioi-thieu" tabindex="-1"><a class="header-anchor" href="#📌-1-gioi-thieu"><span>📌 1. Giới thiệu</span></a></h2><ul><li><p>Như đã biết, Tesseract v4+ (đã tích hợp LSTM – một dạng AI OCR). Và cũng chính từ phiên bản 4 trở đi, Tesseract hỗ trợ training/fine-tuning LSTM model.</p></li><li><p>Ưu điểm thì đã nhắc đến ngay đầu bài viết, còn về nhược điểm:</p><ul><li><p>❌ Cần thời gian, kiến thức để chuẩn bị và huấn luyện.</p></li><li><p>❌ Model càng lớn có thể ảnh hưởng performance.</p></li></ul></li></ul><p><a name="2"></a></p><h2 id="📌-2-cac-phuong-phap-training" tabindex="-1"><a class="header-anchor" href="#📌-2-cac-phuong-phap-training"><span>📌 2. Các phương pháp training</span></a></h2><ul><li>Có hai phương pháp chính để huấn luyện Tesseract nhằm cải thiện độ chính xác OCR:</li></ul><h3 id="_1️⃣-fine-tuning-huan-luyen-bo-sung" tabindex="-1"><a class="header-anchor" href="#_1️⃣-fine-tuning-huan-luyen-bo-sung"><span>1️⃣ Fine-tuning (Huấn luyện bổ sung)</span></a></h3><ul><li><p>Dựa trên model ngôn ngữ có sẵn của Tesseract (vd: eng.traineddata) và huấn luyện thêm bằng dữ liệu thực tế.</p></li><li><p>✅ Ưu điểm:</p><ul><li><p>✧ Nhanh chóng, không cần nhiều dữ liệu.</p></li><li><p>✧ Phù hợp khi chỉ muốn cải thiện một nhóm ký tự (ví dụ: chữ số, ký hiệu đặc biệt).</p></li><li><p>✧ Ít tốn tài nguyên.</p></li></ul></li><li><p>❌ Nhược điểm:</p><ul><li><p>✧ Nếu dữ liệu khác biệt quá nhiều so với model gốc, độ chính xác vẫn hạn chế.</p></li><li><p>✧ Bộ mặc định của Tesseract chứa cả chữ cái, số, ký hiệu. Nếu bạn chỉ muốn model chuyên biệt (ví dụ đọc các số 0-9) thì base trên model có sẵn sẽ gây nặng, có thể ảnh hưởng đến tốc độ.</p></li></ul></li></ul><h3 id="_2️⃣-full-training-training-tu-đau" tabindex="-1"><a class="header-anchor" href="#_2️⃣-full-training-training-tu-đau"><span>2️⃣ Full training (Training từ đầu)</span></a></h3><ul><li><p>Xây dựng model OCR mới hoàn toàn từ dữ liệu thu thập được.</p></li><li><p>✅ Ưu điểm:</p><ul><li><p>✧ Kiểm soát toàn diện bộ ký tự, font chữ, ngôn ngữ.</p></li><li><p>✧ Model tập trung học nhận dạng, giảm nhiễu, tăng độ chính xác và cải thiện tốc độ hơn.</p></li></ul></li><li><p>❌ Nhược điểm:</p><ul><li><p>✧ Yêu cầu rất nhiều dữ liệu và công sức.</p></li><li><p>✧ Thời gian huấn luyện lâu, đòi hỏi tài nguyên tính toán mạnh.</p></li></ul></li><li><p>🚀 Trong bài viết này chúng ta sẽ chỉ tập trung phương pháp Fine-tuning.</p></li></ul><p><a name="3"></a></p><h2 id="📌-3-fine-tuning-tesseract" tabindex="-1"><a class="header-anchor" href="#📌-3-fine-tuning-tesseract"><span>📌 3. Fine-tuning Tesseract</span></a></h2><ul><li><p>Model LSTM chuẩn (đã training sẵn của Tesseract 4.x, 5.x) đã được train trên nhiều ngôn ngữ và bộ dữ liệu đa dạng:</p><ul><li><p>✔️ Tốc độ xử lý khá nhanh, tối ưu tốt trên phần lớn máy tính hiện đại.</p></li><li><p>✔️ Độ chính xác khá cao, phù hợp với nhiều trường hợp.</p></li><li><p>👉 Thường không cần training lại hoặc chỉ nên training nhẹ (fine-tune trên bộ dữ liệu thực tế).</p></li></ul></li><li><p>🔥 Để cho trực quan hơn khi đi vào các bước Fine-tuning, mọi người có thể kết hợp xem qua video hướng dẫn của các pháp sư Ấn Độ <a href="https://www.youtube.com/watch?v=SvhoBT-PnME" target="_blank" rel="noopener noreferrer">tại đây</a>.</p></li></ul><h3 id="_1️⃣-yeu-cau-ban-đau" tabindex="-1"><a class="header-anchor" href="#_1️⃣-yeu-cau-ban-đau"><span>1️⃣ Yêu cầu ban đầu</span></a></h3><ul><li><p>➀ Tesseract v4.x, 5x (có sẵn LSTM OCR).</p></li><li><p>➁ Python khuyên dùng 3.8 hoặc 3.9 hay 3.10, tránh bản mới nhất vì có thể Tessract chưa ổn định trên bản mới.</p></li><li><p>➂ Máy chủ training: Nếu dùng với tài nguyên giới hạn (RAM hoặc CPU), thời gian có thể chậm hơn đáng kể, thậm chí dễ bị out-of-memory:</p><ul><li><p>✧ Ubuntu/Linux (khuyên dùng WSL nếu Windows).</p></li><li><p>✧ RAM: tối thiểu 8GB</p></li><li><p>✧ Dung lượng: ~5GB trống</p></li></ul></li></ul><h3 id="_2️⃣-thiet-lap-moi-truong" tabindex="-1"><a class="header-anchor" href="#_2️⃣-thiet-lap-moi-truong"><span>2️⃣ Thiết lập môi trường</span></a></h3><ul><li><p>Môi trường build và compile của Tesseract cực kỳ thân thiện với Linux.</p></li><li><p>Trường hợp vẫn muốn training Tesseract trên Windows → khuyên dùng WSL (Windows Subsystem for Linux) để tránh gặp các lỗi kỳ quặc do không tương thích trên Windows.</p></li></ul><h4 id="❶-kiem-tra-may-đa-cai-wsl-chua" tabindex="-1"><a class="header-anchor" href="#❶-kiem-tra-may-đa-cai-wsl-chua"><span>❶ Kiểm tra máy đã cài WSL chưa</span></a></h4><ul><li><p>Mở Command Prompt hoặc PowerShell, gõ:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">wsl <span class="token parameter variable">--list</span> <span class="token parameter variable">--verbose</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Nếu thấy như dưới tức là bạn đã cài WSL và có Ubuntu sẵn.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">NAME      STATE           VERSION</span>
<span class="line">Ubuntu    Running         <span class="token number">2</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Nếu hiện lỗi kiểu như dưới, hoặc không thấy Ubuntu trong danh sách → bạn chưa cài WSL → xem bước 2.:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token string">&#39;wsl&#39;</span> is not recognized as an internal or external <span class="token builtin class-name">command</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="❷-cai-đat-wsl-ubuntu-neu-chua-co" tabindex="-1"><a class="header-anchor" href="#❷-cai-đat-wsl-ubuntu-neu-chua-co"><span>❷ Cài đặt WSL + Ubuntu (nếu chưa có)</span></a></h4><ul><li><p>Mở PowerShell (Admin) rồi chạy:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">wsl <span class="token parameter variable">--install</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>👉 Sau khi xong, bạn cần restart máy.</p></li></ul><h4 id="❸-mo-ubuntu-wsl-va-kiem-tra" tabindex="-1"><a class="header-anchor" href="#❸-mo-ubuntu-wsl-va-kiem-tra"><span>❸ Mở Ubuntu (WSL) và kiểm tra</span></a></h4><ul><li><p>✦ Sau khi cài xong, tìm &quot;Ubuntu&quot; trong Start Menu → mở lên.</p></li><li><p>✦ Nhập username + password lần đầu.</p></li><li><p>✦ Sau đó thử để chắc chắn WSL hoạt động:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">ls</span> ~</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="➃-tesseract" tabindex="-1"><a class="header-anchor" href="#➃-tesseract"><span>➃ Tesseract</span></a></h4><ul><li><p>Đương nhiên training Tesseract thì cần cài Tesseract trên Ubuntu (WSL).</p></li><li><p>Nếu bạn dùng Ubuntu 22.04 và cần training → bạn nên build Tesseract từ source phiên bản đầy đủ vì phiên bản mặc định thường không đi kèm các tool training (combine_tessdata, lstmtraining, text2image,...):</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> tesseract-ocr</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> tesseract-ocr-all</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libtesseract-dev</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libleptonica-dev</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_3️⃣-tao-project-training" tabindex="-1"><a class="header-anchor" href="#_3️⃣-tao-project-training"><span>3️⃣ Tạo project training</span></a></h3><ul><li><p>Tạo một thư mục project riêng để:</p><ul><li><p>Chuẩn bị dữ liệu.</p></li><li><p>Fine-tune mô hình sẵn có.</p></li><li><p>Lưu các file .traineddata đầu ra sau khi training.</p></li></ul></li></ul><h4 id="❶-cai-đat-cac-goi-phu-thuoc-cho-tesstrain" tabindex="-1"><a class="header-anchor" href="#❶-cai-đat-cac-goi-phu-thuoc-cho-tesstrain"><span>❶ Cài đặt các gói phụ thuộc cho tesstrain</span></a></h4><ul><li><p>Mở Ubuntu:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> build-essential <span class="token function">git</span> <span class="token function">make</span> pkg-config <span class="token punctuation">\</span></span>
<span class="line">    libpng-dev libjpeg8-dev libtiff5-dev zlib1g-dev <span class="token punctuation">\</span></span>
<span class="line">    libicu-dev libpango1.0-dev libcairo2-dev <span class="token punctuation">\</span></span>
<span class="line">    python3 python3-venv python3-pip libleptonica-dev <span class="token punctuation">\</span></span>
<span class="line">    tesseract-ocr</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Ngoài ra, để chạy lệnh huấn luyện, cần cài thêm <code>make</code> - công cụ chuẩn để chạy các tác vụ tự động hóa:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">make</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="❷-clone-repo-tesstrain-–-cong-cu-chuan-đe-training-tesseract" tabindex="-1"><a class="header-anchor" href="#❷-clone-repo-tesstrain-–-cong-cu-chuan-đe-training-tesseract"><span>❷ Clone repo tesstrain – công cụ chuẩn để training Tesseract</span></a></h4><ul><li><p>Cài git:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">git</span> <span class="token parameter variable">-y</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Thực hiện clone:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">git</span> clone https://github.com/tesseract-ocr/tesstrain.git</span>
<span class="line"><span class="token builtin class-name">cd</span> tesstrain</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>🎯 Tại sao cần tesstrain?</p><ul><li><p>✔️ Repo tesstrain này là nơi chứa:</p><ul><li>✧ Các script và Makefile để xử lý tập dữ liệu.</li><li>✧ Các ví dụ mẫu về cách train/fine-tune.</li><li>✧ Logic gọi combine_tessdata, lstmtraining, text2image, v.v.</li></ul></li><li><p>✔️ Việc training Tesseract thủ công rất phức tạp. tesstrain giúp:</p><ul><li>✧ Quản lý dữ liệu (ảnh + groundtruth .gt.txt).</li><li>✧ Tự động gọi đúng lệnh lstmtraining.</li><li>✧ Tự động sinh .traineddata với model kế thừa (--continue_from).</li></ul></li></ul></li></ul><h4 id="❸-tao-moi-truong-ao" tabindex="-1"><a class="header-anchor" href="#❸-tao-moi-truong-ao"><span>❸ Tạo môi trường ảo</span></a></h4><ul><li><p>Cài thêm gói venv cho Python (ví dụ cho Python v3.10):</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> update</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python3.10-venv</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Tạo môi trường ảo Python và kích hoạt:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">python3.10 <span class="token parameter variable">-m</span> venv venv</span>
<span class="line"><span class="token builtin class-name">source</span> venv/bin/activate</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="❹-cai-đat-cac-dependencies-can-thiet-cho-tesstrain" tabindex="-1"><a class="header-anchor" href="#❹-cai-đat-cac-dependencies-can-thiet-cho-tesstrain"><span>❹ Cài đặt các dependencies cần thiết cho tesstrain</span></a></h4><ul><li><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h3 id="_4️⃣-chuan-bi-du-lieu-training" tabindex="-1"><a class="header-anchor" href="#_4️⃣-chuan-bi-du-lieu-training"><span>4️⃣ Chuẩn bị dữ liệu training</span></a></h3><ul><li><p>✦ Tesseract training cần:</p><ul><li>✧ Ảnh (thường là ảnh đen trắng hoặc ảnh màu TIFF hoặc PNG).</li><li>✧ File <code>.gt.txt</code>: chứa nội dung chính xác của ảnh tương ứng (ground truth text).</li><li>✧ File <code>.box</code> (tùy chọn): định nghĩa vị trí bounding box và ký tự trên ảnh.</li></ul></li><li><p>✦ Thông thường bạn sẽ dùng cặp: ảnh + .gt.txt hoặc ảnh + .box.</p></li></ul><h4 id="❶-chuan-bi-anh" tabindex="-1"><a class="header-anchor" href="#❶-chuan-bi-anh"><span>❶ Chuẩn bị ảnh</span></a></h4><ul><li><p>✦ Ảnh nên được crop đúng vùng chứa chữ cần training. Tốt hơn là thêm cả padding (viền trắng) cho vùng ảnh.</p></li><li><p>✦ Ảnh nên có định dạng TIFF hoặc PNG, nhưng <code>.tif</code> được Tesseract ưu thích hơn cả khi training.</p><ul><li>Ví dụ:<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">001.tif</span>
<span class="line">002.tif</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>💡 Mình thường thêm logic lưu ảnh sau khi tiền xử lý và comment out. Lúc nào cần ảnh training thì bỏ comment out và chạy lại để lấy data training.</p></li></ul><h4 id="❷-tao-file-ground-truth-text-gt-txt" tabindex="-1"><a class="header-anchor" href="#❷-tao-file-ground-truth-text-gt-txt"><span>❷ Tạo file ground truth text (.gt.txt)</span></a></h4><ul><li><p>✦ Đây là file text thuần chứa nội dung ký tự chính xác tương ứng ảnh.</p></li><li><p>✦ Tên file giống tên ảnh, ví dụ: 123.gt.txt → chứa text của 123.tif</p><ul><li>Ví dụ nội dung file 123.gt.txt:<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">123</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li></ul><h3 id="_5️⃣-setup-cau-truc-moi-truong-training" tabindex="-1"><a class="header-anchor" href="#_5️⃣-setup-cau-truc-moi-truong-training"><span>5️⃣ Setup cấu trúc môi trường training</span></a></h3><h4 id="❶-mo-thu-muc-lam-viec-trong-wsl-tu-windows-explorer" tabindex="-1"><a class="header-anchor" href="#❶-mo-thu-muc-lam-viec-trong-wsl-tu-windows-explorer"><span>❶ Mở thư mục làm việc trong WSL từ Windows Explorer</span></a></h4><ul><li><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token punctuation">\</span><span class="token punctuation">\</span>wsl$<span class="token punctuation">\</span>Ubuntu-22.04<span class="token punctuation">\</span>home<span class="token punctuation">\</span>hosyduc<span class="token punctuation">\</span>train_data</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>✅ Mục đích: Dễ thao tác file từ Windows dù đang làm việc trên Ubuntu (WSL).</p></li></ul><h4 id="❷-mo-folder-project-tesstrain-vua-clone" tabindex="-1"><a class="header-anchor" href="#❷-mo-folder-project-tesstrain-vua-clone"><span>❷ Mở folder project <code>tesstrain</code> vừa clone</span></a></h4><ul><li><p>✦ Giải nén thư mục <code>ocrd-testset</code> (dữ liệu đã có sẵn tesseract dùng để training)</p></li><li><p>✦ Đây là dataset mẫu chứa các ví dụ ảnh <code>.tif/.png</code> và text <code>.gt.txt</code> đã dùng để training.</p></li></ul><h4 id="❸-tao-thu-muc-data-trong-project-va-di-chuyen-thu-muc-ocrd-testset-vua-giai-nen-vao" tabindex="-1"><a class="header-anchor" href="#❸-tao-thu-muc-data-trong-project-va-di-chuyen-thu-muc-ocrd-testset-vua-giai-nen-vao"><span>❸ Tạo thư mục <code>data</code> trong project và di chuyển thư mục <code>ocrd-testset</code> vừa giải nén vào</span></a></h4><h4 id="❹-đoi-ten-thu-muc-data-ocrd-testset" tabindex="-1"><a class="header-anchor" href="#❹-đoi-ten-thu-muc-data-ocrd-testset"><span>❹ Đổi tên thư mục <code>/data/ocrd-testset</code></span></a></h4><ul><li><p>✦ Có thể đổi thành tên bất kỳ làm model training cho bạn nhưng cần kết thúc bằng ground-truth để tesstrain nhận diện.</p><ul><li>Ví dụ: <code>hsd-ground-truth</code></li></ul></li><li><p>✦ Các ảnh <code>.tif</code> và text <code>.gt.txt</code> đã chuẩn bị trước đó cũng sẽ đưa vào trong thư mục này để mô hình mới sẽ kế thừa và được fine-tune thêm bằng ảnh bạn cung cấp.</p></li></ul><h4 id="❺-tai-mo-hinh-goc-đe-fine-tune-start-model" tabindex="-1"><a class="header-anchor" href="#❺-tai-mo-hinh-goc-đe-fine-tune-start-model"><span>❺ Tải mô hình gốc để fine-tune (START_MODEL)</span></a></h4><ul><li><p>✦ Để fine-tune, bạn cần một mô hình nền đã học cơ bản, gọi là START_MODEL như <code>eng.traineddata</code>, <code>deu.traineddata</code>, <code>deu_latf.traineddata</code>, v.v.</p></li><li><p>✦ Download file START_MODEL (ví dụ <code>deu_latf.traineddata</code>) tại:</p><ul><li>🔗 https://github.com/tesseract-ocr/tessdata_best/blob/main/deu_latf.traineddata</li></ul></li></ul><h4 id="❻-tao-thu-muc-tessdata-cung-cap-voi-thu-muc-project-tesstrain" tabindex="-1"><a class="header-anchor" href="#❻-tao-thu-muc-tessdata-cung-cap-voi-thu-muc-project-tesstrain"><span>❻ Tạo thư mục <code>tessdata</code> cùng cấp với thư mục project <code>tesstrain</code></span></a></h4><ul><li><p>Copy file START_MODEL <code>deu_latf.traineddata</code> vừa tải tại bước ⑤ vào thư mục <code>tessdata</code>.</p></li><li><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">tesstrain/</span>
<span class="line">├── data/</span>
<span class="line">│   └── hsd-ground-truth/</span>
<span class="line">│       ├── sample1.tif</span>
<span class="line">│       ├── sample1.gt.txt</span>
<span class="line">│       ├── <span class="token punctuation">..</span>.</span>
<span class="line">tesstrain/</span>
<span class="line">├── deu_latf.traineddata</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_6️⃣-tien-hanh-huan-luyen-mo-hinh" tabindex="-1"><a class="header-anchor" href="#_6️⃣-tien-hanh-huan-luyen-mo-hinh"><span>6️⃣ Tiến hành huấn luyện mô hình</span></a></h3><h4 id="❶-mo-lai-ubuntu-tai-moi-truong-ao-đa-kich-hoat" tabindex="-1"><a class="header-anchor" href="#❶-mo-lai-ubuntu-tai-moi-truong-ao-đa-kich-hoat"><span>❶ Mở lại Ubuntu (tại môi trường ảo đã kích hoạt)</span></a></h4><ul><li><p>✦ Chạy lệnh training ví dụ sau:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">make</span> training <span class="token assign-left variable">MODEL_NAME</span><span class="token operator">=</span>hsd <span class="token assign-left variable">START_MODEL</span><span class="token operator">=</span>deu_latf <span class="token assign-left variable">TESSDATA</span><span class="token operator">=</span><span class="token punctuation">..</span>/tessdata <span class="token assign-left variable">MAX_ITERATIONS</span><span class="token operator">=</span><span class="token number">500</span> <span class="token assign-left variable">LEARNING_RATE</span><span class="token operator">=</span><span class="token number">0.001</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>✦ Ý nghĩa các tham số:</p><table><thead><tr><th style="text-align:center;">Tham số</th><th style="text-align:center;">Ý nghĩa</th></tr></thead><tbody><tr><td style="text-align:center;">MODEL_NAME</td><td style="text-align:center;">Tên mô hình mới (hsd.traineddata)</td></tr><tr><td style="text-align:center;">START_MODEL</td><td style="text-align:center;">Mô hình gốc để fine-tune (deu_latf.traineddata)</td></tr><tr><td style="text-align:center;">TESSDATA</td><td style="text-align:center;">Đường dẫn đến thư mục chứa mô hình gốc</td></tr><tr><td style="text-align:center;">MAX_ITERATIONS</td><td style="text-align:center;">Số vòng lặp huấn luyện (quá cao có thể overfit)</td></tr><tr><td style="text-align:center;">LEARNING_RATE</td><td style="text-align:center;">Tốc độ học – nhỏ thì học kỹ, lớn thì học nhanh (nhưng dễ sai)</td></tr></tbody></table><ul><li>⚠️ Tham khảo thêm ý nghĩa các tham số trong file README.md tại thư mục dự án <a href="https://github.com/tesseract-ocr/tesstrain" target="_blank" rel="noopener noreferrer">tesstrain</a>.</li></ul></li></ul><h4 id="❷-đoi-lenh-training-chay-xong-se-tao-ra-file-traineddata-tai-tesstrain-data-vi-du-hsd-traineddata" tabindex="-1"><a class="header-anchor" href="#❷-đoi-lenh-training-chay-xong-se-tao-ra-file-traineddata-tai-tesstrain-data-vi-du-hsd-traineddata"><span>❷ Đợi lệnh training chạy xong, sẽ tạo ra file <code>.traineddata</code> tại <code>\tesstrain\data\</code> (ví dụ: <code>hsd.traineddata</code>)</span></a></h4><ul><li><p>✦ Quá trình training Tesseract có thể kéo dài khá lâu, tùy vào các yếu tố sau:</p><ul><li>➀ Số lượng ảnh bạn dùng để huấn luyện.</li><li>➁ Cấu hình hệ thống của bạn.</li><li>➂ Giá trị các tham số thiết định như: MAX_ITERATIONS.</li></ul></li><li><p>✦ Khi training có thể bạn sẽ thấy các dòng log như:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token number">2</span> Percent improvement time-162, best error was <span class="token number">11.087</span> @ <span class="token number">1211</span></span>
<span class="line">At iteration <span class="token number">1373</span>/1800/1800, Mean <span class="token assign-left variable">rms</span><span class="token operator">=</span><span class="token number">0.744</span>%, <span class="token assign-left variable">delta</span><span class="token operator">=</span><span class="token number">1.13</span>%, char <span class="token assign-left variable">train</span><span class="token operator">=</span><span class="token number">8.625</span>%, word <span class="token assign-left variable">train</span><span class="token operator">=</span><span class="token number">13.878</span>%, skip <span class="token assign-left variable">ratio</span><span class="token operator">=</span><span class="token number">0</span>%, New best char error <span class="token operator">=</span> <span class="token number">8.625</span> wrote best model:data/svc/checkpoints/hsd8.625_1373.checkpoint wrote checkpoint.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Giải thích: <table><thead><tr><th style="text-align:center;">Thành phần</th><th style="text-align:center;">Ý nghĩa</th></tr></thead><tbody><tr><td style="text-align:center;">iteration 7124/8200/8200</td><td style="text-align:center;">Đang ở vòng lặp thứ 7124, tổng số là 8200</td></tr><tr><td style="text-align:center;">Mean rms=0.6.508%</td><td style="text-align:center;">Mức lỗi trung bình theo kiểu root-mean-square (giá trị càng thấp càng tốt, thường &lt; 1% mới là tốt)</td></tr><tr><td style="text-align:center;">delta=6.154%</td><td style="text-align:center;">Mức thay đổi gần đây nhất trong lỗi, phản ánh mức cải thiện so với checkpoint trước</td></tr><tr><td style="text-align:center;">char train=228.95%</td><td style="text-align:center;">Mức huấn luyện ký tự, &gt; 100% nghĩa là đang bị &quot;overfitting&quot; hoặc dữ liệu chưa ổn định</td></tr><tr><td style="text-align:center;">word train=99.2%</td><td style="text-align:center;">Mức huấn luyện từ, thường ~ 100% là tốt</td></tr><tr><td style="text-align:center;">skip ratio=0%</td><td style="text-align:center;">Tỷ lệ ảnh bị bỏ qua vì lỗi. Nếu &gt; 0% thì có vấn đề với dữ liệu (lstmf lỗi, ảnh sai)</td></tr><tr><td style="text-align:center;">wrote checkpoint</td><td style="text-align:center;">Đã lưu checkpoint <code>.checkpoint</code> để resume nếu cần</td></tr></tbody></table></li></ul></li></ul><h3 id="_7️⃣-su-dung-mo-hinh-vua-huan-luyen-voi-tesseract" tabindex="-1"><a class="header-anchor" href="#_7️⃣-su-dung-mo-hinh-vua-huan-luyen-voi-tesseract"><span>7️⃣ Sử dụng mô hình vừa huấn luyện với Tesseract</span></a></h3><h4 id="❶-copy-file-traineddata-vua-train-vao-thu-muc-tessdata-cua-tesseract-ocr" tabindex="-1"><a class="header-anchor" href="#❶-copy-file-traineddata-vua-train-vao-thu-muc-tessdata-cua-tesseract-ocr"><span>❶ Copy file <code>.traineddata</code> vừa train vào thư mục <code>tessdata</code> của <code>Tesseract-OCR</code></span></a></h4><ul><li>Ví dụ:<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">C:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>Tesseract-OCR<span class="token punctuation">\</span>tessdata<span class="token punctuation">\</span>hsd.traineddata</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="❷-su-dung-voi-tesseract-cli-bang-python" tabindex="-1"><a class="header-anchor" href="#❷-su-dung-voi-tesseract-cli-bang-python"><span>❷ Sử dụng với Tesseract CLI bằng Python</span></a></h4><ul><li><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">cmd <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    TESSERACT_CMD<span class="token punctuation">,</span></span>
<span class="line">    tmp_path<span class="token punctuation">,</span></span>
<span class="line">    out_base<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;-l&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hsd&quot;</span><span class="token punctuation">,</span> <span class="token comment"># 👈 Dòng này thêm vào để sử dụng model huấn luyện mới (MODEL_NAME)</span></span>
<span class="line">    <span class="token string">&quot;--psm&quot;</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>psm<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> output_type <span class="token operator">==</span> <span class="token string">&quot;data&quot;</span><span class="token punctuation">:</span></span>
<span class="line">    cmd<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">&quot;tsv&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> whitelist<span class="token punctuation">:</span></span>
<span class="line">    cmd <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f&quot;tessedit_char_whitelist=</span><span class="token interpolation"><span class="token punctuation">{</span>whitelist<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> check<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>DEVNULL<span class="token punctuation">,</span> stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>DEVNULL<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="📝-luu-y" tabindex="-1"><a class="header-anchor" href="#📝-luu-y"><span>📝 Lưu ý:</span></a></h3><ul><li><p>❶ Trường hợp bạn muốn tiếp tục huấn luyện (fine-tune tiếp) do cần thêm dữ liệu training (ảnh):</p><ul><li>Chỉ cần thêm ảnh mới vào <code>ground-truth/</code> và chạy lại lệnh huấn luyện, nó sẽ tiếp tục từ checkpoint cũ.</li></ul></li><li><p>❷ Trường hợp bạn muốn Fine-tuning lại từ đầu (reset):</p><ul><li><p>✧ Xoá toàn bộ thư mục <code>data/&lt;MODEL_NAME&gt;</code>:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">rm</span> <span class="token parameter variable">-rf</span> data/hsd</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>✧ Xoá file <code>hsd.traineddata</code> nếu đã sinh ra trước đó:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">rm</span> <span class="token parameter variable">-f</span> svc.traineddata</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>✧ Sau đó chạy lại lệnh huấn luyện.</p></li><li><p>✧ Nếu không xoá sạch <code>data/svc/</code>, Tesseract sẽ cố tiếp tục từ checkpoint cũ (mà có thể không còn hợp lệ), dẫn đến lỗi.</p></li></ul></li></ul><h3 id="👀-box-file-box-va-lstm-training-file-lstmf" tabindex="-1"><a class="header-anchor" href="#👀-box-file-box-va-lstm-training-file-lstmf"><span>👀 Box file (<code>.box</code>) và LSTM training file (<code>.lstmf</code>):</span></a></h3><ul><li>Sau khi chạy lệnh huấn luyện, các file tự động sinh ra từ <code>image.tif</code> + <code>image.gt.txt</code> là file <code>.box</code> và <code>.lstm</code>.</li></ul><h4 id="❶-box-file-box-du-lieu-nhan-label-file-đi-kem-voi-anh-tif" tabindex="-1"><a class="header-anchor" href="#❶-box-file-box-du-lieu-nhan-label-file-đi-kem-voi-anh-tif"><span>❶ Box file (<code>.box</code>) - dữ liệu nhãn (label file) đi kèm với ảnh <code>.tif</code></span></a></h4><ul><li><p>✦ Mỗi dòng chứa ký tự, bounding box (tọa độ), và số trang.</p></li><li><p>✦ Cấu trúc:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">&lt;char&gt; &lt;x0&gt; &lt;y0&gt; &lt;x1&gt; &lt;y1&gt; &lt;page&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>Trong đó: <ul><li>✧ <code>char</code>: ký tự mà bounding box này đại diện (nhãn ground-truth). Ví dụ: A, 1, @, v.v.</li><li>✧ <code>x0</code> và <code>y0</code>: tọa độ góc dưới bên trái (bottom-left) của bounding box, tính theo pixel.</li><li>✧ <code>x1</code> và <code>y1</code>: tọa độ góc trên bên phải (top-right) của bounding box. <ul><li><code>x1</code> &gt; <code>x0</code> và <code>y1</code> &gt; <code>y0</code></li></ul></li><li>✧ <code>page</code>: số trang trong ảnh gốc (đa phần là 0, trừ khi file <code>.tif</code> có nhiều trang).</li></ul></li></ul></li><li><p>✦ Ví dụ:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">1  10 12 28 40 0</span>
<span class="line">2  35 12 53 40 0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Nghĩa là: ký tự 1 nằm trong khung (10,12) → (28,40) trên trang 0.</li></ul></li><li><p>✦ Ý nghĩa: chỉ ra ký tự nào nằm ở đâu trong ảnh, để Tesseract học cách map pixel → ký tự.</p></li></ul><h4 id="❷-lstm-training-file-lstmf" tabindex="-1"><a class="header-anchor" href="#❷-lstm-training-file-lstmf"><span>❷ LSTM training file (<code>.lstmf</code>)</span></a></h4><ul><li><p>✦ Đây mới là input trực tiếp cho vòng huấn luyện.</p></li><li><p>✦ Nội dung : binary format (không đọc tay được), chứa:</p><ul><li>➀ Features đã trích xuất từ ảnh (<code>image.tif</code>)</li><li>➁ Nhãn ground-truth (<code>image.gt.txt</code>).</li><li>➂ Map unicharset - tập hợp tất cả ký tự mà model biết và có thể OCR</li></ul></li></ul><h3 id="💡-kinh-nghiem" tabindex="-1"><a class="header-anchor" href="#💡-kinh-nghiem"><span>💡 Kinh nghiệm:</span></a></h3><ul><li><p>✔️ Trường hợp lỗi ngay từ khi vừa chạy lệnh huấn luyện, nguyên nhân có thể đến từ việc file <code>.gt.txt</code> chưa khớp với ảnh file <code>.tif</code>.</p></li><li><p>✔️ Sau khi chạy lệnh huấn luyện lần đầu, cần kiểm tra box file (<code>.box</code>). Có thể cần chỉnh tay box file nếu phát hiện sai lệch:</p><ul><li>➀ Kiểm tra nhãn (<code>char</code>) đã khớp chưa.</li><li>➁ Đo tọa độ pixel bằng <code>Paint</code> app và chỉnh lại x0 y0 x1 y1 sao cho ô bao trọn ký tự, không cắt, không quá rộng.</li></ul></li></ul><p><a name="4"></a></p><h2 id="📌-4-ban-chat-cua-viec-training-trong-tesseract" tabindex="-1"><a class="header-anchor" href="#📌-4-ban-chat-cua-viec-training-trong-tesseract"><span>📌 4. Bản chất của việc training trong Tesseract</span></a></h2><h3 id="_1️⃣-tesseract-dung-lstm-–-mot-loai-mang-hoc-sau" tabindex="-1"><a class="header-anchor" href="#_1️⃣-tesseract-dung-lstm-–-mot-loai-mang-hoc-sau"><span>1️⃣ Tesseract dùng LSTM – một loại mạng học sâu</span></a></h3><ul><li><p>✦ Khi training:</p><ul><li>✧ Bạn cung cấp ảnh đầu vào (dòng text thật sự chứa ký tự cần OCR).</li><li>✧ Bạn cung cấp ground truth text tương ứng (<code>.gt.txt</code>).</li></ul></li><li><p>✦ Tesseract sử dụng các data này để:</p><ul><li>✔️ So sánh ảnh và nội dung thật (label).</li><li>✔️ Dùng thuật toán học sâu tối ưu lại mô hình, sao cho đầu ra từ ảnh càng gần label càng tốt.</li><li>✔️ Cập nhật để “hiểu” tốt hơn mối quan hệ giữa hình dạng ảnh và ký tự.</li></ul></li><li><p>👉 Tesseract không &quot;ghi nhớ&quot; từng ảnh → mà học mô hình tổng quát (hình dạng số 1 nhìn như nào, sự thay đổi ra sao vẫn là số 1).</p><ul><li>Nôm na là mô hình học được &quot;bản chất&quot;, chứ không chỉ nhớ ảnh cụ thể.</li></ul></li></ul><h3 id="_2️⃣-can-bao-nhieu-anh-la-đu-traning" tabindex="-1"><a class="header-anchor" href="#_2️⃣-can-bao-nhieu-anh-la-đu-traning"><span>2️⃣ Cần bao nhiêu ảnh là đủ traning?</span></a></h3><ul><li><p>📄 Giả sử bạn đang không đọc được giá trị tại ảnh số 1 và ảnh số 11:</p><ul><li><p>✧ Có nghĩa nếu hình dạng số 1 trong ảnh số 1 và số 11 giống nhau, thì chỉ cần 1 ảnh để training là đủ.</p></li><li><p>✧ Ngược lại, nếu có sự khác biệt về hình dạng, nên cung cấp nhiều ảnh hơn về độ đa dạng của số đó để mô hình training mới học được bản chất của số đó.</p></li></ul></li><li><p>⚠️ Nếu bạn chỉ toàn training với &quot;11&quot; và chưa từng thấy &quot;1&quot; đứng một mình:</p><ul><li><p>Có khả năng mô hình không hiểu &quot;1&quot; đứng đơn lẻ là một ký tự hợp lệ (nhất là khi khoảng cách ảnh khác nhau).</p></li><li><p>👉 Nên có một số ảnh chứa &quot;1&quot; đứng một mình, hoặc &quot;10&quot;, &quot;21&quot;, &quot;1A&quot;,... để mô hình thấy &quot;1&quot; trong nhiều ngữ cảnh.</p></li></ul></li></ul><h3 id="_3️⃣-co-che-hoat-đong-tesseract" tabindex="-1"><a class="header-anchor" href="#_3️⃣-co-che-hoat-đong-tesseract"><span>3️⃣ Cơ chế hoạt động Tesseract</span></a></h3><ul><li><p>🧠 Tesseract mặc định dùng <code>eng.traineddata</code> để OCR ảnh với mô hình tiếng Anh chuẩn. Có thể xem tại: <code>Tesseract-OCR\tessdata\eng.traineddata</code></p></li><li><p>🚀 Khi chỉ định model mới, Tesseract sẽ bỏ qua <code>eng</code> và chỉ dùng model bạn đã training.</p></li></ul><h3 id="_4️⃣-start-model-mo-hinh-goc-đe-fine-tune" tabindex="-1"><a class="header-anchor" href="#_4️⃣-start-model-mo-hinh-goc-đe-fine-tune"><span>4️⃣ START_MODEL - Mô hình gốc để fine-tune</span></a></h3><ul><li><p>Như đã biết:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Fine-tuning = Khởi động từ 1 mô hình đã học (START_MODEL) + dữ liệu mới.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Có thể dùng <code>eng.traineddata</code> để fine-tune luôn, bởi nó là mô hình mặc định tiếng Anh, học rất tốt các ký tự Latin.</p></li><li><p>⚠️ Tuy nhiên:</p><ul><li><p><code>eng.traineddata</code> được huấn luyện để tổng quát nhiều font, layout, nên có thể hơi &quot;chung chung&quot;.</p></li><li><p>👉 Nếu bạn cần OCR văn bản kiểu chữ Gothic, hay font công nghiệp hiếm, nên chọn <code>deu_latf</code>, <code>osd</code>, hoặc custom model khác.</p></li></ul></li></ul><h4 id="🧐-nen-fine-tune-tu-model-goc-nao" tabindex="-1"><a class="header-anchor" href="#🧐-nen-fine-tune-tu-model-goc-nao"><span>🧐 Nên fine-tune từ model gốc nào?</span></a></h4><table><thead><tr><th style="text-align:center;">Trường hợp</th><th style="text-align:center;">START_MODEL phù hợp</th></tr></thead><tbody><tr><td style="text-align:center;">OCR ký tự đơn giản, rõ ràng, tiếng Anh, số serial, barcode</td><td style="text-align:center;">eng.traineddata</td></tr><tr><td style="text-align:center;">OCR ký tự dạng cổ điển, hoặc font máy móc cũ</td><td style="text-align:center;">deu_latf<br> osd</td></tr><tr><td style="text-align:center;">OCR tiếng Việt hoặc có dấu</td><td style="text-align:center;">vie.traineddata</td></tr></tbody></table><ul><li>Việc chọn START_MODEL (mô hình gốc để fine-tune) ảnh hưởng trực tiếp đến performance của mô hình cuối cùng (cả về độ chính xác lẫn tốc độ nhận diện):</li></ul><h4 id="❶-anh-huong-đen-đo-chinh-xac-accuracy" tabindex="-1"><a class="header-anchor" href="#❶-anh-huong-đen-đo-chinh-xac-accuracy"><span>❶ Ảnh hưởng đến độ chính xác (Accuracy)</span></a></h4><table><thead><tr><th style="text-align:center;">START_MODEL</th><th style="text-align:center;">Ảnh hưởng đến</th><th style="text-align:center;">Giải thích</th></tr></thead><tbody><tr><td style="text-align:center;">Gần với kiểu dữ liệu thực tế</td><td style="text-align:center;">✅ Tăng độ chính xác</td><td style="text-align:center;">Vì mô hình đã học gần đúng kiểu dữ liệu cần OCR</td></tr><tr><td style="text-align:center;">Quá khác biệt (VD: dùng mô hình Gothic để OCR font công nghiệp)</td><td style="text-align:center;">❌ Giảm độ chính xác</td><td style="text-align:center;">Model không nhận diện tốt ký tự/font/layout mà nó chưa từng học</td></tr><tr><td style="text-align:center;">Model best (tessdata_best)</td><td style="text-align:center;">✅ Chính xác, nhưng chậm hơn</td><td style="text-align:center;">Vì đã huấn luyện sâu hơn trên nhiều dạng ký tự</td></tr></tbody></table><h4 id="❷-anh-huong-đen-toc-đo-nhan-dien-speed" tabindex="-1"><a class="header-anchor" href="#❷-anh-huong-đen-toc-đo-nhan-dien-speed"><span>❷ Ảnh hưởng đến tốc độ nhận diện (Speed)</span></a></h4><ul><li>Nếu truy cập 🔗 https://github.com/tesseract-ocr để tải START_MODEL, chúng ta sẽ thấy 2 loại: <code>tessdata_fast</code> và <code>tessdata_best</code></li></ul><table><thead><tr><th style="text-align:center;">Loại model</th><th style="text-align:center;">Tốc độ</th><th style="text-align:center;">Ghi chú</th></tr></thead><tbody><tr><td style="text-align:center;">tessdata_fast</td><td style="text-align:center;">⚡ Rất nhanh</td><td style="text-align:center;">Được tối ưu cho tốc độ, phù hợp với môi trường real-time</td></tr><tr><td style="text-align:center;">tessdata_best</td><td style="text-align:center;">🐢 Chậm hơn</td><td style="text-align:center;">Chính xác hơn, nhưng nặng hơn do dùng LSTM nhiều tầng hơn</td></tr><tr><td style="text-align:center;">Fine-tune từ base nhẹ (như tessdata_fast)</td><td style="text-align:center;">⚖️ Cân bằng</td><td style="text-align:center;">Nếu training đúng hướng, vẫn đạt accuracy tốt mà không bị chậm</td></tr></tbody></table><h4 id="❸-anh-huong-đen-kha-nang-generalization-kha-nang-mo-hinh-hoc-tot-du-lieu-moi" tabindex="-1"><a class="header-anchor" href="#❸-anh-huong-đen-kha-nang-generalization-kha-nang-mo-hinh-hoc-tot-du-lieu-moi"><span>❸ Ảnh hưởng đến khả năng generalization (khả năng mô hình học tốt dữ liệu mới)</span></a></h4><ul><li><p>✦ START_MODEL tổng quát (multi-font, nhiều ký tự) → học chậm hơn, cần nhiều ảnh để fine-tune triệt để.</p></li><li><p>✦ START_MODEL chuyên biệt (VD: eng đã học font tương tự ảnh bạn) → dễ fine-tune, nhanh converge.</p></li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/vuepress-blog/assets/app-Bnxn8RC5.js" defer></script>
  </body>
</html>
