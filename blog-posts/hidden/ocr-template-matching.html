<!doctype html>
<html lang="vi-VN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/vuepress-blog/favicon.ico"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Josefin+Sans:300,400,500,600,700&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"><title>Template Matching - Giáº£i phÃ¡p há»— trá»£ nháº­n diá»‡n kÃ½ tá»± khÃ³ OCR | Kiáº¿n Thá»©c Tá»« Tráº£i Nghiá»‡m</title><meta name="description" content="Má»™t blog Ä‘Æ°á»£c táº¡o báº±ng VuePress">
    <link rel="preload" href="/vuepress-blog/assets/style-B07U0idc.css" as="style"><link rel="stylesheet" href="/vuepress-blog/assets/style-B07U0idc.css">
    <link rel="modulepreload" href="/vuepress-blog/assets/app-H7UPTZlK.js"><link rel="modulepreload" href="/vuepress-blog/assets/ocr-template-matching.html-CnMtQvJo.js">
    <link rel="prefetch" href="/vuepress-blog/assets/index.html-C9BH5l_7.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-b4OZyCpW.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-k9U0GFHk.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-C2WEWtEP.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-BrID5FHT.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/fastapi-base-project.html-CNpJm-6Y.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/mov-to-mp4-converter.html-CZaHSPVb.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ai-series.html-Cnwu3MzA.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-tesseract-series.html-CVP5cOAF.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/plsql-training-series.html-D-H0C4dP.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/redis-advanced.html-_FA5QyXu.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/redis-basic.html-Bh4AFO2x.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-training-saa-series.html-Bd75NMd2.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/jenkins.html-DVFk3kRL.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-series.html-3Q-08wzm.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ai-chatbot-practice.html-C6MVZ1d2.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ai-deep-learning-and-neural-networks.html-SM3F92Tt.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ai-engineer-mindset.html-DHBZNdI3.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ai-llm.html-BTNr6Tja.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ai-nen-tang.html-DBOeDUX0.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ai-pytorch-practice.html-S9bvq2K2.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ai-pytorch.html-93wND1Ni.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-automation.html-VrY3j3we.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-cloud-computing.html-udZgj5b6.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-database.html-Bo6n1Tg5.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-ec2.html-BqGXuNnj.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-gioi-thieu-aws.html-CY8moWle.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-iam.html-SazLRiJq.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-monitoring.html-VEiA-6_o.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-networking.html-DLKSTRNo.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-practice.html-C0KacuAl.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-serverless.html-gNodHLi8.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/aws-storage.html-CvYiWW42.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-beginner.html-DiTUT7D3.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-intermediate.html-SQmckOVA.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/linux-shell-script.html-CGMFc8KI.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-accuracy-perfomance.html-R44HpVnl.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-cache-tesseract.html-B7xUWwRc.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-gioi-thieu-tesseract.html-DdMSkOyM.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-practical.html-BW7L9Kxy.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-tong-quan.html-D0du4sRT.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/ocr-training-tesseract.html-BiNfasIH.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-advanced.html-Doh32Se6.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-beginner.html-eSckt1Vy.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-expert.html-BbgbUlgK.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/oracle-plsql-intermediate.html-DwHk9_u2.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/git-practices.html-CHJOXzig.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-DFe47jGY.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-B-tMgkh0.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/index.html-CGPAOH_0.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/404.html-CGiMU5gU.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/setupDevtools-7MC2TMWH-Ciz2NtwU.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container no-sidebar external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/vuepress-blog/"><img class="vp-site-logo" src="/vuepress-blog/images/logo.png" alt="Kiáº¿n Thá»©c Tá»« Tráº£i Nghiá»‡m"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Kiáº¿n Thá»©c Tá»« Tráº£i Nghiá»‡m</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/" aria-label="Trang Chá»§"><!---->Trang Chá»§<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/project/" aria-label="Dá»± Ãn"><!---->Dá»± Ãn<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/blog/" aria-label="Blog"><!---->Blog<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/about/" aria-label="Vá» TÃ´i"><!---->Vá» TÃ´i<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">NgÃ´n Ngá»¯</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">NgÃ´n Ngá»¯</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/vuepress-blog/blog-posts/hidden/ocr-template-matching.html" aria-label="Tiáº¿ng Viá»‡t"><!---->Tiáº¿ng Viá»‡t<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vuepress-blog/en/" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/" aria-label="Trang Chá»§"><!---->Trang Chá»§<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/project/" aria-label="Dá»± Ãn"><!---->Dá»± Ãn<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/blog/" aria-label="Blog"><!---->Blog<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/vuepress-blog/about/" aria-label="Vá» TÃ´i"><!---->Vá» TÃ´i<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">NgÃ´n Ngá»¯</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">NgÃ´n Ngá»¯</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link route-link-active auto-link" href="/vuepress-blog/blog-posts/hidden/ocr-template-matching.html" aria-label="Tiáº¿ng Viá»‡t"><!---->Tiáº¿ng Viá»‡t<!----></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/vuepress-blog/en/" aria-label="English"><!---->English<!----></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content" vp-content><!--[--><!--]--><div><h1 id="template-matching-giai-phap-ho-tro-nhan-dien-ky-tu-kho-ocr" tabindex="-1"><a class="header-anchor" href="#template-matching-giai-phap-ho-tro-nhan-dien-ky-tu-kho-ocr"><span>Template Matching - Giáº£i phÃ¡p há»— trá»£ nháº­n diá»‡n kÃ½ tá»± khÃ³ OCR</span></a></h1><p><img src="/vuepress-blog/assets/ocr-template-matching-Coa9gNAA.png" alt="Giá»›i thiá»‡u OCR"></p><ul><li><p>Template Matching lÃ  má»™t phÆ°Æ¡ng phÃ¡p so khá»›p hÃ¬nh áº£nh Ä‘Æ¡n giáº£n nhÆ°ng hiá»‡u quáº£, thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° giáº£i phÃ¡p bá»• trá»£ cho OCR trong cÃ¡c trÆ°á»ng há»£p kÃ½ tá»± nhá», má» hoáº·c khÃ³ Ä‘á»c mÃ  Tesseract chÆ°a nháº­n diá»‡n chÃ­nh xÃ¡c.</p></li><li><p>DÃ¹ khÃ´ng linh hoáº¡t báº±ng cÃ¡c mÃ´ hÃ¬nh OCR dá»±a trÃªn AI, Template Matching váº«n ráº¥t há»¯u Ã­ch trong cÃ¡c á»©ng dá»¥ng cÃ´ng nghiá»‡p vÃ  há»‡ thá»‘ng nháº­n diá»‡n kÃ½ tá»± chuyÃªn biá»‡t.</p></li></ul><p><a href="#1">1. Giá»›i thiá»‡u</a></p><p><a href="#2">2. Báº£n cháº¥t cá»§a Template Matching</a></p><p><a href="#3">3. Quy trÃ¬nh triá»ƒn khai Template Matching</a></p><p><a href="#4">4. VÃ­ dá»¥ code minh há»a (Python + OpenCV)</a></p><p><a name="1"></a></p><h2 id="ğŸ“Œ-1-gioi-thieu" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-1-gioi-thieu"><span>ğŸ“Œ 1. Giá»›i thiá»‡u</span></a></h2><ul><li><p>Viá»‡c sá»­ dá»¥ng mÃ´ hÃ¬nh há»c mÃ¡y Ä‘á»ƒ phÃ¢n tÃ­ch vÃ  chuyá»ƒn Ä‘á»•i hÃ¬nh áº£nh thÃ nh vÄƒn báº£n Ä‘Ã´i khi gáº·p khÃ³ khÄƒn khi kÃ½ tá»± trÃªn áº£nh bá»‹ nhá», má», mÃ©o, hoáº·c cÃ³ nhiá»…u ná»n.</p></li><li><p>ğŸ’¡ Trong nhá»¯ng tÃ¬nh huá»‘ng nÃ y, má»™t phÆ°Æ¡ng phÃ¡p Ä‘Æ¡n giáº£n nhÆ°ng hiá»‡u quáº£ cÃ³ thá»ƒ há»— trá»£ OCR lÃ  <strong>Template Matching</strong> (so khá»›p máº«u).</p></li></ul><h3 id="ğŸ¯-y-tuong-chinh" tabindex="-1"><a class="header-anchor" href="#ğŸ¯-y-tuong-chinh"><span>ğŸ¯ Ã tÆ°á»Ÿng chÃ­nh:</span></a></h3><ul><li><p>â³ <strong>BÃ i toÃ¡n</strong>: Äá»c cÃ¡c giÃ¡ trá»‹ sá»‘ hiá»ƒn thá»‹ trong Textbox.</p></li><li><p>â¶ Ta chuáº©n bá»‹ sáºµn bá»™ áº£nh máº«u (template) cho tá»«ng kÃ½ tá»± cáº§n nháº­n dáº¡ng (vÃ­ dá»¥: 0â€“9).</p></li><li><p>â· Khi cáº§n Ä‘á»c áº£nh Ä‘áº§u vÃ o, ta cáº¯t ra vÃ¹ng kÃ½ tá»± vÃ  so sÃ¡nh trá»±c tiáº¿p vá»›i cÃ¡c template Ä‘á»ƒ tÃ¬m kÃ½ tá»± khá»›p nháº¥t.</p></li></ul><h3 id="ğŸ‘€-template-matching-hoat-Ä‘ong-tot-khi-nao" tabindex="-1"><a class="header-anchor" href="#ğŸ‘€-template-matching-hoat-Ä‘ong-tot-khi-nao"><span>ğŸ‘€ Template Matching hoáº¡t Ä‘á»™ng tá»‘t khi nÃ o?</span></a></h3><ul><li><p>âœ§ Vá»‹ trÃ­ vÃ¹ng OCR cá»‘ Ä‘á»‹nh (biáº¿t trÆ°á»›c vÃ¹ng OCR).</p></li><li><p>âœ§ Bá»™ font hoáº·c kiá»ƒu hiá»ƒn thá»‹ Ã­t thay Ä‘á»•i.</p></li><li><p>âœ§ Chá»‰ cáº§n nháº­n dáº¡ng táº­p kÃ½ tá»± háº¡n cháº¿ (vÃ­ dá»¥: chá»‰ sá»‘ 0â€“9).</p></li><li><p>âœ§ CÃ¡c kÃ½ tá»± khÃ´ng Ä‘á»©ng dÃ­nh quÃ¡ sÃ¡t liá»n nhau.</p></li></ul><h3 id="âœ…-uu-Ä‘iem" tabindex="-1"><a class="header-anchor" href="#âœ…-uu-Ä‘iem"><span>âœ… Æ¯u Ä‘iá»ƒm:</span></a></h3><ul><li><p>DÃ¹ khÃ´ng thay tháº¿ Ä‘Æ°á»£c OCR toÃ n diá»‡n, nhÆ°ng Template Matching mang láº¡i Æ°u Ä‘iá»ƒm riÃªng:</p><ul><li><p>âœ§ Nhanh. Náº¿u báº¡n Ä‘Ã£ tá»«ng Ä‘o thá»i gian OCR vá»›i Tesseract rá»“i thÃ¬ thá»i gian khi dÃ¹ng phÆ°Æ¡ng phÃ¡p nÃ y sáº½ khiáº¿n báº¡n ngáº¡c nhiÃªn khi cÃ³ thá»ƒ giáº£m hÆ¡n ná»­a thá»i gian.</p></li><li><p>âœ§ Dá»… triá»ƒn khai.</p></li><li><p>âœ§ Äá»™ tin cáº­y cao (lÃªn Ä‘áº¿n 100% náº¿u trong Ä‘iá»u kiá»‡n hoáº¡t Ä‘á»™ng tá»‘t nháº¥t nhÆ° Ä‘Ã£ Ä‘á» cáº­p phÃ­a trÃªn).</p></li></ul></li></ul><p><a name="2"></a></p><h2 id="ğŸ“Œ-2-ban-chat-cua-template-matching" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-2-ban-chat-cua-template-matching"><span>ğŸ“Œ 2. Báº£n cháº¥t cá»§a Template Matching</span></a></h2><ul><li><p>Template Matching trong OpenCV lÃ  ká»¹ thuáº­t so sÃ¡nh hÃ¬nh áº£nh, cá»¥ thá»ƒ lÃ :</p><ul><li><p>âœ¦ So sÃ¡nh má»™t máº«u (template) nhá» vá»›i toÃ n bá»™ áº£nh gá»‘c, Ä‘á»ƒ tÃ¬m vá»‹ trÃ­ trong áº£nh giá»‘ng máº«u nháº¥t.</p></li><li><p>âœ¦ Template Matching khÃ´ng hiá»ƒu Ã½ nghÄ©a cá»§a hÃ¬nh (nhÆ° sá»‘ máº¥y), chá»‰ biáº¿t so sÃ¡nh Ä‘iá»ƒm áº£nh.</p><ul><li><p>âœ§ Do váº­y, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh giÃ¡ trá»‹ sá»‘ máº¥y thÃ¬ cÃ¡ch hay dÃ¹ng nháº¥t lÃ  gÃ¡n &quot;Ã½ nghÄ©a&quot; cho tá»«ng template báº±ng chÃ­nh tÃªn áº£nh máº«u.</p></li><li><p>âœ§ VÃ­ dá»¥: áº¢nh template <code>5.png</code> náº¿u giá»‘ng áº£nh gá»‘c nháº¥t thÃ¬ sá»‘ trong áº£nh gá»‘c lÃ  tÃªn áº£nh template, tá»©c sá»‘ <code>5</code>.</p></li></ul></li></ul></li></ul><h3 id="ğŸ§ -co-che-hoat-Ä‘ong" tabindex="-1"><a class="header-anchor" href="#ğŸ§ -co-che-hoat-Ä‘ong"><span>ğŸ§  CÆ¡ cháº¿ hoáº¡t Ä‘á»™ng</span></a></h3><ul><li><p>âœ¦ Giáº£ sá»­:</p><ul><li>âœ§ áº¢nh gá»‘c: hÃ¬nh chá»¥p chá»©a vÃ¹ng cáº§n Ä‘á»c giÃ¡ trá»‹.</li><li>âœ§ Template: áº£nh sá»‘ 5 (cáº¯t ra tá»« áº£nh tháº­t).</li></ul></li><li><p>âœ¦ BÆ°á»›c thá»±c hiá»‡n:</p><ul><li>â¶ OpenCV trÆ°á»£t template qua tá»«ng vá»‹ trÃ­ cá»§a áº£nh gá»‘c (giá»‘ng nhÆ° trÆ°á»£t cá»­a sá»•).</li><li>â· Táº¡i má»—i vá»‹ trÃ­, nÃ³ tÃ­nh toÃ¡n Ä‘á»™ tÆ°Æ¡ng Ä‘á»“ng (similarity score) giá»¯a vÃ¹ng áº£nh Ä‘Ã³ vÃ  template.</li><li>â¸ Káº¿t quáº£ lÃ  má»™t ma tráº­n giÃ¡ trá»‹ tÆ°Æ¡ng Ä‘á»“ng â†’ chá»— nÃ o Ä‘iá»ƒm cao nháº¥t lÃ  vá»‹ trÃ­ giá»‘ng template nháº¥t.</li></ul></li></ul><h3 id="ğŸš€-phuong-phap-so-khop-pho-bien-opencv" tabindex="-1"><a class="header-anchor" href="#ğŸš€-phuong-phap-so-khop-pho-bien-opencv"><span>ğŸš€ PhÆ°Æ¡ng phÃ¡p so khá»›p phá»• biáº¿n (OpenCV)</span></a></h3><ul><li>Trong OpenCV há»— trá»£ nhiá»u phÆ°Æ¡ng phÃ¡p tÃ­nh Ä‘á»™ khá»›p. Má»™t sá»‘ phÆ°Æ¡ng phÃ¡p hay dÃ¹ng:</li></ul><h4 id="_1ï¸âƒ£-cv2-tm-sqdiff" tabindex="-1"><a class="header-anchor" href="#_1ï¸âƒ£-cv2-tm-sqdiff"><span>1ï¸âƒ£ cv2.TM_SQDIFF</span></a></h4><ul><li><p>ğŸ§  NguyÃªn lÃ½: TÃ­nh tá»•ng bÃ¬nh phÆ°Æ¡ng sai khÃ¡c giá»¯a template vÃ  áº£nh táº¡i tá»«ng vá»‹ trÃ­.</p></li><li><p>ğŸ¯ GiÃ¡ trá»‹ tá»‘t nháº¥t: CÃ ng nhá» cÃ ng tá»‘t (0 nghÄ©a lÃ  trÃ¹ng khá»›p tuyá»‡t Ä‘á»‘i).</p></li><li><p>ğŸ‘€ Khi nÃ o dÃ¹ng:</p><ul><li><p>âœ§ Khi áº£nh vÃ  template cÃ³ Ä‘á»™ tÆ°Æ¡ng pháº£n cao.</p></li><li><p>âœ§ Khi báº¡n muá»‘n phÃ¡t hiá»‡n sá»± giá»‘ng nhau tuyá»‡t Ä‘á»‘i vá» pixel.</p></li><li><p>âœ§ Template nhá»: Hiá»‡u quáº£ vá»›i template kÃ­ch thÆ°á»›c nhá» (vÃ­ dá»¥ 8x16).</p></li><li><p>âœ§ Khi cáº§n phÃ¢n biá»‡t rÃµ rÃ ng: PhÃ¢n biá»‡t sá»‘ gáº§n giá»‘ng nhau nhÆ° 6 vs 8, 0 vs O, v.v.</p></li></ul></li><li><p>âœ… Æ¯u Ä‘iá»ƒm: ÄÆ¡n giáº£n, nhanh.</p></li><li><p>âŒ NhÆ°á»£c Ä‘iá»ƒm: Nháº¡y cáº£m vá»›i thay Ä‘á»•i Ã¡nh sÃ¡ng, nhiá»…u, scale.</p></li></ul><h4 id="_2ï¸âƒ£-cv2-tm-ccorr" tabindex="-1"><a class="header-anchor" href="#_2ï¸âƒ£-cv2-tm-ccorr"><span>2ï¸âƒ£ cv2.TM_CCORR</span></a></h4><ul><li><p>ğŸ§  NguyÃªn lÃ½: TÃ­nh tÃ­ch cháº­p (correlation) giá»¯a template vÃ  áº£nh.</p></li><li><p>ğŸ¯ GiÃ¡ trá»‹ tá»‘t nháº¥t: CÃ ng lá»›n cÃ ng tá»‘t (1 lÃ  khá»›p hoÃ n toÃ n).</p></li><li><p>ğŸ‘€ Khi nÃ o dÃ¹ng:</p><ul><li><p>âœ§ Khi áº£nh vÃ  template cÃ³ cÆ°á»ng Ä‘á»™ pixel tÆ°Æ¡ng quan tuyáº¿n tÃ­nh.</p></li><li><p>âœ§ Template lá»›n hÆ¡n: Khi template cÃ³ nhiá»u detail.</p></li></ul></li><li><p>âœ… Æ¯u Ä‘iá»ƒm: á»”n hÆ¡n so vá»›i SQDIFF khi Ã¡nh sÃ¡ng thay Ä‘á»•i má»™t chÃºt.</p></li><li><p>âŒ NhÆ°á»£c Ä‘iá»ƒm: Váº«n nháº¡y vá»›i nhiá»…u vÃ  thay Ä‘á»•i tÆ°Æ¡ng pháº£n.</p></li></ul><h4 id="_3ï¸âƒ£-cv2-tm-ccoeff" tabindex="-1"><a class="header-anchor" href="#_3ï¸âƒ£-cv2-tm-ccoeff"><span>3ï¸âƒ£ cv2.TM_CCOEFF</span></a></h4><ul><li><p>ğŸ§  NguyÃªn lÃ½: Loáº¡i bá» áº£nh hÆ°á»Ÿng cá»§a trung bÃ¬nh cÆ°á»ng Ä‘á»™ pixel trÆ°á»›c khi tÃ­nh tÆ°Æ¡ng quan.</p></li><li><p>ğŸ¯ GiÃ¡ trá»‹ tá»‘t nháº¥t: CÃ ng lá»›n cÃ ng tá»‘t.</p></li><li><p>ğŸ‘€ Khi nÃ o dÃ¹ng:</p><ul><li><p>âœ§ Khi áº£nh Ä‘áº§u vÃ o cÃ³ Ä‘á»™ sÃ¡ng hoáº·c Ä‘á»™ tÆ°Æ¡ng pháº£n thay Ä‘á»•i.</p></li><li><p>âœ§ PhÃ¹ há»£p vá»›i OCR trong mÃ´i trÆ°á»ng sáº£n xuáº¥t, nÆ¡i Ã¡nh sÃ¡ng cÃ³ thá»ƒ thay Ä‘á»•i theo ca.</p></li></ul></li><li><p>âœ… Æ¯u Ä‘iá»ƒm: á»”n Ä‘á»‹nh hÆ¡n SQDIFF vÃ  CCORR.</p></li></ul><p><a name="3"></a></p><h2 id="ğŸ“Œ-3-quy-trinh-trien-khai-template-matching" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-3-quy-trinh-trien-khai-template-matching"><span>ğŸ“Œ 3. Quy trÃ¬nh triá»ƒn khai Template Matching</span></a></h2><h3 id="â¶-chuan-bi-du-lieu" tabindex="-1"><a class="header-anchor" href="#â¶-chuan-bi-du-lieu"><span>â¶ Chuáº©n bá»‹ dá»¯ liá»‡u</span></a></h3><ul><li><p>âœ¦ áº¢nh gá»‘c (input image): LÃ  áº£nh chá»©a vÃ¹ng giÃ¡ trá»‹ cáº§n nháº­n diá»‡n.</p></li><li><p>âœ¦ Tiá»n xá»­ lÃ½ áº£nh gá»‘c:</p><ul><li>âœ§ Chuyá»ƒn sang áº£nh grayscale Ä‘á»ƒ giáº£m nhiá»…u mÃ u.</li><li>âœ§ Ãp dá»¥ng thresholding hoáº·c adaptive thresholding Ä‘á»ƒ tÃ¡ch ná»n â€“ kÃ½ tá»±.</li><li>âœ§ CÃ¢n nháº¯c resize áº£nh vá» cÃ¹ng kÃ­ch thÆ°á»›c vá»›i template.</li></ul></li><li><p>âœ¦ Template:</p><ul><li>âœ§ Táº­p há»£p áº£nh máº«u cá»§a tá»«ng giÃ¡ trá»‹ (VÃ­ dá»¥: 0â€“9, Aâ€“Z, v.v.)</li><li>âœ§ ThÆ°á»ng chÃºng ta sáº½ táº¡o má»™t hÃ m táº¡m chá»©a logic lÆ°u áº£nh gá»‘c sau tiá»n xá»­ lÃ½. Sau Ä‘Ã³ OCR cÃ¡c áº£nh riÃªng biá»‡t chá»‰ chá»©a kÃ½ tá»± tá»« 0-9 Ä‘á»ƒ thu vá» cÃ¡c áº£nh sau khi tiá»n xá»­ lÃ½ lÃ m áº£nh máº«u luÃ´n. Má»¥c Ä‘Ã­ch Ä‘á»ƒ áº£nh máº«u giá»‘ng vá»›i áº£nh gá»‘c nháº¥t.</li></ul></li></ul><h3 id="â·-chay-thuat-toan-so-khop" tabindex="-1"><a class="header-anchor" href="#â·-chay-thuat-toan-so-khop"><span>â· Cháº¡y thuáº­t toÃ¡n so khá»›p</span></a></h3><ul><li>âœ¦ Sá»­ dá»¥ng hÃ m <code>cv2.matchTemplate(image, template, method)</code> vá»›i má»™t trong cÃ¡c phÆ°Æ¡ng phÃ¡p so khá»›p: <ul><li>âœ§ <code>cv2.TM_SQDIFF</code> hoáº·c <code>cv2.TM_SQDIFF_NORMED</code></li><li>âœ§ <code>cv2.TM_CCOEFF</code> hoáº·c <code>cv2.TM_CCOEFF_NORMED</code></li><li>âœ§ <code>cv2.TM_CCORR</code> hoáº·c <code>cv2.TM_CCORR_NORMED</code></li></ul></li></ul><h3 id="â¸-tim-vi-tri-va-ket-qua-khop" tabindex="-1"><a class="header-anchor" href="#â¸-tim-vi-tri-va-ket-qua-khop"><span>â¸ TÃ¬m vá»‹ trÃ­ vÃ  káº¿t quáº£ khá»›p</span></a></h3><ul><li><p>âœ¦ DÃ¹ng <code>cv2.minMaxLoc()</code> Ä‘á»ƒ láº¥y giÃ¡ trá»‹ min/max khá»›p (tÃ¹y phÆ°Æ¡ng phÃ¡p).</p></li><li><p>âœ¦ So sÃ¡nh vá»›i má»™t ngÆ°á»¡ng tin cáº­y (threshold) Ä‘á»ƒ quyáº¿t Ä‘á»‹nh kÃ½ tá»± cÃ³ Ä‘Æ°á»£c nháº­n diá»‡n hay khÃ´ng.</p><ul><li>VÃ­ dá»¥ khá»›p trÃªn 95% thÃ¬ má»›i Ä‘á»§ tin tÆ°á»Ÿng.</li></ul></li></ul><h3 id="â¹-hau-xu-ly-ket-qua" tabindex="-1"><a class="header-anchor" href="#â¹-hau-xu-ly-ket-qua"><span>â¹ Háº­u xá»­ lÃ½ káº¿t quáº£</span></a></h3><ul><li><p>âœ¦ Náº¿u cÃ³ nhiá»u vá»‹ trÃ­ trÃ¹ng khá»›p, chá»n vá»‹ trÃ­ cÃ³ giÃ¡ trá»‹ tá»‘t nháº¥t (min hoáº·c max).</p></li><li><p>âœ¦ Náº¿u káº¿t quáº£ náº±m dÆ°á»›i ngÆ°á»¡ng tin cáº­y â†’ cÃ³ thá»ƒ gÃ¡n nhÃ£n â€œkhÃ´ng xÃ¡c Ä‘á»‹nhâ€ Ä‘á»ƒ trÃ¡nh sai sÃ³t.</p></li></ul><p><a name="4"></a></p><h2 id="ğŸ“Œ-4-vi-du-code-minh-hoa-python-opencv" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-4-vi-du-code-minh-hoa-python-opencv"><span>ğŸ“Œ 4. VÃ­ dá»¥ code minh há»a (Python + OpenCV)</span></a></h2><h3 id="_1ï¸âƒ£-tao-lop-rieng-chuyen-xu-ly-cac-logic-cho-template-maching" tabindex="-1"><a class="header-anchor" href="#_1ï¸âƒ£-tao-lop-rieng-chuyen-xu-ly-cac-logic-cho-template-maching"><span>1ï¸âƒ£ Táº¡o lá»›p riÃªng chuyÃªn xá»­ lÃ½ cÃ¡c logic cho Template Maching</span></a></h3><ul><li>VÃ­ dá»¥ chÃºng ta táº¡o file <code>template_matching_worker.py</code> trong folder <code>core</code>.</li></ul><h3 id="_2ï¸âƒ£-tao-ham-lay-Ä‘uong-dan-Ä‘en-folder-chua-anh-mau-template" tabindex="-1"><a class="header-anchor" href="#_2ï¸âƒ£-tao-ham-lay-Ä‘uong-dan-Ä‘en-folder-chua-anh-mau-template"><span>2ï¸âƒ£ Táº¡o hÃ m láº¥y Ä‘Æ°á»ng dáº«n Ä‘áº¿n folder chá»©a áº£nh máº«u (template)</span></a></h3><ul><li><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># template_matching_worker.py</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">get_template_folder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>sys<span class="token punctuation">,</span> <span class="token string">&#39;_MEIPASS&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># When running as a bundled executable (e.g., PyInstaller)</span></span>
<span class="line">        <span class="token keyword">return</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>_MEIPASS<span class="token punctuation">,</span> <span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;templates&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># When running as a script (e.g., python main.py)</span></span>
<span class="line">        <span class="token keyword">return</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;templates&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>âœ¦ NhÆ° vÃ­ dá»¥ trÃªn thÃ¬ ta Ä‘ang Ä‘áº·t cÃ¡c áº£nh máº«u trong folder <code>data/templates</code>.</p></li><li><p>âœ¦ CÃ¡c áº£nh máº«u sáº½ chá»©a 1 kÃ½ tá»±, gá»“m cÃ¡c áº£nh tá»« kÃ½ tá»± sá»‘ 0-9.</p><ul><li>TrÆ°á»ng há»£p 1 sá»‘ cÃ³ nhiá»u kiá»ƒu hÃ¬nh dÃ¡ng khÃ¡c nhau thÃ¬ táº¡o nhiá»u hÆ¡n 1 áº£nh tÆ°Æ¡ng á»©ng cho sá»‘ Ä‘Ã³.</li></ul></li></ul><h3 id="_3ï¸âƒ£-tao-ham-load-template-images" tabindex="-1"><a class="header-anchor" href="#_3ï¸âƒ£-tao-ham-load-template-images"><span>3ï¸âƒ£ Táº¡o hÃ m load template images</span></a></h3><ul><li><p>ChÃºng ta sáº½ load vÃ  lÆ°u cÃ¡c áº£nh template dÆ°á»›i dáº¡ng:</p><ul><li>âœ§ <code>key</code>: tÃªn áº£nh, má»¥c Ä‘Ã­ch lÃ m giÃ¡ trá»‹ nháº­n diá»‡n khi sá»­ dá»¥ng Template Matching.</li><li>âœ§ <code>value</code>: numpy array chá»©a dá»¯ liá»‡u áº£nh grayscale, má»¥c Ä‘Ã­ch Ä‘á»ƒ sá»­ dá»¥ng lÃ m giÃ¡ trá»‹ matching.</li></ul></li><li><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># template_matching_worker.py</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">load_templates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    template_dir <span class="token operator">=</span> get_template_folder<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    templates <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Check if the template directory exists</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>template_dir<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> templates</span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Load templates</span></span>
<span class="line">    <span class="token keyword">for</span> fname <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>template_dir<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Only access load PNG files for template matching</span></span>
<span class="line">        <span class="token keyword">if</span> fname<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">&#39;.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token comment"># Use the first part of the filename as the label (Ex:&#39;1-a.png&#39; â†’ &#39;1&#39;)</span></span>
<span class="line">            label <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>fname<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">            <span class="token comment"># Load the image in grayscale</span></span>
<span class="line">            img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>template_dir<span class="token punctuation">,</span> fname<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span> IMREAD_GRAYSCALE<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">if</span> img <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">                templates<span class="token punctuation">[</span>label<span class="token punctuation">]</span> <span class="token operator">=</span> img</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> templates</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_4ï¸âƒ£-tao-ham-matching-anh-chua-vung-ocr-voi-anh-mau" tabindex="-1"><a class="header-anchor" href="#_4ï¸âƒ£-tao-ham-matching-anh-chua-vung-ocr-voi-anh-mau"><span>4ï¸âƒ£ Táº¡o hÃ m matching áº£nh chá»©a vÃ¹ng OCR vá»›i áº£nh máº«u</span></a></h3><ul><li><p>âœ¦ áº¢nh gá»‘c truyá»n vÃ o lÃ  áº£nh Ä‘Ã£ qua tiá»n xá»­ lÃ½ vÃ  chá»‰ chá»©a vÃ¹ng cáº§n Ä‘á»c giÃ¡ trá»‹.</p></li><li><p>âœ¦ Templates truyá»n vÃ o chÃ­nh lÃ  giÃ¡ trá»‹ tráº£ vá» cá»§a hÃ m <code>load_templates</code>.</p></li><li><p>CÃ¡c bÆ°á»›c matching:</p><ul><li><p>â¶ Copy vÃ  chuyá»ƒn áº£nh gá»‘c thÃ nh dáº¡ng ná»n Ä‘en, chá»¯ tráº¯ng.</p><ul><li>ThÃ´ng thÆ°á»ng khi tiá»n xá»­ lÃ½ áº£nh gá»‘c sáº½ chuyá»ƒn vá» ná»n tráº¯ng chá»¯ Ä‘en. Viá»‡c chuyá»ƒn láº¡i áº£nh vá» ná»n Ä‘en chá»¯ tráº¯ng giÃºp cÃ¡c hÃ m matching xá»­ lÃ½ Ä‘Æ¡n giáº£n hÆ¡n.</li></ul></li><li><p>â· TÃ­nh sá»‘ pixel tráº¯ng má»—i cá»™t trÃªn áº£nh gá»‘c (má»—i cá»™t lÃ  1 pixel theo trá»¥c dá»c).</p><ul><li><p>âœ§ CÃ¡c vÃ¹ng chá»©a kÃ½ tá»± sáº½ lÃ  vÃ¹ng chá»©a liÃªn tiáº¿p cÃ¡c cá»™t cÃ³ pixel tráº¯ng.</p></li><li><p>âœ§ Cá»™t khÃ´ng cÃ³ pixel tráº¯ng Ä‘Æ°á»£c hiá»ƒu lÃ  khoáº£ng ngÄƒn cÃ¡ch giá»¯a cÃ¡c kÃ½ tá»±.</p></li></ul></li><li><p>â¸ Duyá»‡t tá»«ng vÃ¹ng chá»©a kÃ½ tá»± vÃ  resize vá» kÃ­ch thÆ°á»›c chuáº©n template (áº£nh máº«u).</p><ul><li>Viá»‡c resize vá» kÃ­ch thÆ°á»›c chuáº©n template (áº£nh máº«u) Ä‘á»ƒ trÃ¡nh nhá»¯ng exception xáº£y ra khi mmatching do kÃ­ch thÆ°á»›c template &gt; áº£nh gá»‘c.</li></ul></li><li><p>â¹ Matching tá»«ng vÃ¹ng chá»©a kÃ½ tá»± vá»›i áº£nh máº«u, tÃ¬m áº£nh khá»›p nháº¥t Ä‘á»ƒ xÃ¡c Ä‘á»‹nh giÃ¡ trá»‹.</p></li><li><p>âº Ná»‘i tá»«ng giÃ¡ trá»‹ Ä‘Ã£ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c táº¡i má»—i vÃ¹ng thÃ nh chuá»—i 1 giÃ¡ trá»‹ cuá»‘i cÃ¹ng.</p></li></ul></li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">match_template</span><span class="token punctuation">(</span>ocr_img<span class="token punctuation">,</span> templates<span class="token punctuation">,</span> threshold<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># Check if templates exist for the given stage</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">not</span> templates<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">None</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Copy áº£nh gá»‘c</span></span>
<span class="line">    input_img <span class="token operator">=</span> ocr_img<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># Chuyá»ƒn áº£nh gá»‘c thÃ nh dáº¡ng ná»n Ä‘en, chá»¯ tráº¯ng</span></span>
<span class="line">    inv_img <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">-</span> input_img</span>
<span class="line">    <span class="token comment"># TÃ­nh sá»‘ pixel tráº¯ng má»—i cá»™t (tráº¯ng = chá»¯)</span></span>
<span class="line">    hist <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>inv_img <span class="token operator">//</span> <span class="token number">255</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># TÃ¬m cÃ¡c vÃ¹ng chá»©a kÃ½ tá»±</span></span>
<span class="line">    chars_bounds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    in_char <span class="token operator">=</span> <span class="token boolean">False</span></span>
<span class="line">    start_x <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">    <span class="token keyword">for</span> x<span class="token punctuation">,</span> val <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>hist<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> val <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token keyword">not</span> in_char<span class="token punctuation">:</span></span>
<span class="line">            in_char <span class="token operator">=</span> <span class="token boolean">True</span></span>
<span class="line">            start_x <span class="token operator">=</span> x</span>
<span class="line">        <span class="token keyword">elif</span> val <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> in_char<span class="token punctuation">:</span></span>
<span class="line">            end_x <span class="token operator">=</span> x</span>
<span class="line">            <span class="token keyword">if</span> end_x <span class="token operator">-</span> start_x <span class="token operator">&gt;=</span> <span class="token number">8</span><span class="token punctuation">:</span> <span class="token comment"># Giáº£ sá»­ vÃ¹ng Ä‘Æ°á»£c xem chá»©a kÃ½ tá»± rá»™ng tá»‘i thiá»ƒu 8px</span></span>
<span class="line">                in_char <span class="token operator">=</span> <span class="token boolean">False</span></span>
<span class="line">                chars_bounds<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>start_x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> end_x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># Padding rá»™ng vÃ¹ng chá»©a kÃ½ tá»±</span></span>
<span class="line">    <span class="token keyword">if</span> in_char<span class="token punctuation">:</span>  <span class="token comment"># TrÆ°á»ng há»£p kÃ½ tá»± cuá»‘i cÃ¹ng dÃ­nh sÃ¡t mÃ©p</span></span>
<span class="line">        chars_bounds<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>start_x<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>hist<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Xá»­ lÃ½ tá»«ng kÃ½ tá»±</span></span>
<span class="line">    result_digits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span>start_x<span class="token punctuation">,</span> end_x<span class="token punctuation">)</span> <span class="token keyword">in</span> chars_bounds<span class="token punctuation">:</span></span>
<span class="line">        char_img <span class="token operator">=</span> ocr_img<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> start_x<span class="token punctuation">:</span>end_x<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Resize kÃ½ tá»± vá» kÃ­ch thÆ°á»›c chuáº©n template</span></span>
<span class="line">        first_template <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">(</span>templates<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        char_resized <span class="token operator">=</span> normalize_to_template<span class="token punctuation">(</span>char_img<span class="token punctuation">,</span> first_template<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Match template tá»«ng sá»‘, chá»n score nhá» nháº¥t (khá»›p nháº¥t)</span></span>
<span class="line">        best_match <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">        best_score <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span></span>
<span class="line">        <span class="token keyword">for</span> label<span class="token punctuation">,</span> tmpl <span class="token keyword">in</span> templates_img<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            res <span class="token operator">=</span> cv2<span class="token punctuation">.</span>matchTemplate<span class="token punctuation">(</span>char_resized<span class="token punctuation">,</span> tmpl<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>TM_SQDIFF_NORMED<span class="token punctuation">)</span></span>
<span class="line">            min_val<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _ <span class="token operator">=</span> cv2<span class="token punctuation">.</span>minMaxLoc<span class="token punctuation">(</span>res<span class="token punctuation">)</span></span>
<span class="line">            score <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> min_val</span>
<span class="line"></span>
<span class="line">            <span class="token keyword">if</span> score <span class="token operator">&gt;</span> best_score <span class="token keyword">and</span> score <span class="token operator">&gt;=</span> threshold<span class="token punctuation">:</span></span>
<span class="line">                best_score <span class="token operator">=</span> score</span>
<span class="line">                best_match <span class="token operator">=</span> label</span>
<span class="line">        <span class="token keyword">if</span> best_match <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">            result_digits<span class="token punctuation">.</span>append<span class="token punctuation">(</span>best_match<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result_digits<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">normalize_to_template</span><span class="token punctuation">(</span>ocr_img<span class="token punctuation">,</span> template_img<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    h_t<span class="token punctuation">,</span> w_t <span class="token operator">=</span> template_img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line">    h_i<span class="token punctuation">,</span> w_i <span class="token operator">=</span> ocr_img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Copy Ä‘á»ƒ khÃ´ng sá»­a áº£nh gá»‘c</span></span>
<span class="line">    img <span class="token operator">=</span> ocr_img<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Xá»­ lÃ½ chiá»u cao (H)</span></span>
<span class="line">    <span class="token keyword">if</span> h_i <span class="token operator">&gt;</span> h_t<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Cáº¯t bá»›t 2 bÃªn, Æ°u tiÃªn giá»¯ pháº§n giá»¯a</span></span>
<span class="line">        cut_total <span class="token operator">=</span> h_i <span class="token operator">-</span> h_t</span>
<span class="line">        cut_top <span class="token operator">=</span> cut_total <span class="token operator">//</span> <span class="token number">2</span></span>
<span class="line">        cut_bottom <span class="token operator">=</span> cut_total <span class="token operator">-</span> cut_top</span>
<span class="line">        img <span class="token operator">=</span> img<span class="token punctuation">[</span>cut_top<span class="token punctuation">:</span>h_t<span class="token operator">-</span>cut_bottom<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">elif</span> h_i <span class="token operator">&lt;</span> h_t<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Pad tráº¯ng trÃªn dÆ°á»›i</span></span>
<span class="line">        pad_total <span class="token operator">=</span> h_t <span class="token operator">-</span> h_i</span>
<span class="line">        pad_top <span class="token operator">=</span> pad_total <span class="token operator">//</span> <span class="token number">2</span></span>
<span class="line">        pad_bottom <span class="token operator">=</span> pad_total <span class="token operator">-</span> pad_top</span>
<span class="line">        img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>copyMakeBorder<span class="token punctuation">(</span>img<span class="token punctuation">,</span> pad_top<span class="token punctuation">,</span> pad_bottom<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="line">                                  borderType<span class="token operator">=</span>cv2<span class="token punctuation">.</span>BORDER_CONSTANT<span class="token punctuation">,</span></span>
<span class="line">                                  value<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Xá»­ lÃ½ chiá»u rá»™ng (W)</span></span>
<span class="line">    h_i<span class="token punctuation">,</span> w_i <span class="token operator">=</span> img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment"># Cáº­p nháº­t láº¡i kÃ­ch thÆ°á»›c sau khi xá»­ lÃ½ height</span></span>
<span class="line">    <span class="token keyword">if</span> w_i <span class="token operator">&gt;</span> w_t<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Cáº¯t bá»›t 2 bÃªn, Æ°u tiÃªn giá»¯ pháº§n giá»¯a</span></span>
<span class="line">        cut_total <span class="token operator">=</span> w_i <span class="token operator">-</span> w_t</span>
<span class="line">        cut_left <span class="token operator">=</span> cut_total <span class="token operator">//</span> <span class="token number">2</span></span>
<span class="line">        cut_right <span class="token operator">=</span> cut_total <span class="token operator">-</span> cut_left</span>
<span class="line">        img <span class="token operator">=</span> img<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> cut_left<span class="token punctuation">:</span>w_i<span class="token operator">-</span>cut_right<span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">elif</span> w_i <span class="token operator">&lt;</span> w_t<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Pad tráº¯ng 2 bÃªn</span></span>
<span class="line">        pad_total <span class="token operator">=</span> w_t <span class="token operator">-</span> w_i</span>
<span class="line">        pad_left <span class="token operator">=</span> pad_total <span class="token operator">//</span> <span class="token number">2</span></span>
<span class="line">        pad_right <span class="token operator">=</span> pad_total <span class="token operator">-</span> pad_left</span>
<span class="line">        img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>copyMakeBorder<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> pad_left<span class="token punctuation">,</span> pad_right<span class="token punctuation">,</span></span>
<span class="line">                                 borderType<span class="token operator">=</span>cv2<span class="token punctuation">.</span>BORDER_CONSTANT<span class="token punctuation">,</span></span>
<span class="line">                                 value<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> img</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5ï¸âƒ£-goi-va-su-dung-template-matching" tabindex="-1"><a class="header-anchor" href="#_5ï¸âƒ£-goi-va-su-dung-template-matching"><span>5ï¸âƒ£ Gá»i vÃ  sá»­ dá»¥ng Template Matching</span></a></h3><ul><li><p>TÃ¹y bá»‘i cáº£nh bÃ i toÃ¡n mÃ  chÃºng ta sáº½ gá»i Template Matching trÆ°á»›c khi OCR hoáº·c sau OCR Ä‘á»ƒ tÄƒng Ä‘á»™ chÃ­nh xÃ¡c:</p><ul><li><p>â¶ Gá»i hÃ m load template images má»™t láº§n ngay khi khá»Ÿi Ä‘á»™ng á»©ng dá»¥ng, trÃ¡nh viá»‡c load láº¡i images má»—i láº§n OCR, cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ performance.</p></li><li><p>â· Giáº£ sá»­ chÃºng ta sáº½ gá»i Template Matching trÆ°á»›c, náº¿u khÃ´ng cÃ³ giÃ¡ trá»‹ tráº£ vá» thÃ¬ gá»i OCR sau:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Preprocess image (convert to grayscale, thresholding, etc.)</span></span>
<span class="line">processed <span class="token operator">=</span> preprocess_crop_image<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># Call Template Matching</span></span>
<span class="line">result <span class="token operator">=</span> match_template<span class="token punctuation">(</span>pre_processed<span class="token punctuation">,</span> templates<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/vuepress-blog/assets/app-H7UPTZlK.js" defer></script>
  </body>
</html>
