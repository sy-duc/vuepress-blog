import{_ as s,c as a,d as e,o as p}from"./app-CQf6q5OW.js";const l={};function t(i,n){return p(),a("div",null,n[0]||(n[0]=[e(`<h1 id="pl-sql-nang-cao" tabindex="-1"><a class="header-anchor" href="#pl-sql-nang-cao"><span>PL/SQL n√¢ng cao</span></a></h1><p><a href="#1">1. Transactions</a></p><p><a href="#2">2. Dynamic SQL</a></p><p><a href="#3">3. Collection v√† Record</a></p><p><a href="#4">4. Bulk Processing</a></p><p><a name="1"></a></p><h2 id="üìå-1-transactions-trong-pl-sql" tabindex="-1"><a class="header-anchor" href="#üìå-1-transactions-trong-pl-sql"><span>üìå 1. Transactions trong PL/SQL</span></a></h2><p>Transaction l√† m·ªôt t·∫≠p h·ª£p c√°c c√¢u l·ªánh SQL ƒë∆∞·ª£c th·ª±c thi nh∆∞ m·ªôt ƒë∆°n v·ªã c√¥ng vi·ªác.</p><p>V·ªÅ t√≠nh ch·∫•t c·ªßa Transaction th√¨ ch·∫Øc s·∫Ω kh√¥ng c·∫ßn ƒë·ªÅ c·∫≠p l·∫°i.</p><p>Trong PL/SQL, m·ªôt transaction b·∫Øt ƒë·∫ßu t·ª± ƒë·ªông khi th·ª±c hi·ªán b·∫•t k·ª≥ c√¢u l·ªánh DML (INSERT, UPDATE, DELETE).</p><h3 id="üîπ-cac-lenh-ƒëieu-khien-transaction-trong-pl-sql" tabindex="-1"><a class="header-anchor" href="#üîπ-cac-lenh-ƒëieu-khien-transaction-trong-pl-sql"><span>üîπ C√°c l·ªánh ƒëi·ªÅu khi·ªÉn Transaction trong PL/SQL</span></a></h3><table><thead><tr><th style="text-align:center;">L·ªánh</th><th style="text-align:center;">Ch·ª©c nƒÉng</th></tr></thead><tbody><tr><td style="text-align:center;">COMMIT</td><td style="text-align:center;">X√°c nh·∫≠n transaction, l∆∞u thay ƒë·ªïi v√†o DB</td></tr><tr><td style="text-align:center;">ROLLBACK</td><td style="text-align:center;">H·ªßy b·ªè transaction, kh√¥i ph·ª•c tr·∫°ng th√°i tr∆∞·ªõc ƒë√≥</td></tr><tr><td style="text-align:center;">SAVEPOINT</td><td style="text-align:center;">ƒê√°nh d·∫•u m·ªôt ƒëi·ªÉm ƒë·ªÉ rollback m·ªôt ph·∫ßn transaction</td></tr></tbody></table><h3 id="üîπ-commit-‚Äì-luu-thay-ƒëoi-vinh-vien" tabindex="-1"><a class="header-anchor" href="#üîπ-commit-‚Äì-luu-thay-ƒëoi-vinh-vien"><span>üîπ COMMIT ‚Äì L∆∞u thay ƒë·ªïi vƒ©nh vi·ªÖn</span></a></h3><p>Sau khi COMMIT, d·ªØ li·ªáu kh√¥ng th·ªÉ rollback l·∫°i.</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.1</span> <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">COMMIT</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="üîπ-rollback-‚Äì-huy-bo-transaction" tabindex="-1"><a class="header-anchor" href="#üîπ-rollback-‚Äì-huy-bo-transaction"><span>üîπ ROLLBACK ‚Äì H·ªßy b·ªè Transaction</span></a></h3><p>N·∫øu c√≥ l·ªói, ROLLBACK s·∫Ω ho√†n t√°c m·ªçi thay ƒë·ªïi v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu.</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.2</span> <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">-- C√≥ l·ªói x·∫£y ra</span></span>
<span class="line">    <span class="token keyword">IF</span> some_error <span class="token keyword">THEN</span></span>
<span class="line">        <span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span> <span class="token comment">-- H·ªßy to√†n b·ªô thay ƒë·ªïi</span></span>
<span class="line">    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="üîπ-savepoint-‚Äì-rollback-tung-phan" tabindex="-1"><a class="header-anchor" href="#üîπ-savepoint-‚Äì-rollback-tung-phan"><span>üîπ SAVEPOINT ‚Äì Rollback t·ª´ng ph·∫ßn</span></a></h3><p>SAVEPOINT gi√∫p rollback m·ªôt ph·∫ßn transaction thay v√¨ rollback to√†n b·ªô.</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token comment">-- C·∫≠p nh·∫≠t l·∫ßn 1</span></span>
<span class="line">    <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.1</span> <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">SAVEPOINT</span> sp1<span class="token punctuation">;</span> <span class="token comment">-- L∆∞u l·∫°i tr·∫°ng th√°i</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">-- C·∫≠p nh·∫≠t l·∫ßn 2</span></span>
<span class="line">    <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.2</span> <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">SAVEPOINT</span> sp2<span class="token punctuation">;</span> <span class="token comment">-- L∆∞u l·∫°i tr·∫°ng th√°i</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">-- N·∫øu c√≥ l·ªói, rollback v·ªÅ ƒëi·ªÉm sp1 (gi·ªØ l·∫°i c·∫≠p nh·∫≠t l·∫ßn 1)</span></span>
<span class="line">    <span class="token keyword">ROLLBACK</span> <span class="token keyword">TO</span> sp1<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">-- Commit ph·∫ßn c√≤n l·∫°i</span></span>
<span class="line">    <span class="token keyword">COMMIT</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Sau khi rollback v·ªÅ sp1:</p><p>‚úÖ Thay ƒë·ªïi c·ªßa department_id = 10 v·∫´n gi·ªØ.</p><p>‚ùå Thay ƒë·ªïi c·ªßa department_id = 20 b·ªã h·ªßy.</p><h3 id="üîπ-autocommit-‚Äì-transaction-tu-ƒëong" tabindex="-1"><a class="header-anchor" href="#üîπ-autocommit-‚Äì-transaction-tu-ƒëong"><span>üîπ AUTOCOMMIT ‚Äì Transaction t·ª± ƒë·ªông</span></a></h3><ul><li><p>Ki·ªÉm tra tr·∫°ng th√°i AUTOCOMMIT:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SHOW</span> AUTOCOMMIT<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>T·∫Øt Autocommit ƒë·ªÉ ki·ªÉm so√°t transaction th·ªß c√¥ng:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SET</span> AUTOCOMMIT <span class="token keyword">OFF</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p><a name="2"></a></p><h2 id="üìå-2-dynamic-sql" tabindex="-1"><a class="header-anchor" href="#üìå-2-dynamic-sql"><span>üìå 2. Dynamic SQL</span></a></h2><p>Dynamic SQL (SQL ƒë·ªông) l√† k·ªπ thu·∫≠t cho ph√©p x√¢y d·ª±ng v√† th·ª±c thi c√¢u l·ªánh SQL m·ªôt c√°ch linh ho·∫°t t·∫°i th·ªùi ƒëi·ªÉm ch·∫°y (runtime) thay v√¨ vi·∫øt c·ªë ƒë·ªãnh trong m√£ ngu·ªìn.</p><p>C·∫ßn Dynamic SQL khi:</p><ul><li>C√¢u l·ªánh SQL thay ƒë·ªïi linh ho·∫°t theo d·ªØ li·ªáu ƒë·∫ßu v√†o.</li><li>T√™n b·∫£ng, c·ªôt, ƒëi·ªÅu ki·ªán WHERE kh√¥ng th·ªÉ x√°c ƒë·ªãnh tr∆∞·ªõc.</li><li>C·∫ßn th·ª±c thi DDL (CREATE, DROP, ALTER) trong PL/SQL.</li><li>C·∫ßn g·ªçi stored procedure v·ªõi tham s·ªë ƒë·ªông.</li></ul><h3 id="üîπ-cach-thuc-hien-dynamic-sql" tabindex="-1"><a class="header-anchor" href="#üîπ-cach-thuc-hien-dynamic-sql"><span>üîπ C√°ch th·ª±c hi·ªán Dynamic SQL</span></a></h3><p>PL/SQL cung c·∫•p hai c√°ch ch√≠nh ƒë·ªÉ th·ª±c thi Dynamic SQL:</p><table><thead><tr><th style="text-align:center;">C√°ch</th><th style="text-align:center;">Khi n√†o d√πng?</th></tr></thead><tbody><tr><td style="text-align:center;">EXECUTE IMMEDIATE</td><td style="text-align:center;">Khi c√¢u l·ªánh ch·ªâ ch·∫°y m·ªôt l·∫ßn</td></tr><tr><td style="text-align:center;">OPEN FOR ... USING</td><td style="text-align:center;">Khi c·∫ßn fetch nhi·ªÅu d√≤ng d·ªØ li·ªáu (d√πng v·ªõi CURSOR)</td></tr></tbody></table><h3 id="üîπ-execute-immediate-‚Äì-cach-ƒëon-gian-nhat" tabindex="-1"><a class="header-anchor" href="#üîπ-execute-immediate-‚Äì-cach-ƒëon-gian-nhat"><span>üîπ EXECUTE IMMEDIATE ‚Äì C√°ch ƒë∆°n gi·∫£n nh·∫•t</span></a></h3><p>D√πng ƒë·ªÉ th·ª±c thi c√°c c√¢u l·ªánh SELECT, INSERT, UPDATE, DELETE, DDL.</p><p>üîç V√≠ d·ª• SELECT ƒë·ªông:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    v_table_name VARCHAR2<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> :<span class="token operator">=</span> <span class="token string">&#39;employees&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    v_count NUMBER<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token keyword">EXECUTE</span> IMMEDIATE <span class="token string">&#39;SELECT COUNT(*) FROM &#39;</span> <span class="token operator">||</span> v_table_name <span class="token keyword">INTO</span> v_count<span class="token punctuation">;</span></span>
<span class="line">    DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;Total rows: &#39;</span> <span class="token operator">||</span> v_count<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>üîç V√≠ d·ª• d√πng USING ƒë·ªÉ truy·ªÅn tham s·ªë:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    v_sql VARCHAR2<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    v_salary NUMBER :<span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    v_sql :<span class="token operator">=</span> <span class="token string">&#39;UPDATE employees SET salary = salary + 100 WHERE salary &gt; :min_salary&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">EXECUTE</span> IMMEDIATE v_sql <span class="token keyword">USING</span> v_salary<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">COMMIT</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="üîπ-open-for-using-‚Äì-dynamic-cursor" tabindex="-1"><a class="header-anchor" href="#üîπ-open-for-using-‚Äì-dynamic-cursor"><span>üîπ OPEN FOR ... USING ‚Äì Dynamic Cursor</span></a></h3><p>üîç V√≠ d·ª• Fetch d·ªØ li·ªáu ƒë·ªông v·ªõi CURSOR:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    v_cursor SYS_REFCURSOR<span class="token punctuation">;</span></span>
<span class="line">    v_table_name VARCHAR2<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> :<span class="token operator">=</span> <span class="token string">&#39;employees&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    v_emp_name employees<span class="token punctuation">.</span>last_name<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token comment">-- M·ªü cursor v·ªõi b·∫£ng ƒë·ªông</span></span>
<span class="line">    <span class="token keyword">OPEN</span> v_cursor <span class="token keyword">FOR</span> <span class="token string">&#39;SELECT last_name FROM &#39;</span> <span class="token operator">||</span> v_table_name<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">LOOP</span></span>
<span class="line">        <span class="token keyword">FETCH</span> v_cursor <span class="token keyword">INTO</span> v_emp_name<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">EXIT</span> <span class="token keyword">WHEN</span> v_cursor<span class="token operator">%</span>NOTFOUND<span class="token punctuation">;</span></span>
<span class="line">        DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;Employee: &#39;</span> <span class="token operator">||</span> v_emp_name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">END</span> <span class="token keyword">LOOP</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">CLOSE</span> v_cursor<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a name="3"></a></p><h2 id="üìå-3-collection-va-record-trong-pl-sql" tabindex="-1"><a class="header-anchor" href="#üìå-3-collection-va-record-trong-pl-sql"><span>üìå 3. Collection v√† Record trong PL/SQL</span></a></h2><p>Collection trong PL/SQL l√† m·ªôt c·∫•u tr√∫c d·ªØ li·ªáu ch·ª©a nhi·ªÅu ph·∫ßn t·ª≠ c√πng ki·ªÉu d·ªØ li·ªáu, t∆∞∆°ng t·ª± nh∆∞ m·∫£ng trong c√°c ng√¥n ng·ªØ l·∫≠p tr√¨nh kh√°c.</p><p>PL/SQL h·ªó tr·ª£ 3 lo·∫°i Collection ch√≠nh:</p><table><thead><tr><th style="text-align:center;">Lo·∫°i Collection</th><th style="text-align:center;">Khi n√†o d√πng?</th><th style="text-align:center;">ƒê·∫∑c ƒëi·ªÉm</th></tr></thead><tbody><tr><td style="text-align:center;">VARRAY</td><td style="text-align:center;">Khi s·ªë ph·∫ßn t·ª≠ c·ªë ƒë·ªãnh</td><td style="text-align:center;">Ch·ªâ ƒë·ªãnh s·ªë l∆∞·ª£ng t·ªëi ƒëa; L∆∞u trong m·ªôt c·ªôt c·ªßa b·∫£ng</td></tr><tr><td style="text-align:center;">Nested Table</td><td style="text-align:center;">Khi c·∫ßn danh s√°ch ƒë·ªông</td><td style="text-align:center;">Kh√¥ng gi·ªõi h·∫°n ph·∫ßn t·ª≠; C√≥ th·ªÉ l∆∞u v√†o b·∫£ng d∆∞·ªõi d·∫°ng c·ªôt</td></tr><tr><td style="text-align:center;">Associative Array (Index-by Table)</td><td style="text-align:center;">Khi c·∫ßn truy xu·∫•t theo key</td><td style="text-align:center;">Key c√≥ th·ªÉ l√† s·ªë ho·∫∑c chu·ªói; Kh√¥ng l∆∞u trong DB</td></tr></tbody></table><h3 id="üîπ-varray-‚Äì-mang-co-ƒëinh-so-phan-tu" tabindex="-1"><a class="header-anchor" href="#üîπ-varray-‚Äì-mang-co-ƒëinh-so-phan-tu"><span>üîπ VARRAY ‚Äì M·∫£ng c·ªë ƒë·ªãnh s·ªë ph·∫ßn t·ª≠</span></a></h3><p>Khai b√°o v√† s·ª≠ d·ª•ng:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_varray <span class="token operator">IS</span> VARRAY<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">OF</span> VARCHAR2<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    v_departments t_varray :<span class="token operator">=</span> t_varray<span class="token punctuation">(</span><span class="token string">&#39;HR&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;IT&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Finance&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;First department: &#39;</span> <span class="token operator">||</span> v_departments<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="üîπ-nested-table-‚Äì-mang-ƒëong" tabindex="-1"><a class="header-anchor" href="#üîπ-nested-table-‚Äì-mang-ƒëong"><span>üîπ Nested Table ‚Äì M·∫£ng ƒë·ªông</span></a></h3><p>Khai b√°o v√† s·ª≠ d·ª•ng:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_table <span class="token operator">IS</span> <span class="token keyword">TABLE</span> <span class="token keyword">OF</span> VARCHAR2<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    v_employees t_table :<span class="token operator">=</span> t_table<span class="token punctuation">(</span><span class="token string">&#39;John&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Alice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Bob&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    v_employees<span class="token punctuation">.</span>EXTEND<span class="token punctuation">;</span> <span class="token comment">-- M·ªü r·ªông s·ªë ph·∫ßn t·ª≠</span></span>
<span class="line">    v_employees<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> :<span class="token operator">=</span> <span class="token string">&#39;David&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">FOR</span> i <span class="token operator">IN</span> <span class="token number">1.</span><span class="token punctuation">.</span>v_employees<span class="token punctuation">.</span>COUNT <span class="token keyword">LOOP</span></span>
<span class="line">        DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;Employee: &#39;</span> <span class="token operator">||</span> v_employees<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">END</span> <span class="token keyword">LOOP</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="üîπ-associative-array-‚Äì-truy-xuat-theo-key" tabindex="-1"><a class="header-anchor" href="#üîπ-associative-array-‚Äì-truy-xuat-theo-key"><span>üîπ Associative Array ‚Äì Truy xu·∫•t theo Key</span></a></h3><p>Khai b√°o v√† s·ª≠ d·ª•ng:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_assoc <span class="token operator">IS</span> <span class="token keyword">TABLE</span> <span class="token keyword">OF</span> VARCHAR2<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">INDEX</span> <span class="token keyword">BY</span> VARCHAR2<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    v_employees t_assoc<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    v_employees<span class="token punctuation">(</span><span class="token string">&#39;E001&#39;</span><span class="token punctuation">)</span> :<span class="token operator">=</span> <span class="token string">&#39;John&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    v_employees<span class="token punctuation">(</span><span class="token string">&#39;E002&#39;</span><span class="token punctuation">)</span> :<span class="token operator">=</span> <span class="token string">&#39;Alice&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;Employee E001: &#39;</span> <span class="token operator">||</span> v_employees<span class="token punctuation">(</span><span class="token string">&#39;E001&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="üîπ-record" tabindex="-1"><a class="header-anchor" href="#üîπ-record"><span>üîπ RECORD</span></a></h3><p>Record gi√∫p nh√≥m nhi·ªÅu tr∆∞·ªùng d·ªØ li·ªáu v√†o m·ªôt bi·∫øn duy nh·∫•t.</p><p>Khai b√°o v√† s·ª≠ d·ª•ng:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_employee <span class="token operator">IS</span> RECORD <span class="token punctuation">(</span></span>
<span class="line">        emp_id NUMBER<span class="token punctuation">,</span></span>
<span class="line">        emp_name VARCHAR2<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        salary NUMBER</span>
<span class="line">    <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    v_emp t_employee<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    v_emp<span class="token punctuation">.</span>emp_id :<span class="token operator">=</span> <span class="token number">1001</span><span class="token punctuation">;</span></span>
<span class="line">    v_emp<span class="token punctuation">.</span>emp_name :<span class="token operator">=</span> <span class="token string">&#39;John Doe&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    v_emp<span class="token punctuation">.</span>salary :<span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span><span class="token string">&#39;Employee: &#39;</span> <span class="token operator">||</span> v_emp<span class="token punctuation">.</span>emp_name <span class="token operator">||</span> <span class="token string">&#39; - Salary: &#39;</span> <span class="token operator">||</span> v_emp<span class="token punctuation">.</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="üîπ-record-voi-cursor-‚Äì-fetch-nhieu-dong" tabindex="-1"><a class="header-anchor" href="#üîπ-record-voi-cursor-‚Äì-fetch-nhieu-dong"><span>üîπ RECORD v·ªõi CURSOR ‚Äì Fetch nhi·ªÅu d√≤ng</span></a></h3><p>C√≥ th·ªÉ d√πng RECORD ƒë·ªÉ ch·ª©a t·ª´ng d√≤ng d·ªØ li·ªáu:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_employee <span class="token operator">IS</span> RECORD <span class="token punctuation">(</span></span>
<span class="line">        emp_id employees<span class="token punctuation">.</span>employee_id<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">,</span></span>
<span class="line">        emp_name employees<span class="token punctuation">.</span>last_name<span class="token operator">%</span><span class="token keyword">TYPE</span></span>
<span class="line">    <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    v_emp t_employee<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">CURSOR</span> c_emp <span class="token operator">IS</span> <span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span> last_name <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> ROWNUM <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token keyword">OPEN</span> c_emp<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">LOOP</span></span>
<span class="line">        <span class="token keyword">FETCH</span> c_emp <span class="token keyword">INTO</span> v_emp<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">EXIT</span> <span class="token keyword">WHEN</span> c_emp<span class="token operator">%</span>NOTFOUND<span class="token punctuation">;</span></span>
<span class="line">        DBMS_OUTPUT<span class="token punctuation">.</span>PUT_LINE<span class="token punctuation">(</span>v_emp<span class="token punctuation">.</span>emp_id <span class="token operator">||</span> <span class="token string">&#39; - &#39;</span> <span class="token operator">||</span> v_emp<span class="token punctuation">.</span>emp_name<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">END</span> <span class="token keyword">LOOP</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">CLOSE</span> c_emp<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a name="4"></a></p><h2 id="üìå-4-bulk-processing-trong-pl-sql" tabindex="-1"><a class="header-anchor" href="#üìå-4-bulk-processing-trong-pl-sql"><span>üìå 4. Bulk Processing trong PL/SQL</span></a></h2><p>Bulk Processing gi√∫p x·ª≠ l√Ω nhi·ªÅu d√≤ng d·ªØ li·ªáu c√πng l√∫c, gi·∫£m s·ªë l·∫ßn t∆∞∆°ng t√°c v·ªõi SQL Engine, gi√∫p tƒÉng hi·ªáu su·∫•t ƒë√°ng k·ªÉ so v·ªõi c√°ch x·ª≠ l√Ω t·ª´ng d√≤ng ri√™ng l·∫ª.</p><p>PL/SQL cung c·∫•p 2 c∆° ch·∫ø ch√≠nh:</p><ul><li>BULK COLLECT ‚Üí L·∫•y nhi·ªÅu d√≤ng d·ªØ li·ªáu v√†o Collection c√πng l√∫c</li><li>FORALL ‚Üí Ch√®n, c·∫≠p nh·∫≠t, x√≥a nhi·ªÅu d√≤ng d·ªØ li·ªáu c√πng l√∫c</li></ul><h3 id="üîπ-bulk-collect-‚Äì-lay-nhieu-dong-du-lieu" tabindex="-1"><a class="header-anchor" href="#üîπ-bulk-collect-‚Äì-lay-nhieu-dong-du-lieu"><span>üîπ BULK COLLECT ‚Äì L·∫•y nhi·ªÅu d√≤ng d·ªØ li·ªáu</span></a></h3><p>üí° Thay v√¨ d√πng LOOP ƒë·ªÉ FETCH t·ª´ng d√≤ng:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_emp_list <span class="token operator">IS</span> <span class="token keyword">TABLE</span> <span class="token keyword">OF</span> employees<span class="token operator">%</span>ROWTYPE<span class="token punctuation">;</span></span>
<span class="line">    v_emp_list t_emp_list<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">CURSOR</span> c_emp <span class="token operator">IS</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token keyword">OPEN</span> c_emp<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">LOOP</span></span>
<span class="line">        <span class="token keyword">FETCH</span> c_emp <span class="token keyword">INTO</span> v_emp_list<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">EXIT</span> <span class="token keyword">WHEN</span> c_emp<span class="token operator">%</span>NOTFOUND<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">END</span> <span class="token keyword">LOOP</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">CLOSE</span> c_emp<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>üí° C√≥ th·ªÉ d√πng BULK COLLECT ƒë·ªÉ l·∫•y to√†n b·ªô d·ªØ li·ªáu m·ªôt l·∫ßn:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_emp_list <span class="token operator">IS</span> <span class="token keyword">TABLE</span> <span class="token keyword">OF</span> employees<span class="token operator">%</span>ROWTYPE<span class="token punctuation">;</span></span>
<span class="line">    v_emp_list t_emp_list<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">BULK</span> COLLECT <span class="token keyword">INTO</span> v_emp_list <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>‚úÖ L·ª£i √≠ch c·ªßa BULK COLLECT:</p><ul><li>Gi·∫£m s·ªë l·∫ßn g·ªçi FETCH</li><li>Nhanh h∆°n g·∫•p nhi·ªÅu l·∫ßn khi x·ª≠ l√Ω s·ªë l∆∞·ª£ng l·ªõn d·ªØ li·ªáu</li><li>C√≥ th·ªÉ k·∫øt h·ª£p v·ªõi LIMIT ƒë·ªÉ tr√°nh qu√° t·∫£i b·ªô nh·ªõ (xem v√≠ d·ª• b√™n d∆∞·ªõi)</li></ul><h3 id="üîπ-forall-‚Äì-chen-cap-nhat-xoa-hang-loat" tabindex="-1"><a class="header-anchor" href="#üîπ-forall-‚Äì-chen-cap-nhat-xoa-hang-loat"><span>üîπ FORALL ‚Äì Ch√®n, c·∫≠p nh·∫≠t, x√≥a h√†ng lo·∫°t</span></a></h3><p>üí° Thay v√¨ d√πng v√≤ng FOR ƒë·ªÉ INSERT/UPDATE/DELETE t·ª´ng d√≤ng:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_emp_id_list <span class="token operator">IS</span> <span class="token keyword">TABLE</span> <span class="token keyword">OF</span> employees<span class="token punctuation">.</span>employee_id<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">;</span></span>
<span class="line">    v_emp_id_list t_emp_id_list :<span class="token operator">=</span> t_emp_id_list<span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token keyword">FOR</span> i <span class="token operator">IN</span> <span class="token number">1.</span><span class="token punctuation">.</span>v_emp_id_list<span class="token punctuation">.</span>COUNT <span class="token keyword">LOOP</span></span>
<span class="line">        <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.1</span> <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> v_emp_id_list<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">END</span> <span class="token keyword">LOOP</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>üí° C√≥ th·ªÉ d√πng FORALL ƒë·ªÉ th·ª±c hi·ªán nhi·ªÅu d√≤ng m·ªôt l·∫ßn:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_emp_id_list <span class="token operator">IS</span> <span class="token keyword">TABLE</span> <span class="token keyword">OF</span> employees<span class="token punctuation">.</span>employee_id<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">;</span></span>
<span class="line">    v_emp_id_list t_emp_id_list :<span class="token operator">=</span> t_emp_id_list<span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    FORALL i <span class="token operator">IN</span> <span class="token number">1.</span><span class="token punctuation">.</span>v_emp_id_list<span class="token punctuation">.</span>COUNT</span>
<span class="line">        <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.1</span> <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> v_emp_id_list<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="üîπ-ket-hop-bulk-collect-forall" tabindex="-1"><a class="header-anchor" href="#üîπ-ket-hop-bulk-collect-forall"><span>üîπ K·∫øt h·ª£p BULK COLLECT + FORALL</span></a></h3><p>üí° T√≠ch h·ª£p BULK COLLECT ƒë·ªÉ l·∫•y d·ªØ li·ªáu v√† FORALL ƒë·ªÉ x·ª≠ l√Ω h√†ng lo·∫°t:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_emp_id_list <span class="token operator">IS</span> <span class="token keyword">TABLE</span> <span class="token keyword">OF</span> employees<span class="token punctuation">.</span>employee_id<span class="token operator">%</span><span class="token keyword">TYPE</span><span class="token punctuation">;</span></span>
<span class="line">    v_emp_id_list t_emp_id_list<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token comment">-- L·∫•y danh s√°ch employee_id c·ªßa ph√≤ng ban 10</span></span>
<span class="line">    <span class="token keyword">SELECT</span> employee_id <span class="token keyword">BULK</span> COLLECT <span class="token keyword">INTO</span> v_emp_id_list <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">-- C·∫≠p nh·∫≠t l∆∞∆°ng h√†ng lo·∫°t</span></span>
<span class="line">    FORALL i <span class="token operator">IN</span> <span class="token number">1.</span><span class="token punctuation">.</span>v_emp_id_list<span class="token punctuation">.</span>COUNT</span>
<span class="line">        <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.1</span> <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> v_emp_id_list<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="üîπ-dung-bulk-collect-voi-limit" tabindex="-1"><a class="header-anchor" href="#üîπ-dung-bulk-collect-voi-limit"><span>üîπ D√πng BULK COLLECT v·ªõi LIMIT</span></a></h3><p>N·∫øu d·ªØ li·ªáu qu√° l·ªõn, c√≥ th·ªÉ d√πng LIMIT ƒë·ªÉ chia nh·ªè c√°c l·∫ßn l·∫•y d·ªØ li·ªáu.</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">DECLARE</span></span>
<span class="line">    <span class="token keyword">TYPE</span> t_emp_list <span class="token operator">IS</span> <span class="token keyword">TABLE</span> <span class="token keyword">OF</span> employees<span class="token operator">%</span>ROWTYPE<span class="token punctuation">;</span></span>
<span class="line">    v_emp_list t_emp_list<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">CURSOR</span> c_emp <span class="token operator">IS</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">BEGIN</span></span>
<span class="line">    <span class="token keyword">OPEN</span> c_emp<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">LOOP</span></span>
<span class="line">        <span class="token keyword">FETCH</span> c_emp <span class="token keyword">BULK</span> COLLECT <span class="token keyword">INTO</span> v_emp_list <span class="token keyword">LIMIT</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">-- L·∫•y 100 d√≤ng m·ªói l·∫ßn</span></span>
<span class="line">        <span class="token keyword">EXIT</span> <span class="token keyword">WHEN</span> v_emp_list<span class="token punctuation">.</span>COUNT <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        FORALL i <span class="token operator">IN</span> <span class="token number">1.</span><span class="token punctuation">.</span>v_emp_list<span class="token punctuation">.</span>COUNT</span>
<span class="line">            <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.1</span> <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> v_emp_list<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">END</span> <span class="token keyword">LOOP</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">CLOSE</span> c_emp<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">END</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,87)]))}const o=s(l,[["render",t],["__file","oracle-plsql-advanced.html.vue"]]),r=JSON.parse('{"path":"/blog-posts/back-end/oracle-plsql-advanced.html","title":"PL/SQL n√¢ng cao","lang":"en-US","frontmatter":{"title":"PL/SQL n√¢ng cao","summary":"Ti·∫øp c·∫≠n v√† khai th√°c s·ª©c m·∫°nh th·ª±c s·ª± c·ªßa PL/SQL trong c√°c h·ªá th·ªëng c∆° s·ªü d·ªØ li·ªáu ph·ª©c t·∫°p v√† hi·ªáu nƒÉng cao.","date":"2025-06-14","image":"/vuepress-blog/images/posts/plsql.png","category":"BACK-END"},"headers":[{"level":2,"title":"üìå 1. Transactions trong PL/SQL","slug":"üìå-1-transactions-trong-pl-sql","link":"#üìå-1-transactions-trong-pl-sql","children":[{"level":3,"title":"üîπ C√°c l·ªánh ƒëi·ªÅu khi·ªÉn Transaction trong PL/SQL","slug":"üîπ-cac-lenh-ƒëieu-khien-transaction-trong-pl-sql","link":"#üîπ-cac-lenh-ƒëieu-khien-transaction-trong-pl-sql","children":[]},{"level":3,"title":"üîπ COMMIT ‚Äì L∆∞u thay ƒë·ªïi vƒ©nh vi·ªÖn","slug":"üîπ-commit-‚Äì-luu-thay-ƒëoi-vinh-vien","link":"#üîπ-commit-‚Äì-luu-thay-ƒëoi-vinh-vien","children":[]},{"level":3,"title":"üîπ ROLLBACK ‚Äì H·ªßy b·ªè Transaction","slug":"üîπ-rollback-‚Äì-huy-bo-transaction","link":"#üîπ-rollback-‚Äì-huy-bo-transaction","children":[]},{"level":3,"title":"üîπ SAVEPOINT ‚Äì Rollback t·ª´ng ph·∫ßn","slug":"üîπ-savepoint-‚Äì-rollback-tung-phan","link":"#üîπ-savepoint-‚Äì-rollback-tung-phan","children":[]},{"level":3,"title":"üîπ AUTOCOMMIT ‚Äì Transaction t·ª± ƒë·ªông","slug":"üîπ-autocommit-‚Äì-transaction-tu-ƒëong","link":"#üîπ-autocommit-‚Äì-transaction-tu-ƒëong","children":[]}]},{"level":2,"title":"üìå 2. Dynamic SQL","slug":"üìå-2-dynamic-sql","link":"#üìå-2-dynamic-sql","children":[{"level":3,"title":"üîπ C√°ch th·ª±c hi·ªán Dynamic SQL","slug":"üîπ-cach-thuc-hien-dynamic-sql","link":"#üîπ-cach-thuc-hien-dynamic-sql","children":[]},{"level":3,"title":"üîπ EXECUTE IMMEDIATE ‚Äì C√°ch ƒë∆°n gi·∫£n nh·∫•t","slug":"üîπ-execute-immediate-‚Äì-cach-ƒëon-gian-nhat","link":"#üîπ-execute-immediate-‚Äì-cach-ƒëon-gian-nhat","children":[]},{"level":3,"title":"üîπ OPEN FOR ... USING ‚Äì Dynamic Cursor","slug":"üîπ-open-for-using-‚Äì-dynamic-cursor","link":"#üîπ-open-for-using-‚Äì-dynamic-cursor","children":[]}]},{"level":2,"title":"üìå 3. Collection v√† Record trong PL/SQL","slug":"üìå-3-collection-va-record-trong-pl-sql","link":"#üìå-3-collection-va-record-trong-pl-sql","children":[{"level":3,"title":"üîπ VARRAY ‚Äì M·∫£ng c·ªë ƒë·ªãnh s·ªë ph·∫ßn t·ª≠","slug":"üîπ-varray-‚Äì-mang-co-ƒëinh-so-phan-tu","link":"#üîπ-varray-‚Äì-mang-co-ƒëinh-so-phan-tu","children":[]},{"level":3,"title":"üîπ Nested Table ‚Äì M·∫£ng ƒë·ªông","slug":"üîπ-nested-table-‚Äì-mang-ƒëong","link":"#üîπ-nested-table-‚Äì-mang-ƒëong","children":[]},{"level":3,"title":"üîπ Associative Array ‚Äì Truy xu·∫•t theo Key","slug":"üîπ-associative-array-‚Äì-truy-xuat-theo-key","link":"#üîπ-associative-array-‚Äì-truy-xuat-theo-key","children":[]},{"level":3,"title":"üîπ RECORD","slug":"üîπ-record","link":"#üîπ-record","children":[]},{"level":3,"title":"üîπ RECORD v·ªõi CURSOR ‚Äì Fetch nhi·ªÅu d√≤ng","slug":"üîπ-record-voi-cursor-‚Äì-fetch-nhieu-dong","link":"#üîπ-record-voi-cursor-‚Äì-fetch-nhieu-dong","children":[]}]},{"level":2,"title":"üìå 4. Bulk Processing trong PL/SQL","slug":"üìå-4-bulk-processing-trong-pl-sql","link":"#üìå-4-bulk-processing-trong-pl-sql","children":[{"level":3,"title":"üîπ BULK COLLECT ‚Äì L·∫•y nhi·ªÅu d√≤ng d·ªØ li·ªáu","slug":"üîπ-bulk-collect-‚Äì-lay-nhieu-dong-du-lieu","link":"#üîπ-bulk-collect-‚Äì-lay-nhieu-dong-du-lieu","children":[]},{"level":3,"title":"üîπ FORALL ‚Äì Ch√®n, c·∫≠p nh·∫≠t, x√≥a h√†ng lo·∫°t","slug":"üîπ-forall-‚Äì-chen-cap-nhat-xoa-hang-loat","link":"#üîπ-forall-‚Äì-chen-cap-nhat-xoa-hang-loat","children":[]},{"level":3,"title":"üîπ K·∫øt h·ª£p BULK COLLECT + FORALL","slug":"üîπ-ket-hop-bulk-collect-forall","link":"#üîπ-ket-hop-bulk-collect-forall","children":[]},{"level":3,"title":"üîπ D√πng BULK COLLECT v·ªõi LIMIT","slug":"üîπ-dung-bulk-collect-voi-limit","link":"#üîπ-dung-bulk-collect-voi-limit","children":[]}]}],"git":{},"filePathRelative":"blog-posts/back-end/oracle-plsql-advanced.md"}');export{o as comp,r as data};
