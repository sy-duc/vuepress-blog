import{_ as s}from"./ai-pytorch-CX6UVv0D.js";import{_ as a,c as t,d as p,o as e}from"./app-H7UPTZlK.js";const l={};function i(c,n){return e(),t("div",null,n[0]||(n[0]=[p('<h1 id="thuc-hanh-deep-learning-voi-pytorch" tabindex="-1"><a class="header-anchor" href="#thuc-hanh-deep-learning-voi-pytorch"><span>Thá»±c hÃ nh Deep Learning vá»›i PyTorch</span></a></h1><p><img src="'+s+`" alt="PyTorch"></p><p>Sau khi tÃ¬m hiá»ƒu lÃ½ thuyáº¿t ná»n táº£ng AI vÃ  PyTorch, bÆ°á»›c tiáº¿p theo lÃ  lÃ m bÃ i toÃ¡n á»©ng dá»¥ng thá»±c táº¿.</p><p>Tuy nhiÃªn, chÃºng ta váº«n sáº½ giá»¯ Ä‘Ãºng hÆ°á»›ng Ä‘i ban Ä‘áº§u lÃ  khÃ´ng thuáº§n nghiÃªn cá»©u, mÃ  lÃ  xÃ¢y há»‡ thá»‘ng AI dÃ¹ng Ä‘Æ°á»£c.</p><p><a href="#1">1. Setup mÃ´i trÆ°á»ng PyTorch</a></p><p><a href="#2">2. BÃ i toÃ¡n Dá»± Ä‘oÃ¡n giÃ¡ nhÃ </a></p><p><a href="#3">3. BÃ i toÃ¡n Giao dá»‹ch bÃ¬nh thÆ°á»ng / báº¥t thÆ°á»ng</a></p><p><a name="1"></a></p><h2 id="ğŸ“Œ-1-setup-moi-truong-pytorch" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-1-setup-moi-truong-pytorch"><span>ğŸ“Œ 1. Setup mÃ´i trÆ°á»ng PyTorch</span></a></h2><ul><li><p>âŒ DÃ¹ng Google Colab hay Jupyter local chá»‰ phÃ¹ há»£p cho lÃºc há»c PyTorch, test, demo &amp; research, hay khi cáº§n GPU táº¡m mÃ  mÃ¡y local khÃ´ng cÃ³.</p></li><li><p>âœ”ï¸ Recommend má»i ngÆ°á»i dÃ¹ng VS Code + venv (mÃ´i trÆ°á»ng áº£o) luÃ´n bá»Ÿi:</p><ul><li>âœ§ Giá»‘ng mÃ´i trÆ°á»ng thá»±c táº¿</li><li>âœ§ Dá»… deploy</li><li>âœ§ Dá»… Ä‘Ã³ng gÃ³i .exe</li><li>âœ§ Dá»… debug</li><li>âœ§ Quáº£n lÃ½ code rÃµ rÃ ng</li></ul></li></ul><h3 id="âš™ï¸-setup" tabindex="-1"><a class="header-anchor" href="#âš™ï¸-setup"><span>âš™ï¸ Setup</span></a></h3><ul><li><p>â¶ CÃ i Python chÃ­nh thá»©c</p></li><li><p>â· Táº¡o folder project</p></li><li><p>â¸ Táº¡o mÃ´i trÆ°á»ng áº£o</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">python <span class="token parameter variable">-m</span> venv venv</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>â¹ Active mÃ´i trÆ°á»ng áº£o</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">venv<span class="token punctuation">\\</span>Scripts<span class="token punctuation">\\</span>activate</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>âº CÃ i PyTorch</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">pip <span class="token function">install</span> torch torchvision torchaudio</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>á» Ä‘Ã¢y chÃºng ta dÃ¹ng CPU lÃ  Ä‘á»§, chÆ°a cáº§n GPU.</li></ul></li><li><p>â» VS Code setup</p><ul><li>âœ§ Má»Ÿ project trÃªn VS Code</li><li>âœ§ Chá»n Python Interpreter â†’ venv</li><li>âœ§ CÃ i extension: Python, Pylance</li></ul></li></ul><p><a name="2"></a></p><h2 id="ğŸ“Œ-2-bai-toan-ai-du-Ä‘oan-Ä‘on-gian-linear-regression" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-2-bai-toan-ai-du-Ä‘oan-Ä‘on-gian-linear-regression"><span>ğŸ“Œ 2. BÃ i toÃ¡n AI dá»± Ä‘oÃ¡n Ä‘Æ¡n giáº£n (Linear Regression)</span></a></h2><ul><li>BÃ i toÃ¡n kinh Ä‘iá»ƒn: Dá»± Ä‘oÃ¡n giÃ¡ nhÃ </li></ul><h3 id="_1ï¸âƒ£-phan-tich-bai-toan" tabindex="-1"><a class="header-anchor" href="#_1ï¸âƒ£-phan-tich-bai-toan"><span>1ï¸âƒ£ PhÃ¢n tÃ­ch bÃ i toÃ¡n</span></a></h3><ul><li><p>Input: Ä‘áº·c trÆ°ng ngÃ´i nhÃ </p></li><li><p>Output: giÃ¡ nhÃ  (sá»‘ thá»±c)</p></li><li><p>ğŸ‘‰ AI sáº½ pháº£i há»c xu hÆ°á»›ng tá»« dá»¯ liá»‡u:</p><ul><li><strong>â€œVá»›i cÃ¡c Ä‘áº·c trÆ°ng nÃ y, giÃ¡ thÆ°á»ng náº±m á»Ÿ khoáº£ng nÃ o?â€</strong></li></ul></li></ul><h3 id="_2ï¸âƒ£-du-lieu-gia-lap" tabindex="-1"><a class="header-anchor" href="#_2ï¸âƒ£-du-lieu-gia-lap"><span>2ï¸âƒ£ Dá»¯ liá»‡u giáº£ láº­p</span></a></h3><ul><li><p>ChÃºng ta táº¡o dataset Ä‘Æ¡n giáº£n nhÆ°ng thá»±c táº¿:</p><table><thead><tr><th>Feature</th><th>Ã nghÄ©a</th></tr></thead><tbody><tr><td>area</td><td>Diá»‡n tÃ­ch (mÂ²)</td></tr><tr><td>bedrooms</td><td>Sá»‘ phÃ²ng</td></tr><tr><td>distance</td><td>Khoáº£ng cÃ¡ch tá»›i trung tÃ¢m (km)</td></tr></tbody></table><ul><li>ğŸ‘‰ 3 feature â†’ 1 giÃ¡</li></ul></li></ul><h3 id="_3ï¸âƒ£-structure-project" tabindex="-1"><a class="header-anchor" href="#_3ï¸âƒ£-structure-project"><span>3ï¸âƒ£ Structure project</span></a></h3><ul><li><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">house_price/</span>
<span class="line">â”‚</span>
<span class="line">â”œâ”€ venv/</span>
<span class="line">â”œâ”€ data.py          # Dá»¯ liá»‡u</span>
<span class="line">â”œâ”€ model.py         # Äá»‹nh nghÄ©a Model</span>
<span class="line">â”œâ”€ train.py         # Há»c</span>
<span class="line">â”œâ”€ predict.py       # Dá»± Ä‘oÃ¡n</span>
<span class="line">â””â”€ requirements.txt</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Tham kháº£o source <a href="https://github.com/sy-duc/house_price_ai" target="_blank" rel="noopener noreferrer">táº¡i Ä‘Ã¢y</a>.</p></li></ul><h3 id="_4ï¸âƒ£-import-tao-du-lieu" tabindex="-1"><a class="header-anchor" href="#_4ï¸âƒ£-import-tao-du-lieu"><span>4ï¸âƒ£ Import &amp; táº¡o dá»¯ liá»‡u</span></a></h3><h4 id="â¶-tao-du-lieu" tabindex="-1"><a class="header-anchor" href="#â¶-tao-du-lieu"><span>â¶ Táº¡o dá»¯ liá»‡u</span></a></h4><ul><li><p>Äá»ƒ hiá»ƒu PyTorch, chÃºng ta thÆ°á»ng sáº½ táº¡o dá»¯ liá»‡u giáº£ láº­p Ä‘á»ƒ dá»… kiá»ƒm soÃ¡t hoÃ n toÃ n logic, trÃ¡nh rá»‘i bá»Ÿi preprocessing sá»›m.</p><ul><li>ğŸ‘‰ Khi hiá»ƒu rá»“i sáº½ thay báº±ng dá»¯ liá»‡u tháº­t (CSV, DB, API).</li></ul></li><li><p><code>data.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">generate_house_data</span><span class="token punctuation">(</span>num_samples<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;</span>
<span class="line">    Táº¡o dá»¯ liá»‡u giáº£ láº­p cho bÃ i toÃ¡n dá»± Ä‘oÃ¡n giÃ¡ nhÃ </span>
<span class="line">    Gá»“m 1000 máº«u dá»¯ liá»‡u</span>
<span class="line">    Trong thá»±c táº¿, hÃ m nÃ y sáº½ lÃ  load CSV / query DB / call API</span>
<span class="line">    &quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Giá»¯ cho dá»¯ liá»‡u random luÃ´n giá»‘ng nhau má»—i láº§n cháº¡y code</span></span>
<span class="line">    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>  <span class="token comment"># 42 khÃ´ng cÃ³ Ã½ nghÄ©a ká»¹ thuáº­t Ä‘áº·c biá»‡t â€” nÃ³ lÃ  má»™t â€œcon sá»‘ truyá»n thá»‘ngâ€ trong giá»›i láº­p trÃ¬nh</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Diá»‡n tÃ­ch (mÂ²): sá»‘ thá»±c tá»« 30 -&gt; 200</span></span>
<span class="line">    area <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> num_samples<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># Sá»‘ phÃ²ng ngá»§: sá»‘ nguyÃªn tá»« 1 -&gt; 5</span></span>
<span class="line">    bedrooms <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> num_samples<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># Khoáº£ng cÃ¡ch tá»›i trung tÃ¢m (km): sá»‘ thá»±c tá»« 1 -&gt; 20</span></span>
<span class="line">    distance <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> num_samples<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># CÃ´ng thá»©c giÃ¡ (chá»‰ giáº£ Ä‘á»‹nh Ä‘á»ƒ táº¡o dá»¯ liá»‡u, AI khÃ´ng biáº¿t cÃ´ng thá»©c nÃ y)</span></span>
<span class="line">    price <span class="token operator">=</span> <span class="token punctuation">(</span></span>
<span class="line">        area <span class="token operator">*</span> <span class="token number">5000</span>                               <span class="token comment"># NhÃ  to â†’ giÃ¡ cao</span></span>
<span class="line">        <span class="token operator">+</span> bedrooms <span class="token operator">*</span> <span class="token number">100000</span>                       <span class="token comment"># Nhiá»u phÃ²ng â†’ Ä‘áº¯t</span></span>
<span class="line">        <span class="token operator">-</span> distance <span class="token operator">*</span> <span class="token number">30000</span>                        <span class="token comment"># Xa trung tÃ¢m â†’ ráº»</span></span>
<span class="line">        <span class="token operator">+</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">,</span> num_samples<span class="token punctuation">)</span> <span class="token comment"># Noise (bá»Ÿi thá»±c táº¿ sáº½ khÃ´ng hoÃ n háº£o. KhÃ´ng cÃ³ noise â†’ model há»c quÃ¡ dá»…, khÃ´ng thá»±c táº¿)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Gom feature thÃ nh ma tráº­n X - dáº¡ng AI cÃ³ thá»ƒ dÃ¹ng do AI khÃ´ng hiá»ƒu biáº¿n rá»i ráº¡c</span></span>
<span class="line">    X <span class="token operator">=</span> np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>area<span class="token punctuation">,</span> bedrooms<span class="token punctuation">,</span> distance<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Má»—i dÃ²ng = 1 cÄƒn nhÃ </span></span>
<span class="line">    y <span class="token operator">=</span> price <span class="token comment"># NhÃ£n (giÃ¡ nhÃ )</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> X<span class="token punctuation">,</span> y</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="â·-chuan-hoa-du-lieu-normalize" tabindex="-1"><a class="header-anchor" href="#â·-chuan-hoa-du-lieu-normalize"><span>â· Chuáº©n hÃ³a dá»¯ liá»‡u (Normalize)</span></a></h4><ul><li><p>TÆ°Æ¡ng Ä‘Æ°Æ¡ng bÆ°á»›c tiá»n xá»­ lÃ½ (preprocessing).</p></li><li><p>VÃ­ dá»¥:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Area (mÂ²):      [50, 120, 200]</span>
<span class="line">Bedrooms:      [1, 3, 5]</span>
<span class="line">Distance (km): [2, 10, 18]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ğŸ‘‰ Scale khÃ¡c nhau ráº¥t lá»›n, Gradient há»c: <ul><li>âœ§ Area Ã¡p Ä‘áº£o</li><li>âœ§ Bedrooms gáº§n nhÆ° bá»‹ â€œbá» quaâ€</li></ul></li></ul></li><li><p>âœ”ï¸ Normalize = Ä‘Æ°a vá» cÃ¹ng thang Ä‘o:</p><table><thead><tr><th>Feature</th><th>TrÆ°á»›c</th><th>Sau</th></tr></thead><tbody><tr><td>Area</td><td>50 â†’ 200</td><td>-1.19 â†’ 1.25</td></tr><tr><td>Bedrooms</td><td>1 â†’ 5</td><td>-1.22 â†’ 1.22</td></tr><tr><td>Distance</td><td>2 â†’ 18</td><td>-1.15 â†’ 1.15</td></tr></tbody></table><ul><li>ğŸ‘‰ Model há»c cÃ´ng báº±ng hÆ¡n.</li></ul></li><li><p>âš ï¸ Cáº§n chuáº©n hÃ³a dá»¯ liá»‡u cho cáº£ input vÃ  output (price).</p></li><li><p><code>data.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">normalize_features</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    mean <span class="token operator">=</span> X<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># TÃ­nh trung bÃ¬nh</span></span>
<span class="line">    std <span class="token operator">=</span> X<span class="token punctuation">.</span>std<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>   <span class="token comment"># TÃ­nh Ä‘á»™ lá»‡ch chuáº©n (cÃ¡c giÃ¡ trá»‹ cÃ¡ch xa trung bÃ¬nh bao nhiÃªu)</span></span>
<span class="line"></span>
<span class="line">    X_norm <span class="token operator">=</span> <span class="token punctuation">(</span>X <span class="token operator">-</span> mean<span class="token punctuation">)</span> <span class="token operator">/</span> std</span>
<span class="line">    <span class="token keyword">return</span> X_norm<span class="token punctuation">,</span> mean<span class="token punctuation">,</span> std</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">normalize_target</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    mean <span class="token operator">=</span> y<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    std <span class="token operator">=</span> y<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    y_norm <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> mean<span class="token punctuation">)</span> <span class="token operator">/</span> std</span>
<span class="line">    <span class="token keyword">return</span> y_norm<span class="token punctuation">,</span> mean<span class="token punctuation">,</span> std</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="â¸-tao-dataset" tabindex="-1"><a class="header-anchor" href="#â¸-tao-dataset"><span>â¸ Táº¡o Dataset</span></a></h4><ul><li><p><code>data.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">HousePriceDataset</span><span class="token punctuation">(</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>X <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>X<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>  <span class="token comment"># Chuyá»ƒn numpy â†’ torch.Tensor</span></span>
<span class="line">        self<span class="token punctuation">.</span>y <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>y<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># view(-1, 1) Ä‘á»ƒ Ä‘áº£m báº£o shape label khá»›p output, trÃ¡nh lá»—i</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>X<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>X<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">[</span>idx<span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_5ï¸âƒ£-Ä‘inh-nghia-model" tabindex="-1"><a class="header-anchor" href="#_5ï¸âƒ£-Ä‘inh-nghia-model"><span>5ï¸âƒ£ Äá»‹nh nghÄ©a Model</span></a></h3><ul><li><p>ChÃºng ta cáº§n káº¿ thá»«a <code>nn.Module</code> Ä‘á»ƒ PyTorch coi Ä‘Ã¢y lÃ  model.</p></li><li><p><code>model.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn  <span class="token comment"># Neural Network module</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">HousePriceModel</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_dim<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># input_dim - sá»‘ feature Ä‘áº§u vÃ o (trong bÃ i toÃ¡n nÃ y lÃ  3 - area, bedrooms, distance)</span></span>
<span class="line">        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>linear <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># Neural Network vá»›i 1 layer (Linear Regression)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>linear<span class="token punctuation">(</span>x<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_6ï¸âƒ£-training-loop" tabindex="-1"><a class="header-anchor" href="#_6ï¸âƒ£-training-loop"><span>6ï¸âƒ£ Training Loop</span></a></h3><ul><li>ÄÃ¢y lÃ  nÆ¡i AI &quot;há»c&quot;.</li></ul><h4 id="â¶-chuan-bi-du-lieu" tabindex="-1"><a class="header-anchor" href="#â¶-chuan-bi-du-lieu"><span>â¶ Chuáº©n bá»‹ dá»¯ liá»‡u</span></a></h4><ul><li><p><code>train.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Chuáº©n bá»‹ dá»¯ liá»‡u</span></span>
<span class="line">X<span class="token punctuation">,</span> y <span class="token operator">=</span> generate_house_data<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span></span>
<span class="line">X_norm<span class="token punctuation">,</span> mean<span class="token punctuation">,</span> std <span class="token operator">=</span> normalize_features<span class="token punctuation">(</span>X<span class="token punctuation">)</span></span>
<span class="line">y_norm<span class="token punctuation">,</span> y_mean<span class="token punctuation">,</span> y_std <span class="token operator">=</span> normalize_target<span class="token punctuation">(</span>y<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Táº¡o dataset</span></span>
<span class="line">dataset <span class="token operator">=</span> HousePriceDataset<span class="token punctuation">(</span>X_norm<span class="token punctuation">,</span> y_norm<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># Táº¡o DataLoader Ä‘á»ƒ dá»… dÃ ng láº¥y batch dá»¯ liá»‡u</span></span>
<span class="line">dataloader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># KhÃ´ng há»c 1000 máº«u cÃ¹ng lÃºc mÃ  há»c tá»«ng mini-batch (shuffle=True trÃ¡nh model há»c theo thá»© tá»±)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>âœ¦ Batch size áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡i gÃ¬?</p><table><thead><tr><th>Batch size</th><th>áº¢nh hÆ°á»Ÿng</th></tr></thead><tbody><tr><td>Nhá» (8,16)</td><td>Há»c cháº­m, noisy</td></tr><tr><td>Trung bÃ¬nh (32,64)</td><td>á»”n Ä‘á»‹nh, phá»• biáº¿n</td></tr><tr><td>Lá»›n (256+)</td><td>Nhanh nhÆ°ng dá»… overfit</td></tr></tbody></table></li><li><p>âœ¦ Batch size trong AI thá»±c táº¿ phá»• biáº¿n:</p><table><thead><tr><th>Há»‡ thá»‘ng</th><th>Batch</th></tr></thead><tbody><tr><td>OCR realtime</td><td>1â€“8</td></tr><tr><td>Chatbot embedding</td><td>32â€“128</td></tr><tr><td>Vision training</td><td>32â€“64</td></tr><tr><td>Fine-tune LLM</td><td>1â€“4</td></tr></tbody></table></li></ul><h4 id="â·-khoi-tao-model" tabindex="-1"><a class="header-anchor" href="#â·-khoi-tao-model"><span>â· Khá»Ÿi táº¡o model</span></a></h4><ul><li><p><code>train.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Khá»Ÿi táº¡o model vá»›i 3 feature</span></span>
<span class="line">model <span class="token operator">=</span> HousePriceModel<span class="token punctuation">(</span>input_dim<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="â¸-loss-function" tabindex="-1"><a class="header-anchor" href="#â¸-loss-function"><span>â¸ Loss Function</span></a></h4><ul><li><p><code>train.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Thiáº¿t láº­p hÃ m máº¥t mÃ¡t (Loss Function) vÃ  optimizer</span></span>
<span class="line">criterion <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>MSELoss<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>lr=001</code>: learning rate - Má»—i láº§n update weight, chá»‰ thay Ä‘á»•i 0.1% theo hÆ°á»›ng giáº£m loss.</p></li><li><p>Learning rate quÃ¡ lá»›n lÃ m cho Loss nháº£y loáº¡n.</p></li><li><p>Learning rate quÃ¡ nhá» lÃ m cho Loss giáº£m ráº¥t cháº­m vÃ  train ráº¥t lÃ¢u.</p></li></ul></li></ul><h4 id="â¹-training-loop" tabindex="-1"><a class="header-anchor" href="#â¹-training-loop"><span>â¹ Training Loop</span></a></h4><ul><li><code>train.py</code>:</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">epochs <span class="token operator">=</span> <span class="token number">100</span>  <span class="token comment"># Sá»‘ epoch Ä‘á»ƒ huáº¥n luyá»‡n (1 epoch = há»c háº¿t dataset 1 láº§n)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    total_loss <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Láº·p qua tá»«ng batch</span></span>
<span class="line">    <span class="token keyword">for</span> X_batch<span class="token punctuation">,</span> y_batch <span class="token keyword">in</span> dataloader<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># Forward pass (dá»± Ä‘oÃ¡n)</span></span>
<span class="line">        preds <span class="token operator">=</span> model<span class="token punctuation">(</span>X_batch<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># TÃ­nh loss (so sÃ¡nh vá»›i giÃ¡ tháº­t)</span></span>
<span class="line">        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>preds<span class="token punctuation">,</span> y_batch<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Zero gradients trÆ°á»›c khi backward (PyTorch cá»™ng dá»“n gradient â†’ náº¿u khÃ´ng reset â†’ gradient sai)</span></span>
<span class="line">        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Backward pass (tÃ­nh gradient)</span></span>
<span class="line">        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Weight thay Ä‘á»•i â†’ model thÃ´ng minh hÆ¡n</span></span>
<span class="line">        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        total_loss <span class="token operator">+=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># In káº¿t quáº£: Loss giáº£m = model há»c Ä‘Æ°á»£c</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Epoch </span><span class="token interpolation"><span class="token punctuation">{</span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>epochs<span class="token punctuation">}</span></span><span class="token string">, Loss: </span><span class="token interpolation"><span class="token punctuation">{</span>total_loss<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="âº-luu-model-va-thong-tin-chuan-hoa" tabindex="-1"><a class="header-anchor" href="#âº-luu-model-va-thong-tin-chuan-hoa"><span>âº LÆ°u model vÃ  thÃ´ng tin chuáº©n hÃ³a</span></a></h4><ul><li><p><code>train.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;model_state&quot;</span><span class="token punctuation">:</span> model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;X_mean&quot;</span><span class="token punctuation">:</span> mean<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;X_std&quot;</span><span class="token punctuation">:</span> std<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;y_mean&quot;</span><span class="token punctuation">:</span> y_mean<span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;y_std&quot;</span><span class="token punctuation">:</span> y_std</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;model.pth&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_7ï¸âƒ£-du-Ä‘oan" tabindex="-1"><a class="header-anchor" href="#_7ï¸âƒ£-du-Ä‘oan"><span>7ï¸âƒ£ Dá»± Ä‘oÃ¡n</span></a></h3><h4 id="â¶-load-checkpoint-an-toan" tabindex="-1"><a class="header-anchor" href="#â¶-load-checkpoint-an-toan"><span>â¶ Load checkpoint an toÃ n</span></a></h4><ul><li><p>Load model Ä‘Ã£ train vÃ  cÃ¡c thÃ´ng tin chuáº©n hÃ³a dá»¯ liá»‡u Ä‘Ã£ lÆ°u trÆ°á»›c Ä‘Ã³:</p></li><li><p><code>predict.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">checkpoint <span class="token operator">=</span> torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&quot;model.pth&quot;</span><span class="token punctuation">,</span> weights_only<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">model_state <span class="token operator">=</span> checkpoint<span class="token punctuation">[</span><span class="token string">&quot;model_state&quot;</span><span class="token punctuation">]</span></span>
<span class="line">X_mean <span class="token operator">=</span> checkpoint<span class="token punctuation">[</span><span class="token string">&quot;X_mean&quot;</span><span class="token punctuation">]</span></span>
<span class="line">X_std <span class="token operator">=</span> checkpoint<span class="token punctuation">[</span><span class="token string">&quot;X_std&quot;</span><span class="token punctuation">]</span></span>
<span class="line">y_mean <span class="token operator">=</span> checkpoint<span class="token punctuation">[</span><span class="token string">&quot;y_mean&quot;</span><span class="token punctuation">]</span></span>
<span class="line">y_std <span class="token operator">=</span> checkpoint<span class="token punctuation">[</span><span class="token string">&quot;y_std&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="â·-khoi-tao-model-Ä‘a-hoc" tabindex="-1"><a class="header-anchor" href="#â·-khoi-tao-model-Ä‘a-hoc"><span>â· Khá»Ÿi táº¡o model Ä‘Ã£ há»c</span></a></h4><ul><li><p><code>predict.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">model <span class="token operator">=</span> HousePriceModel<span class="token punctuation">(</span>input_dim<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="â¸-load-trong-so-Ä‘a-hoc" tabindex="-1"><a class="header-anchor" href="#â¸-load-trong-so-Ä‘a-hoc"><span>â¸ Load trá»ng sá»‘ Ä‘Ã£ há»c</span></a></h4><ul><li><p><code>predict.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>model_state<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="â¹-chuyen-sang-che-Ä‘o-Ä‘anh-gia" tabindex="-1"><a class="header-anchor" href="#â¹-chuyen-sang-che-Ä‘o-Ä‘anh-gia"><span>â¹ Chuyá»ƒn sang cháº¿ Ä‘á»™ Ä‘Ã¡nh giÃ¡</span></a></h4><ul><li><p><code>predict.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="âº-chuan-bi-du-lieu-Ä‘au-vao" tabindex="-1"><a class="header-anchor" href="#âº-chuan-bi-du-lieu-Ä‘au-vao"><span>âº Chuáº©n bá»‹ dá»¯ liá»‡u Ä‘áº§u vÃ o</span></a></h4><ul><li><p>Nháº­p dá»¯ liá»‡u má»›i (chÆ°a tá»«ng tháº¥y) Ä‘á»ƒ model dá»± Ä‘oÃ¡n káº¿t quáº£ giÃ¡ nhÃ .</p></li><li><p><code>predict.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Táº¡o má»™t máº«u dá»¯ liá»‡u Ä‘á»ƒ dá»± Ä‘oÃ¡n (1 cÄƒn nhÃ : 120 mÂ² + 3 phÃ²ng + cÃ¡ch trung tÃ¢m 5 km)</span></span>
<span class="line">sample <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Normalize input giá»‘ng lÃºc train</span></span>
<span class="line">sample_norm <span class="token operator">=</span> <span class="token punctuation">(</span>sample <span class="token operator">-</span> X_mean<span class="token punctuation">)</span> <span class="token operator">/</span> X_std</span>
<span class="line">sample_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>sample_norm<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="â»-forward-â€“-ai-du-Ä‘oan" tabindex="-1"><a class="header-anchor" href="#â»-forward-â€“-ai-du-Ä‘oan"><span>â» Forward â€“ AI dá»± Ä‘oÃ¡n</span></a></h4><ul><li><p>âš ï¸ Khi predict pháº£i dÃ¹ng cÃ¹ng mean &amp; std Ä‘Ã£ chuáº©n hÃ³a trÆ°á»›c Ä‘Ã³.</p></li><li><p><code>predict.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># Táº¯t gradient khi predict</span></span>
<span class="line">  <span class="token comment"># Forward â€“ AI dá»± Ä‘oÃ¡n</span></span>
<span class="line">  y_pred_norm <span class="token operator">=</span> model<span class="token punctuation">(</span>sample_tensor<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Denormalize output â†’ giÃ¡ tháº­t</span></span>
<span class="line">price <span class="token operator">=</span> y_pred_norm<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> y_std <span class="token operator">+</span> y_mean</span>
<span class="line"></span>
<span class="line"><span class="token comment"># In káº¿t quáº£ ra dáº¡ng sá»‘</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Predicted price: </span><span class="token interpolation"><span class="token punctuation">{</span>price<span class="token punctuation">:</span><span class="token format-spec">,.0f</span><span class="token punctuation">}</span></span><span class="token string"> VND&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_7ï¸âƒ£-chay-chuong-trinh-du-Ä‘oan" tabindex="-1"><a class="header-anchor" href="#_7ï¸âƒ£-chay-chuong-trinh-du-Ä‘oan"><span>7ï¸âƒ£ Cháº¡y chÆ°Æ¡ng trÃ¬nh dá»± Ä‘oÃ¡n</span></a></h3><h4 id="â¶-chay-train-tao-model-du-Ä‘oan-gia-nha" tabindex="-1"><a class="header-anchor" href="#â¶-chay-train-tao-model-du-Ä‘oan-gia-nha"><span>â¶ Cháº¡y TRAIN táº¡o model dá»± Ä‘oÃ¡n giÃ¡ nhÃ </span></a></h4><ul><li><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">python train.py</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>ğŸ‘‰ Sinh ra file <code>model.pth</code></li></ul></li></ul><h4 id="â·-chay-predict-du-Ä‘oan" tabindex="-1"><a class="header-anchor" href="#â·-chay-predict-du-Ä‘oan"><span>â· Cháº¡y PREDICT (dá»± Ä‘oÃ¡n)</span></a></h4><ul><li><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">python predict.py</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>á» nhá»¯ng láº§n cháº¡y dá»± Ä‘oÃ¡n giÃ¡ nhÃ  sau sáº½ khÃ´ng cáº§n cháº¡y train ná»¯a (trá»« khi muá»‘n train láº¡i).</p></li></ul><h3 id="âš ï¸-quan-trong" tabindex="-1"><a class="header-anchor" href="#âš ï¸-quan-trong"><span>âš ï¸ Quan trá»ng:</span></a></h3><ul><li><p>Trong bÃ i Ä‘oÃ¡n vá»«a lÃ m chá»‰ lÃ  Linear Regression viáº¿t báº±ng PyTorch, nÃ³ Ä‘ang phÃ¹ há»£p vá»›i hoÃ n cáº£nh bÃ i toÃ¡n iá»‡n táº¡i:</p><ul><li>Dá»¯ liá»‡u Ã­t (diá»‡n tÃ­ch, sá»‘ phÃ²ng, khoáº£ng cÃ¡ch)</li><li>Quan há»‡ gáº§n tuyáº¿n tÃ­nh</li><li>ğŸ‘‰ Nhiá»u há»‡ thá»‘ng production cÅ©ng chá»‰ cáº§n cÃ³ váº­y.</li></ul></li><li><p>Tuy nhiÃªn, thá»±c táº¿ sáº½ cÃ³ nhá»¯ng bÃ i toÃ¡n dá»± Ä‘oÃ¡n vá»›i data nhiá»u, phá»¥ thuá»™c phá»©c táº¡p (quan há»‡ phi tuyáº¿n):</p><ul><li><p>VÃ­ dá»¥ giÃ¡ nhÃ  phá»¥ thuá»™c thÃªm cáº£ tuá»•i thá», ná»™i tháº¥t, v.v.</p></li><li><p>ğŸ‘‰ Linear khÃ´ng biá»ƒu diá»…n Ä‘Æ°á»£c â€œlogic Ä‘iá»u kiá»‡nâ€, vÃ  sáº½ cáº§n Ä‘áº¿n Deep Learning vá»›i cÃ¡c hidden layers (MLP â€“ Multi-Layer Perceptron):</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">x â†’ Linear â†’ ReLU â†’ Linear â†’ ReLU â†’ Linear â†’ y</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li></ul><p><a name="3"></a></p><h2 id="ğŸ“Œ-3-bai-toan-multi-layer-perceptron-binary-classification" tabindex="-1"><a class="header-anchor" href="#ğŸ“Œ-3-bai-toan-multi-layer-perceptron-binary-classification"><span>ğŸ“Œ 3. BÃ i toÃ¡n Multi-Layer Perceptron (Binary Classification)</span></a></h2><ul><li>BÃ i toÃ¡n: Giao dá»‹ch bÃ¬nh thÆ°á»ng / báº¥t thÆ°á»ng</li></ul><h3 id="_1ï¸âƒ£-phan-tich-bai-toan-1" tabindex="-1"><a class="header-anchor" href="#_1ï¸âƒ£-phan-tich-bai-toan-1"><span>1ï¸âƒ£ PhÃ¢n tÃ­ch bÃ i toÃ¡n</span></a></h3><ul><li><p>Input: ThÃ´ng tin giao dá»‹ch</p></li><li><p>Output: BÃ¬nh thÆ°á»ng / Báº¥t thÆ°á»ng</p></li><li><p>âš ï¸ <strong>LÆ°u Ã½</strong>:</p><ul><li><p>âœ§ Model sáº½ KHÃ”NG tráº£ vá» trá»±c tiáº¿p 0 (giao dá»‹ch bÃ¬nh thÆ°á»ng) vÃ  1 (giao dá»‹ch báº¥t thÆ°á»ng).</p></li><li><p>âœ§ Model sáº½ tráº£ vá» 1 sá»‘ thá»±c (gá»i lÃ  <strong>logit</strong>) â†’ sau Ä‘Ã³ qua <strong>Sigmoid</strong> (hÃ m Logistic - Ä‘Æ°á»ng chá»¯ S) â†’ <strong>xÃ¡c suáº¥t</strong>.</p></li><li><p>âœ§ VÃ­ dá»¥:</p><table><thead><tr><th>Logit</th><th>Sigmoid</th><th>Káº¿t luáº­n</th></tr></thead><tbody><tr><td>2.3</td><td>0.91</td><td>Báº¥t thÆ°á»ng</td></tr><tr><td>-1.2</td><td>0.23</td><td>BÃ¬nh thÆ°á»ng</td></tr></tbody></table><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">prob &gt;= 0.5 â†’ báº¥t thÆ°á»ng</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li></ul><h3 id="_2ï¸âƒ£-du-lieu-gia-lap-1" tabindex="-1"><a class="header-anchor" href="#_2ï¸âƒ£-du-lieu-gia-lap-1"><span>2ï¸âƒ£ Dá»¯ liá»‡u giáº£ láº­p</span></a></h3><ul><li><p>Má»—i giao dá»‹ch cÃ³ cÃ¡c Ä‘áº·c trÆ°ng (feature).</p><ul><li>VÃ­ dá»¥: <table><thead><tr><th>Feature</th><th>Ã nghÄ©a</th></tr></thead><tbody><tr><td>amount</td><td>Sá»‘ tiá»n</td></tr><tr><td>hour</td><td>Giá» giao dá»‹ch (0â€“23)</td></tr><tr><td>location_score</td><td>Má»©c Ä‘á»™ láº¡ cá»§a vá»‹ trÃ­</td></tr><tr><td>device_score</td><td>Má»©c Ä‘á»™ láº¡ cá»§a thiáº¿t bá»‹</td></tr><tr><td>freq_24h</td><td>Sá»‘ giao dá»‹ch 24h gáº§n nháº¥t</td></tr></tbody></table></li></ul></li><li><p>Trong bÃ i nÃ y chÃºng ta sáº½ sá»­ dá»¥ng dataset máº«u cÃ³ ráº¥t nhiá»u feature.</p><ul><li>ğŸ‘‰ Tuy nhiÃªn, báº¡n cÅ©ng khÃ´ng cáº§n thiáº¿t hiá»ƒu Ã½ nghÄ©a tá»«ng feature nhÆ° váº­y, bá»Ÿi sau cÃ¹ng thÃ¬ Neural Network chá»‰ cáº§n sá»‘, khÃ´ng cáº§n biáº¿t Ä‘Ã³ lÃ  gÃ¬.</li></ul></li></ul><h3 id="_3ï¸âƒ£-import-du-lieu" tabindex="-1"><a class="header-anchor" href="#_3ï¸âƒ£-import-du-lieu"><span>3ï¸âƒ£ Import dá»¯ liá»‡u</span></a></h3><ul><li>ChÃºng ta sáº½ dÃ¹ng Dataset cÃ³ sáºµn do <a href="https://www.kaggle.com" target="_blank" rel="noopener noreferrer">Kaggle</a> cung cáº¥p.</li></ul><h4 id="â¶-tai-dataset-mau" tabindex="-1"><a class="header-anchor" href="#â¶-tai-dataset-mau"><span>â¶ Táº£i Dataset máº«u</span></a></h4><ul><li><p>Táº£i dataset Credit Card Fraud Detection <a href="https://www.kaggle.com/datasets/mlg-ulb/creditcardfraud" target="_blank" rel="noopener noreferrer">táº¡i Ä‘Ã¢y</a>.</p></li><li><p>Giáº£i nÃ©n ra file <code>creditcard.csv</code> vÃ  Ä‘áº·t vÃ o project.</p></li></ul><h4 id="â·-chia-train-validation" tabindex="-1"><a class="header-anchor" href="#â·-chia-train-validation"><span>â· Chia train / validation</span></a></h4><ul><li><p>HÃ£y Ä‘Ã¡nh giÃ¡ láº¡i Dataset máº«u chÃºng ta sá»­ dá»¥ng:</p><ul><li>~99.8% lÃ  cÃ¡c data cÃ³ class = 0 (giao dá»‹ch bÃ¬nh thÆ°á»ng)</li><li>~0.2% lÃ  cÃ¡c data cÃ³ class = 1 (fraud - giao dá»‹ch báº¥t thÆ°á»ng)</li><li>ğŸ‘‰ Máº¥t cÃ¢n báº±ng nghiÃªm trá»ng.</li></ul></li><li><p>â“ Chuyá»‡n gÃ¬ xáº£y ra náº¿u KHÃ”NG chia train / validation?</p><ul><li><p>Giáº£ sá»­ 1000 giao dá»‹ch:</p><ul><li>âœ§ 998 normal</li><li>âœ§ 2 fraud</li></ul></li><li><p>Chia train / validation = 80/20:</p><ul><li>âœ§ Train: 798 normal + 2 fraud</li><li>âœ§ Val: 200 normal + 0 fraud âŒ</li></ul></li><li><p>ğŸ‘‰ ÄÃ¡nh giÃ¡ lÃ  <strong>vÃ´ nghÄ©a</strong> do validation khÃ´ng cÃ³ fraud nÃ o.</p></li></ul></li><li><p>Vá»›i AI cáº£nh bÃ¡o, validation trá»Ÿ nÃªn vÃ´ cÃ¹ng quan trá»ng:</p><ul><li>Sai 1 giao dá»‹ch = háº­u quáº£ lá»›n.</li></ul></li><li><p>âœ… Do váº­y, chÃºng ta cáº§n giá»¯ tá»· lá»‡ fraud giá»‘ng nhau á»Ÿ train &amp; val.</p></li><li><p><code>prepare_data.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/creditcard.csv&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">train_df<span class="token punctuation">,</span> temp_df <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span></span>
<span class="line">    df<span class="token punctuation">,</span></span>
<span class="line">    test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span></span>
<span class="line">    random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span></span>
<span class="line">    stratify<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;Class&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">val_df<span class="token punctuation">,</span> test_df <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span></span>
<span class="line">    temp_df<span class="token punctuation">,</span></span>
<span class="line">    test_size<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span></span>
<span class="line">    random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span></span>
<span class="line">    stratify<span class="token operator">=</span>temp_df<span class="token punctuation">[</span><span class="token string">&quot;Class&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">train_df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&quot;data/train.csv&quot;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line">val_df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&quot;data/val.csv&quot;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line">test_df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&quot;data/test.csv&quot;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>âœ§ á» Ä‘Ã¢y chÃºng ta chia 70% dá»¯ liá»‡u cho training, 30% cho validation vÃ  test (trong 30% nÃ y chia 50:50 cho validation vÃ  test).</li><li>âœ§ Dá»¯ liá»‡u sau khi chia Ä‘Æ°á»£c lÆ°u vÃ o 3 file <code>.csv</code> riÃªng biá»‡t.</li><li>âœ§ <code>stratify = df[&quot;Class&quot;] (y)</code> giá»¯ tá»· lá»‡ fraud giá»‘ng nhau á»Ÿ train &amp; val.</li></ul></li></ul><h4 id="â¸-chuan-hoa-du-lieu" tabindex="-1"><a class="header-anchor" href="#â¸-chuan-hoa-du-lieu"><span>â¸ Chuáº©n hÃ³a dá»¯ liá»‡u</span></a></h4><ul><li><p>Náº¿u quan sÃ¡t Dataset máº«u sáº½ tháº¥y:</p><ul><li>V1..V28 â†’ giÃ¡ trá»‹ quanh 0.</li><li>Amount â†’ cÃ³ thá»ƒ lÃªn tá»›i vÃ i chá»¥c nghÃ¬n.</li></ul></li><li><p>âŒ Náº¿u khÃ´ng chuáº©n hÃ³a:</p><ul><li>Neural Network há»c lá»‡ch.</li><li>Gradient khÃ³ há»™i tá»¥.</li></ul></li><li><p>âœ”ï¸ ChÃºng ta sáº½ dÃ¹ng cÃ´ng cá»¥ há»— trá»£ chuáº©n hÃ³a phá»• biáº¿n <code>StandardScaler</code>.</p></li><li><p><code>fit_scaler.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler</span>
<span class="line"><span class="token keyword">import</span> joblib</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Äá»c dá»¯ liá»‡u huáº¥n luyá»‡n</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/train.csv&quot;</span><span class="token punctuation">)</span></span>
<span class="line">X <span class="token operator">=</span> df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;Class&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Time&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Chuáº©n hÃ³a dá»¯ liá»‡u</span></span>
<span class="line">scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">scaler<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># LÆ°u trá»¯ scaler</span></span>
<span class="line">joblib<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>scaler<span class="token punctuation">,</span> <span class="token string">&quot;artifacts/scaler.pkl&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>Táº¡m thá»i khÃ´ng dÃ¹ng cá»™t <code>Time</code> do Ä‘Ã¢y lÃ  sá»‘ giÃ¢y ká»ƒ tá»« giao dá»‹ch Ä‘áº§u tiÃªn, khÃ´ng mang Ã½ nghÄ©a rÃµ rÃ ng cho bÃ i toÃ¡n anomaly â†’ dá»… gÃ¢y nhiá»…u.</p></li><li><p>Cá»™t <code>Class</code> dÃ¹ng cho label (nhÃ£n) â†’ tá»•ng cÃ²n 29 feature.</p></li></ul></li><li><p>âš ï¸ KHÃ”NG chuáº©n hÃ³a <code>y</code> trong bÃ i toÃ¡n Classification bá»Ÿi <code>y</code> mang Ã½ nghÄ©a logic (0 hoáº·c 1) chá»© khÃ´ng pháº£i giÃ¡ trá»‹ Ä‘o lÆ°á»ng.</p></li></ul><h3 id="_4ï¸âƒ£-tao-pytorch-dataset" tabindex="-1"><a class="header-anchor" href="#_4ï¸âƒ£-tao-pytorch-dataset"><span>4ï¸âƒ£ Táº¡o PyTorch Dataset</span></a></h3><ul><li><p>Khi training, validation vÃ  test thÃ¬ Ä‘á»u cáº§n táº¡o Dataset</p><ul><li>ğŸ‘‰ Ta sáº½ truyá»n <code>csv_path</code> Ä‘áº¿n file dá»¯ liá»‡u máº«u Ä‘Ã£ chia ban Ä‘áº§u.</li></ul></li><li><p><code>dataset.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> Dataset</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">FraudDataset</span><span class="token punctuation">(</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> csv_path<span class="token punctuation">,</span> scaler<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>csv_path<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        X_df <span class="token operator">=</span> df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;Class&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Time&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">        y <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;Class&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values</span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Chuáº©n hÃ³a dá»¯ liá»‡u náº¿u scaler Ä‘Æ°á»£c cung cáº¥p</span></span>
<span class="line">        <span class="token keyword">if</span> scaler <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token comment"># Ãp dá»¥ng chuáº©n hÃ³a (mean, std) Ä‘Ã£ há»c</span></span>
<span class="line">            X <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_df<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">            X <span class="token operator">=</span> X_df<span class="token punctuation">.</span>values</span>
<span class="line"></span>
<span class="line">        self<span class="token punctuation">.</span>X <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>X<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span></span>
<span class="line">        self<span class="token punctuation">.</span>y <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>y<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>y<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>X<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">[</span>idx<span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_5ï¸âƒ£-Ä‘inh-nghia-model-1" tabindex="-1"><a class="header-anchor" href="#_5ï¸âƒ£-Ä‘inh-nghia-model-1"><span>5ï¸âƒ£ Äá»‹nh nghÄ©a Model</span></a></h3><ul><li><p><code>model.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">FraudMLP</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_dim<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        self<span class="token punctuation">.</span>model <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span></span>
<span class="line">            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            nn<span class="token punctuation">.</span>ReLU<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>model<span class="token punctuation">(</span>x<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Cáº¥u trÃºc MLP cÆ¡ báº£n:</p><div class="language-scss line-numbers-mode" data-highlighter="prismjs" data-ext="scss" data-title="scss"><pre><code><span class="line">Input <span class="token punctuation">(</span>29<span class="token punctuation">)</span></span>
<span class="line">   â†“</span>
<span class="line"><span class="token function">Linear</span><span class="token punctuation">(</span>29 â†’ 64<span class="token punctuation">)</span></span>
<span class="line">   â†“</span>
<span class="line">ReLU</span>
<span class="line">   â†“</span>
<span class="line"><span class="token function">Linear</span><span class="token punctuation">(</span>64 â†’ 32<span class="token punctuation">)</span></span>
<span class="line">   â†“</span>
<span class="line">ReLU</span>
<span class="line">   â†“</span>
<span class="line"><span class="token function">Linear</span><span class="token punctuation">(</span>32 â†’ 1<span class="token punctuation">)</span></span>
<span class="line">   â†“</span>
<span class="line">Logits</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>Linear(29 â†’ 64)</code>: Layer 1 - láº¥y 29 sá»‘ Ä‘áº§u vÃ o táº¡o ra 64 Ä‘áº·c trÆ°ng má»›i.</p><ul><li>VÃ­ dá»¥: <ul><li>Feature 1: â€œmáº«u giao dá»‹ch láº¡ ban Ä‘Ãªmâ€</li><li>Feature 2: â€œsá»‘ tiá»n cao + vá»‹ trÃ­ báº¥t thÆ°á»ngâ€</li><li>v.v.</li></ul></li></ul></li><li><p><code>Linear(64 â†’ 32)</code>: Layer 2 - gom 64 Ä‘áº·c trÆ°ng trung gian, cháº¯t lá»c thÃ nh 32 Ä‘áº·c trÆ°ng trá»«u tÆ°á»£ng hÆ¡n.</p><ul><li>NÃ´m na náº¿u coi Layer 1 lÃ  cÃ¡c pattern nhá» thÃ¬ Layer 2 cho chÃºng ta tháº¥y cÃ¡c dáº¥u hiá»‡u gian láº­n, báº¥t thÆ°á»ng.</li></ul></li><li><p><code>Linear(32 â†’ 1)</code>: Output layer - 1 con sá»‘ duy nháº¥t thá»ƒ hiá»‡n Ä‘á»™ tin (chÆ°a pháº£i xÃ¡c suáº¥t mÃ  má»›i chá»‰ lÃ  <strong>logit</strong>) ráº±ng giao dá»‹ch nÃ y lÃ  fraud.</p></li><li><p><code>ReLU</code>: Táº¡o phi tuyáº¿n, cho phÃ©p model há»c quan há»‡ phá»©c táº¡p.</p><ul><li>VÃ­ dá»¥ muá»‘n phÃ¡t hiá»‡n â€œGiao dá»‹ch ban Ä‘Ãªm vÃ  sá»‘ tiá»n lá»›n thÃ¬ Ä‘Ã¡ng nghiâ€: <ul><li>Náº¿u ban ngÃ y â†’ giÃ¡ trá»‹ Ã¢m â†’ ReLU = 0 â†’ khÃ´ng quan tÃ¢m</li><li>Náº¿u ban Ä‘Ãªm â†’ giÃ¡ trá»‹ dÆ°Æ¡ng â†’ ReLU giá»¯ láº¡i â†’ kÃ­ch hoáº¡t</li><li>ğŸ‘‰ Náº¿u khÃ´ng cÃ³ <code>ReLU</code>: trá»i sÃ¡ng hay tá»‘i khÃ´ng quan tÃ¢m â†’ ban ngÃ y váº«n bá»‹ Ä‘Ã¡ng nghi</li></ul></li></ul></li></ul></li><li><p>âš ï¸ <strong>LÆ°u Ã½</strong>:</p><ul><li>CÃ¡c con sá»‘ 64, 32 lÃ  do kinh nghiá»‡m + thá»­ nghiá»‡m, khÃ´ng cÃ³ cÃ´ng thá»©c chÃ­nh xÃ¡c.</li></ul></li></ul><h3 id="_6ï¸âƒ£-training-loop-1" tabindex="-1"><a class="header-anchor" href="#_6ï¸âƒ£-training-loop-1"><span>6ï¸âƒ£ Training Loop</span></a></h3><ul><li><p>NhÃ¬n chung, khung Training Loop trong bÃ i toÃ¡n nÃ y cÅ©ng tÆ°Æ¡ng tá»± bÃ i toÃ¡n Dá»± Ä‘oÃ¡n giÃ¡ nhÃ .</p><ul><li><p>Äiá»ƒm khÃ¡c biá»‡t lÃ  sá»­ dá»¥ng hÃ m máº¥t mÃ¡t (Loss Function) <code>BCEWithLogitsLoss</code> giÃºp tá»± Ä‘á»™ng Ã¡p dá»¥ng Sigmoid:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">BCEWithLogitsLoss = Sigmoid(logit) + BCELoss</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p><code>train.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"><span class="token keyword">import</span> joblib</span>
<span class="line"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoader</span>
<span class="line"><span class="token keyword">from</span> torch <span class="token keyword">import</span> nn<span class="token punctuation">,</span> optim</span>
<span class="line"></span>
<span class="line"><span class="token keyword">from</span> model <span class="token keyword">import</span> FraudMLP</span>
<span class="line"><span class="token keyword">from</span> dataset <span class="token keyword">import</span> FraudDataset</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Load scaler</span></span>
<span class="line">scaler <span class="token operator">=</span> joblib<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&quot;artifacts/scaler.pkl&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Táº¡o Dataset</span></span>
<span class="line">train_ds <span class="token operator">=</span> FraudDataset<span class="token punctuation">(</span><span class="token string">&quot;data/train.csv&quot;</span><span class="token punctuation">,</span> scaler<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Táº¡o DataLoader</span></span>
<span class="line">train_loader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>train_ds<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Khá»Ÿi táº¡o model, loss function vÃ  optimizer</span></span>
<span class="line">model <span class="token operator">=</span> FraudMLP<span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span></span>
<span class="line">criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>BCEWithLogitsLoss<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Huáº¥n luyá»‡n mÃ´ hÃ¬nh</span></span>
<span class="line">EPOCHS <span class="token operator">=</span> <span class="token number">10</span></span>
<span class="line"><span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>EPOCHS<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    model<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    total_loss <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">for</span> X<span class="token punctuation">,</span> y <span class="token keyword">in</span> train_loader<span class="token punctuation">:</span></span>
<span class="line">        X<span class="token punctuation">,</span> y <span class="token operator">=</span> X<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        logits <span class="token operator">=</span> model<span class="token punctuation">(</span>X<span class="token punctuation">)</span></span>
<span class="line">        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>logits<span class="token punctuation">,</span> y<span class="token punctuation">)</span></span>
<span class="line">        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        total_loss <span class="token operator">+=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    avg_loss <span class="token operator">=</span> total_loss <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>train_loader<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Epoch </span><span class="token interpolation"><span class="token punctuation">{</span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, loss=</span><span class="token interpolation"><span class="token punctuation">{</span>avg_loss<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;artifacts/model.pth&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_7ï¸âƒ£-validation-metrics" tabindex="-1"><a class="header-anchor" href="#_7ï¸âƒ£-validation-metrics"><span>7ï¸âƒ£ Validation &amp; Metrics</span></a></h3><ul><li><p>âŒ Training loss chá»‰ cho biáº¿t model nhá»› data train tá»‘t tá»›i Ä‘Ã¢u, khÃ´ng giÃºp tá»•ng quÃ¡t hÃ³a model.</p><ul><li>Bá»Ÿi thá»±c táº¿ vá»›i data mÃ  model chÆ°a tá»«ng tháº¥y, output cÃ³ thá»ƒ fail.</li></ul></li><li><p>âœ”ï¸ Validation giÃºp:</p><ul><li><p>âœ¦ Kiá»ƒm tra kháº£ nÄƒng tá»•ng quÃ¡t:</p><ul><li>Model há»c cÃ³ Ã¡p dá»¥ng Ä‘Æ°á»£c cho dá»¯ liá»‡u má»›i khÃ´ng?</li></ul></li><li><p>âœ¦ Quyáº¿t Ä‘á»‹nh dá»«ng train:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Epoch 10: Val loss nhá» nháº¥t â†’ giá»¯ model</span>
<span class="line">Epoch 11+: Val loss tÄƒng â†’ stop</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>âœ¦ So sÃ¡nh model / hyperparameter:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">LR = 0.01 â†’ val loss = 0.42</span>
<span class="line">LR = 0.001 â†’ val loss = 0.31 âœ…</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ğŸ‘‰ Chá»n cÃ¡i tá»‘t trÃªn validation, khÃ´ng pháº£i train.</li></ul></li><li><p>âœ¦ Chá»n threshold / metric phÃ¹ há»£p:</p><ul><li><p>âœ§ Vá»›i lÆ°á»£ng Dataset máº«u 99% lÃ  normal, 1% lÃ  fraud:</p><ul><li>VÃ­ dá»¥ output: <table><thead><tr><th>Giao dá»‹ch</th><th>XÃ¡c suáº¥t fraud</th></tr></thead><tbody><tr><td>Fraud tháº­t</td><td>0.42</td></tr><tr><td>Fraud tháº­t</td><td>0.37</td></tr><tr><td>Normal</td><td>0.05</td></tr></tbody></table></li><li>ğŸ‘‰ Náº¿u threshold = 0.5 sáº½ khÃ´ng báº¯t Ä‘Æ°á»£c fraud nÃ o.</li></ul></li><li><p>âœ§ ChÃºng ta sáº½ cáº§n:</p><ul><li><p>â€ Precision</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Trong nhá»¯ng cÃ¡i mÃ¬nh bÃ¡o fraud â†’ bao nhiÃªu cÃ¡i lÃ  fraud tháº­t</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>ğŸ‘‰ Precision cao â†’ Ã­t bÃ¡o nháº§m</li></ul></li><li><p>â Recall</p></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Trong táº¥t cáº£ fraud tháº­t â†’ mÃ¬nh báº¯t Ä‘Æ°á»£c bao nhiÃªu</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>ğŸ‘‰ Recall tháº¥p â†’ bá» sÃ³t gian láº­n</li></ul></li><li><p>ğŸ”¥ <strong>TÃ³m láº¡i</strong>:</p><ul><li><p>âœ§ KhÃ´ng cÃ³ threshold â€œÄ‘Ãºngâ€, chá»‰ cÃ³ threshold phÃ¹ há»£p má»¥c tiÃªu kinh doanh.</p></li><li><p>âœ§ Chá»n threshold: Æ¯u tiÃªn Recall (Recall â‰¥ 85%) hoáº·c cÃ¢n báº±ng Precision / Recall hoáº·c cÃ¢n báº±ng chi phÃ­ tiá»n báº¡c:</p><ul><li>VÃ­ dá»¥: <ul><li>Bá» sÃ³t 1 fraud = máº¥t 1.000$</li><li>BÃ¡o nháº§m 1 giao dá»‹ch = tá»‘n 5$</li><li>ğŸ‘‰ Ta chá»n threshold bÃ¡o nháº§m cÃ²n hÆ¡n bá» sÃ³t.</li></ul></li></ul></li></ul></li></ul></li></ul></li><li><p>âš ï¸ <strong>Validation loop chá»‰ forward + Ä‘o metric, KHÃ”NG backward.</strong></p></li><li><p><code>validation.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"><span class="token keyword">import</span> joblib</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> json</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> recall_score</span>
<span class="line"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoader</span>
<span class="line"></span>
<span class="line"><span class="token keyword">from</span> dataset <span class="token keyword">import</span> FraudDataset</span>
<span class="line"><span class="token keyword">from</span> model <span class="token keyword">import</span> FraudMLP</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Load scaler</span></span>
<span class="line">scaler <span class="token operator">=</span> joblib<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&quot;artifacts/scaler.pkl&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Táº¡o Dataset</span></span>
<span class="line">val_ds <span class="token operator">=</span> FraudDataset<span class="token punctuation">(</span><span class="token string">&quot;data/val.csv&quot;</span><span class="token punctuation">,</span> scaler<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Táº¡o DataLoader</span></span>
<span class="line">val_loader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>val_ds<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Khá»Ÿi táº¡o model</span></span>
<span class="line">model <span class="token operator">=</span> FraudMLP<span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span></span>
<span class="line">state_dict <span class="token operator">=</span> torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&quot;artifacts/model.pth&quot;</span><span class="token punctuation">,</span> weights_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>state_dict<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Chuyá»ƒn Ä‘á»•i model sang cháº¿ Ä‘á»™ Ä‘Ã¡nh giÃ¡</span></span>
<span class="line">model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">all_probs<span class="token punctuation">,</span> all_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> X<span class="token punctuation">,</span> y <span class="token keyword">in</span> val_loader<span class="token punctuation">:</span></span>
<span class="line">        X<span class="token punctuation">,</span> y <span class="token operator">=</span> X<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        logits <span class="token operator">=</span> model<span class="token punctuation">(</span>X<span class="token punctuation">)</span></span>
<span class="line">        probs <span class="token operator">=</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>logits<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        all_probs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>probs<span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        all_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Gá»™p táº¥t cáº£ cÃ¡c dá»± Ä‘oÃ¡n vÃ  nhÃ£n láº¡i</span></span>
<span class="line">probs <span class="token operator">=</span> np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span>all_probs<span class="token punctuation">)</span><span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">labels <span class="token operator">=</span> np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span>all_labels<span class="token punctuation">)</span><span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Khá»Ÿi táº¡o threshold máº·c Ä‘á»‹nh ban Ä‘áº§u</span></span>
<span class="line">best_threshold<span class="token punctuation">,</span> best_recall <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># TÃ¬m kiáº¿m ngÆ°á»¡ng tá»‘t nháº¥t</span></span>
<span class="line"><span class="token comment"># QuÃ©t threshold tá»« 0.1 Ä‘áº¿n 0.9 vá»›i step 0.05 Ä‘á»ƒ tá»‘i Æ°u hÃ³a</span></span>
<span class="line"><span class="token keyword">for</span> t <span class="token keyword">in</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># Dá»± Ä‘oÃ¡n nhÃ£n</span></span>
<span class="line">    preds <span class="token operator">=</span> <span class="token punctuation">(</span>probs <span class="token operator">&gt;=</span> t<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># TÃ­nh Recall</span></span>
<span class="line">    recall <span class="token operator">=</span> recall_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> preds<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># Giá»¯ threshold tá»‘t nháº¥t</span></span>
<span class="line">    <span class="token keyword">if</span> recall <span class="token operator">&gt;</span> best_recall<span class="token punctuation">:</span></span>
<span class="line">        best_recall <span class="token operator">=</span> recall</span>
<span class="line">        best_threshold <span class="token operator">=</span> t</span>
<span class="line"></span>
<span class="line"><span class="token comment"># LÆ°u threshold vÃ  recall tá»‘t nháº¥t vÃ o file config.json</span></span>
<span class="line">config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;threshold&quot;</span><span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">(</span>best_threshold<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;recall&quot;</span><span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">(</span>best_recall<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;artifacts/config.json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">    json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>config<span class="token punctuation">,</span> f<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Best threshold:&quot;</span><span class="token punctuation">,</span> best_threshold<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_8ï¸âƒ£-test" tabindex="-1"><a class="header-anchor" href="#_8ï¸âƒ£-test"><span>8ï¸âƒ£ Test</span></a></h3><ul><li><p>âœ¦ LÃ  bÆ°á»›c Ä‘Ã¡nh giÃ¡ cuá»‘i cÃ¹ng.</p></li><li><p>âœ¦ Khi test pháº£i dÃ¹ng dá»¯ liá»‡u thá»±c táº¿ mÃ  model chÆ°a tá»«ng tháº¥y.</p><ul><li>ğŸ‘‰ ChÃºng ta sá»­ dá»¥ng dá»¯ liá»‡u test Ä‘Ã£ chia ban Ä‘áº§u.</li></ul></li><li><p>âœ¦ Sau bÆ°á»›c validation, chÃºng ta Ä‘Ã£ khÃ³a model + threshold.</p><ul><li>ğŸ‘‰ Giai Ä‘oáº¡n test sáº½ Ã¡p dá»¥ng threshold Ä‘Ã£ chá»n Ä‘á»ƒ kiá»ƒm chá»©ng viá»‡c náº¿u Ä‘Æ°a model ra production thÃ¬ nÃ³ sáº½ hoáº¡t Ä‘á»™ng ra sao.</li></ul></li><li><p>âœ¦ Äá»ƒ kiá»ƒm chá»©ng káº¿t quáº£ test:</p><ul><li>âœ§ CÃ³ bá» sÃ³t fraud nhiá»u khÃ´ng?</li><li>âœ§ BÃ¡o nháº§m bao nhiÃªu?</li><li>ğŸ‘‰ Log bÃ¡o cÃ¡o test lÃ  khÃ¢u quan trá»ng vÃ  báº¯t buá»™c.</li></ul></li><li><p><code>test.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> json</span>
<span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"><span class="token keyword">import</span> joblib</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoader</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report<span class="token punctuation">,</span> roc_auc_score</span>
<span class="line"></span>
<span class="line"><span class="token keyword">from</span> model <span class="token keyword">import</span> FraudMLP</span>
<span class="line"><span class="token keyword">from</span> dataset <span class="token keyword">import</span> FraudDataset</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Load scaler</span></span>
<span class="line">scaler <span class="token operator">=</span> joblib<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&quot;artifacts/scaler.pkl&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Táº¡o Dataset</span></span>
<span class="line">test_ds <span class="token operator">=</span> FraudDataset<span class="token punctuation">(</span><span class="token string">&quot;data/test.csv&quot;</span><span class="token punctuation">,</span> scaler<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Táº¡o DataLoader</span></span>
<span class="line">test_loader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>test_ds<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Khá»Ÿi táº¡o model</span></span>
<span class="line">model <span class="token operator">=</span> FraudMLP<span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span></span>
<span class="line">state_dict <span class="token operator">=</span> torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&quot;artifacts/model.pth&quot;</span><span class="token punctuation">,</span> weights_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>state_dict<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Chuyá»ƒn Ä‘á»•i model sang cháº¿ Ä‘á»™ Ä‘Ã¡nh giÃ¡</span></span>
<span class="line">model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># TÃ¬m ngÆ°á»¡ng tá»‘i Æ°u há»c tá»« validation</span></span>
<span class="line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;artifacts/config.json&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">    threshold <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;threshold&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">all_probs<span class="token punctuation">,</span> all_labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> X<span class="token punctuation">,</span> y <span class="token keyword">in</span> test_loader<span class="token punctuation">:</span></span>
<span class="line">        X<span class="token punctuation">,</span> y <span class="token operator">=</span> X<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        probs <span class="token operator">=</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>model<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        all_probs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>probs<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        all_labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">probs <span class="token operator">=</span> np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span>all_probs<span class="token punctuation">)</span><span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">labels <span class="token operator">=</span> np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span>all_labels<span class="token punctuation">)</span><span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Dá»± Ä‘oÃ¡n nhÃ£n</span></span>
<span class="line">preds <span class="token operator">=</span> <span class="token punctuation">(</span>probs <span class="token operator">&gt;=</span> threshold<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> preds<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;AUC:&quot;</span><span class="token punctuation">,</span> roc_auc_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> probs<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>âœ¦ VÃ­ dá»¥ log káº¿t quáº£ test:</p><ul><li><p><strong>â€ <code>classification_report</code> â€“ Äá»c Tá»ªNG DÃ’NG</strong></p><div class="language-markdown line-numbers-mode" data-highlighter="prismjs" data-ext="md" data-title="md"><pre><code><span class="line">                  precision    recall  f1-score   support</span>
<span class="line"></span>
<span class="line"><span class="token code keyword">            0.0       1.00      1.00      1.00      42648</span>
<span class="line">            1.0       0.77      0.84      0.80         74</span></span>
<span class="line"></span>
<span class="line"><span class="token code keyword">      accuracy                            1.00      42722</span>
<span class="line">      macro avg       0.88      0.92      0.90      42722</span>
<span class="line">    weighted avg      1.00      1.00      1.00      42722</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ChÃºng ta sáº½ chá»‰ quan tÃ¢m dÃ²ng <code>1.0</code>: <ul><li><code>support = 74</code>: cÃ³ 74 giao dá»‹ch gian láº­n tháº­t trÃªn 42648 giao dá»‹ch.</li><li><code>recall = 0.84</code>: trong 74 giao dá»‹ch gian láº­n model báº¯t Ä‘Æ°á»£c 84% (â‰¥ 0.8 lÃ  Tá»T).</li><li><code>precision = 0.77</code>: trong cÃ¡c giao dá»‹ch model báº¯t gian láº­n, 77% lÃ  tháº­t.</li><li><code>f1-score = 0.80</code>: trung bÃ¬nh cá»§a precision &amp; recall (â‰¥ 0.75 lÃ  Tá»T).</li></ul></li></ul></li><li><p><strong>â <code>roc_auc_score</code></strong></p><ul><li>LÃ  xÃ¡c xuáº¥t model Æ°u tiÃªn Ä‘Ã¡nh giÃ¡ 1 giao dá»‹ch gian láº­n hay khÃ´ng lÃªn trÃªn giao dá»‹ch bÃ¬nh thÆ°á»ng.</li><li>AUC KHÃ”NG phá»¥ thuá»™c threshold.</li><li><table><thead><tr><th>AUC</th><th>ÄÃ¡nh giÃ¡</th></tr></thead><tbody><tr><td>0.5</td><td>Random</td></tr><tr><td>0.7</td><td>Táº¡m</td></tr><tr><td>0.8</td><td>Tá»‘t</td></tr><tr><td>0.9</td><td>Ráº¥t tá»‘t</td></tr><tr><td>0.97</td><td>Xuáº¥t sáº¯c</td></tr></tbody></table></li></ul></li></ul></li></ul><h3 id="_9ï¸âƒ£-trien-khai-inference-Ä‘ua-model-Ä‘a-train-ra-su-dung-that" tabindex="-1"><a class="header-anchor" href="#_9ï¸âƒ£-trien-khai-inference-Ä‘ua-model-Ä‘a-train-ra-su-dung-that"><span>9ï¸âƒ£ Triá»ƒn khai inference - ÄÆ°a model Ä‘Ã£ train ra sá»­ dá»¥ng tháº­t</span></a></h3><h4 id="â€-muc-tieu" tabindex="-1"><a class="header-anchor" href="#â€-muc-tieu"><span>â€ Má»¥c tiÃªu</span></a></h4><ul><li><p>ÄÆ°a model Ä‘Ã£ train ra sá»­ dá»¥ng tháº­t.</p></li><li><p>Sá»­ dá»¥ng Ä‘Æ°á»£c cho cÃ¡c giao dá»‹ch realtime â†’ cáº§n nhanh.</p></li><li><p>KhÃ´ng bá»‹ lá»‡ thuá»™c code train.</p></li><li><p>Káº¿t quáº£ giá»‘ng test.</p></li></ul><h4 id="â-chuan-hoa-artifact-can-deploy" tabindex="-1"><a class="header-anchor" href="#â-chuan-hoa-artifact-can-deploy"><span>â Chuáº©n hÃ³a artifact cáº§n deploy</span></a></h4><ul><li><p>Sau khi train xong, deploy KHÃ”NG cáº§n dataset:</p><ul><li><p>âœ”ï¸ Chá»‰ cáº§n:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">artifacts/</span>
<span class="line">â”œâ”€â”€ model.pth        # weight</span>
<span class="line">â”œâ”€â”€ scaler.pkl       # fitted scaler (chuáº©n hÃ³a dá»¯ liá»‡u)</span>
<span class="line">â”œâ”€â”€ config.json      # threshold</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>âŒ KhÃ´ng cáº§n:</p><ul><li><code>train.py</code></li><li><code>validation.py</code></li><li><code>creditcard.csv</code></li></ul></li></ul></li></ul><h4 id="â‚-inference-pipeline" tabindex="-1"><a class="header-anchor" href="#â‚-inference-pipeline"><span>â‚ Inference pipeline</span></a></h4><ul><li><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Raw input</span>
<span class="line">   â†“</span>
<span class="line">Preprocessing (chuáº©n hÃ³a dá»¯ liá»‡u)</span>
<span class="line">   â†“</span>
<span class="line">Tensor</span>
<span class="line">   â†“</span>
<span class="line">Model (logits)</span>
<span class="line">   â†“</span>
<span class="line">Sigmoid â†’ xÃ¡c suáº¥t</span>
<span class="line">   â†“</span>
<span class="line">Threshold</span>
<span class="line">   â†“</span>
<span class="line">Decision (Normal / Fraud)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="âƒ-thiet-ke-deploy-structure" tabindex="-1"><a class="header-anchor" href="#âƒ-thiet-ke-deploy-structure"><span>âƒ Thiáº¿t káº¿ deploy structure</span></a></h4><ul><li><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">inference/</span>
<span class="line">â”œâ”€â”€ inference.py</span>
<span class="line">â”œâ”€â”€ model_loader.py</span>
<span class="line">â”œâ”€â”€ preprocess.py</span>
<span class="line">â”œâ”€â”€ schema.py</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>model_loader.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"><span class="token keyword">from</span> model <span class="token keyword">import</span> FraudMLP</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">load_model</span><span class="token punctuation">(</span>model_path<span class="token punctuation">,</span> input_dim<span class="token punctuation">,</span> device<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    model <span class="token operator">=</span> FraudMLP<span class="token punctuation">(</span>input_dim<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span></span>
<span class="line">    state_dict <span class="token operator">=</span> torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span>model_path<span class="token punctuation">,</span> weights_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> map_location<span class="token operator">=</span>device<span class="token punctuation">)</span>  <span class="token comment">#  map_location=device â†’ cháº¡y Ä‘Æ°á»£c cáº£ CPU/GPU</span></span>
<span class="line">    model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>state_dict<span class="token punctuation">)</span></span>
<span class="line">    model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> model</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>preprocess.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>
<span class="line"><span class="token keyword">from</span> inference<span class="token punctuation">.</span>schema <span class="token keyword">import</span> FEATURE_ORDER</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">preprocess</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> scaler<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span>features<span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>FEATURE_ORDER<span class="token punctuation">)</span></span>
<span class="line">    x_scaled <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>df<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> x_scaled</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>schema.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">FEATURE_ORDER <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&quot;V1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;V2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;V3&quot;</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token string">&quot;V28&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Amount&quot;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">validate_features</span><span class="token punctuation">(</span>features<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">for</span> f <span class="token keyword">in</span> FEATURE_ORDER<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> f <span class="token keyword">not</span> <span class="token keyword">in</span> features<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Missing feature: </span><span class="token interpolation"><span class="token punctuation">{</span>f<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>inference.py</code>:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> torch</span>
<span class="line"><span class="token keyword">import</span> joblib</span>
<span class="line"><span class="token keyword">import</span> json</span>
<span class="line"><span class="token keyword">from</span> inference<span class="token punctuation">.</span>model_loader <span class="token keyword">import</span> load_model</span>
<span class="line"><span class="token keyword">from</span> inference<span class="token punctuation">.</span>preprocess <span class="token keyword">import</span> preprocess</span>
<span class="line"></span>
<span class="line">DEVICE <span class="token operator">=</span> <span class="token string">&quot;cpu&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">FraudInference</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>scaler <span class="token operator">=</span> joblib<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&quot;artifacts/scaler.pkl&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;artifacts/config.json&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">            self<span class="token punctuation">.</span>threshold <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;threshold&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">        self<span class="token punctuation">.</span>model <span class="token operator">=</span> load_model<span class="token punctuation">(</span></span>
<span class="line">            <span class="token string">&quot;artifacts/model.pth&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            input_dim<span class="token operator">=</span><span class="token number">29</span><span class="token punctuation">,</span></span>
<span class="line">            device<span class="token operator">=</span>DEVICE</span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> features<span class="token punctuation">:</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        x_scaled <span class="token operator">=</span> preprocess<span class="token punctuation">(</span>features<span class="token punctuation">,</span> self<span class="token punctuation">.</span>scaler<span class="token punctuation">)</span></span>
<span class="line">        x_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>x_scaled<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>DEVICE<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            prob <span class="token operator">=</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>model<span class="token punctuation">(</span>x_tensor<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        is_fraud <span class="token operator">=</span> prob <span class="token operator">&gt;=</span> self<span class="token punctuation">.</span>threshold</span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">&quot;probability&quot;</span><span class="token punctuation">:</span> prob<span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">&quot;is_fraud&quot;</span><span class="token punctuation">:</span> is_fraud</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Sá»­ dá»¥ng:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> inference<span class="token punctuation">.</span>inference <span class="token keyword">import</span> FraudInference</span>
<span class="line"><span class="token keyword">from</span> inference<span class="token punctuation">.</span>schema <span class="token keyword">import</span> validate_features</span>
<span class="line"></span>
<span class="line">engine <span class="token operator">=</span> FraudInference<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">tx <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;V1&quot;</span><span class="token punctuation">:</span> <span class="token number">1.37855899734127</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;V2&quot;</span><span class="token punctuation">:</span> <span class="token number">1.28938093711056</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;V3&quot;</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">5.00424678441137</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line">    <span class="token string">&quot;V28&quot;</span><span class="token punctuation">:</span> <span class="token number">0.186636547522687</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;Amount&quot;</span><span class="token punctuation">:</span> <span class="token number">0.76</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">validate_features<span class="token punctuation">(</span>tx<span class="token punctuation">)</span></span>
<span class="line">result <span class="token operator">=</span> engine<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>tx<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="â„-deploy-dang-gi" tabindex="-1"><a class="header-anchor" href="#â„-deploy-dang-gi"><span>â„ Deploy dáº¡ng gÃ¬?</span></a></h4><ul><li><p>Option 1: Batch (offline):</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">CSV â†’ inference.py â†’ CSV result</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Option 2: REST API (phá»• biáº¿n nháº¥t):</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Client â†’ FastAPI â†’ inference.py â†’ Response</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul>`,99)]))}const r=a(l,[["render",i],["__file","ai-pytorch-practice.html.vue"]]),d=JSON.parse('{"path":"/blog-posts/hidden/ai-pytorch-practice.html","title":"Thá»±c hÃ nh Deep Learning vá»›i PyTorch","lang":"vi-VN","frontmatter":{"title":"Thá»±c hÃ nh Deep Learning vá»›i PyTorch"},"headers":[{"level":2,"title":"ğŸ“Œ 1. Setup mÃ´i trÆ°á»ng PyTorch","slug":"ğŸ“Œ-1-setup-moi-truong-pytorch","link":"#ğŸ“Œ-1-setup-moi-truong-pytorch","children":[{"level":3,"title":"âš™ï¸ Setup","slug":"âš™ï¸-setup","link":"#âš™ï¸-setup","children":[]}]},{"level":2,"title":"ğŸ“Œ 2. BÃ i toÃ¡n AI dá»± Ä‘oÃ¡n Ä‘Æ¡n giáº£n (Linear Regression)","slug":"ğŸ“Œ-2-bai-toan-ai-du-Ä‘oan-Ä‘on-gian-linear-regression","link":"#ğŸ“Œ-2-bai-toan-ai-du-Ä‘oan-Ä‘on-gian-linear-regression","children":[{"level":3,"title":"1ï¸âƒ£ PhÃ¢n tÃ­ch bÃ i toÃ¡n","slug":"_1ï¸âƒ£-phan-tich-bai-toan","link":"#_1ï¸âƒ£-phan-tich-bai-toan","children":[]},{"level":3,"title":"2ï¸âƒ£ Dá»¯ liá»‡u giáº£ láº­p","slug":"_2ï¸âƒ£-du-lieu-gia-lap","link":"#_2ï¸âƒ£-du-lieu-gia-lap","children":[]},{"level":3,"title":"3ï¸âƒ£ Structure project","slug":"_3ï¸âƒ£-structure-project","link":"#_3ï¸âƒ£-structure-project","children":[]},{"level":3,"title":"4ï¸âƒ£ Import & táº¡o dá»¯ liá»‡u","slug":"_4ï¸âƒ£-import-tao-du-lieu","link":"#_4ï¸âƒ£-import-tao-du-lieu","children":[]},{"level":3,"title":"5ï¸âƒ£ Äá»‹nh nghÄ©a Model","slug":"_5ï¸âƒ£-Ä‘inh-nghia-model","link":"#_5ï¸âƒ£-Ä‘inh-nghia-model","children":[]},{"level":3,"title":"6ï¸âƒ£ Training Loop","slug":"_6ï¸âƒ£-training-loop","link":"#_6ï¸âƒ£-training-loop","children":[]},{"level":3,"title":"7ï¸âƒ£ Dá»± Ä‘oÃ¡n","slug":"_7ï¸âƒ£-du-Ä‘oan","link":"#_7ï¸âƒ£-du-Ä‘oan","children":[]},{"level":3,"title":"7ï¸âƒ£ Cháº¡y chÆ°Æ¡ng trÃ¬nh dá»± Ä‘oÃ¡n","slug":"_7ï¸âƒ£-chay-chuong-trinh-du-Ä‘oan","link":"#_7ï¸âƒ£-chay-chuong-trinh-du-Ä‘oan","children":[]},{"level":3,"title":"âš ï¸ Quan trá»ng:","slug":"âš ï¸-quan-trong","link":"#âš ï¸-quan-trong","children":[]}]},{"level":2,"title":"ğŸ“Œ 3. BÃ i toÃ¡n Multi-Layer Perceptron (Binary Classification)","slug":"ğŸ“Œ-3-bai-toan-multi-layer-perceptron-binary-classification","link":"#ğŸ“Œ-3-bai-toan-multi-layer-perceptron-binary-classification","children":[{"level":3,"title":"1ï¸âƒ£ PhÃ¢n tÃ­ch bÃ i toÃ¡n","slug":"_1ï¸âƒ£-phan-tich-bai-toan-1","link":"#_1ï¸âƒ£-phan-tich-bai-toan-1","children":[]},{"level":3,"title":"2ï¸âƒ£ Dá»¯ liá»‡u giáº£ láº­p","slug":"_2ï¸âƒ£-du-lieu-gia-lap-1","link":"#_2ï¸âƒ£-du-lieu-gia-lap-1","children":[]},{"level":3,"title":"3ï¸âƒ£ Import dá»¯ liá»‡u","slug":"_3ï¸âƒ£-import-du-lieu","link":"#_3ï¸âƒ£-import-du-lieu","children":[]},{"level":3,"title":"4ï¸âƒ£ Táº¡o PyTorch Dataset","slug":"_4ï¸âƒ£-tao-pytorch-dataset","link":"#_4ï¸âƒ£-tao-pytorch-dataset","children":[]},{"level":3,"title":"5ï¸âƒ£ Äá»‹nh nghÄ©a Model","slug":"_5ï¸âƒ£-Ä‘inh-nghia-model-1","link":"#_5ï¸âƒ£-Ä‘inh-nghia-model-1","children":[]},{"level":3,"title":"6ï¸âƒ£ Training Loop","slug":"_6ï¸âƒ£-training-loop-1","link":"#_6ï¸âƒ£-training-loop-1","children":[]},{"level":3,"title":"7ï¸âƒ£ Validation & Metrics","slug":"_7ï¸âƒ£-validation-metrics","link":"#_7ï¸âƒ£-validation-metrics","children":[]},{"level":3,"title":"8ï¸âƒ£ Test","slug":"_8ï¸âƒ£-test","link":"#_8ï¸âƒ£-test","children":[]},{"level":3,"title":"9ï¸âƒ£ Triá»ƒn khai inference - ÄÆ°a model Ä‘Ã£ train ra sá»­ dá»¥ng tháº­t","slug":"_9ï¸âƒ£-trien-khai-inference-Ä‘ua-model-Ä‘a-train-ra-su-dung-that","link":"#_9ï¸âƒ£-trien-khai-inference-Ä‘ua-model-Ä‘a-train-ra-su-dung-that","children":[]}]}],"git":{},"filePathRelative":"blog-posts/hidden/ai-pytorch-practice.md"}');export{r as comp,d as data};
